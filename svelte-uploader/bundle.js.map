{"version":3,"file":"bundle.js","sources":["../../../node_modules/svelte/internal/index.mjs","../../../node_modules/@symbiotejs/symbiote/build/symbiote.js","../../../node_modules/@uploadcare/blocks/blocks/utils/debounce.js","../../../node_modules/@uploadcare/blocks/utils/createWindowHeightTracker.js","../../../node_modules/@uploadcare/blocks/utils/template-utils.js","../../../node_modules/@uploadcare/upload-client/dist/esm/index.browser.mjs","../../../node_modules/@uploadcare/blocks/abstract/CTX.js","../../../node_modules/@uploadcare/blocks/abstract/l10nProcessor.js","../../../node_modules/@uploadcare/blocks/abstract/sharedConfigKey.js","../../../node_modules/@uploadcare/blocks/utils/toKebabCase.js","../../../node_modules/@uploadcare/blocks/utils/warnOnce.js","../../../node_modules/@uploadcare/blocks/utils/getPluralForm.js","../../../node_modules/@uploadcare/blocks/abstract/Block.js","../../../node_modules/@uploadcare/blocks/blocks/Modal/Modal.js","../../../node_modules/@uploadcare/blocks/abstract/ActivityBlock.js","../../../node_modules/@uploadcare/blocks/utils/stringToArray.js","../../../node_modules/@uploadcare/blocks/utils/fileTypes.js","../../../node_modules/@uploadcare/blocks/abstract/uploadEntrySchema.js","../../../node_modules/@uploadcare/blocks/env.js","../../../node_modules/@uploadcare/blocks/blocks/utils/userAgent.js","../../../node_modules/@uploadcare/blocks/abstract/TypedData.js","../../../node_modules/@uploadcare/blocks/abstract/TypedCollection.js","../../../node_modules/@uploadcare/blocks/abstract/EventManager.js","../../../node_modules/@uploadcare/blocks/blocks/utils/UploadSource.js","../../../node_modules/@uploadcare/blocks/utils/prettyBytes.js","../../../node_modules/@uploadcare/blocks/abstract/UploaderBlock.js","../../../node_modules/@uploadcare/blocks/blocks/Config/initialConfig.js","../../../node_modules/@uploadcare/blocks/blocks/Config/normalizeConfigValue.js","../../../node_modules/@uploadcare/blocks/blocks/Config/Config.js","../../../node_modules/@uploadcare/blocks/blocks/Icon/Icon.js","../../../node_modules/@uploadcare/blocks/utils/cdn-utils.js","../../../node_modules/@uploadcare/blocks/blocks/Img/props-map.js","../../../node_modules/@uploadcare/blocks/blocks/Img/ImgBase.js","../../../node_modules/@uploadcare/blocks/utils/uniqueArray.js","../../../node_modules/@uploadcare/blocks/blocks/SimpleBtn/SimpleBtn.js","../../../node_modules/@uploadcare/blocks/blocks/DropArea/getDropItems.js","../../../node_modules/@uploadcare/blocks/blocks/DropArea/addDropzone.js","../../../node_modules/@uploadcare/blocks/blocks/DropArea/DropArea.js","../../../node_modules/@uploadcare/blocks/blocks/SourceBtn/SourceBtn.js","../../../node_modules/@uploadcare/blocks/blocks/svg-backgrounds/svg-backgrounds.js","../../../node_modules/@uploadcare/blocks/blocks/FileItem/FileItem.js","../../../node_modules/@uploadcare/blocks/blocks/utils/resizeImage.js","../../../node_modules/@uploadcare/blocks/blocks/MessageBox/MessageBox.js","../../../node_modules/@uploadcare/blocks/blocks/UploadList/UploadList.js","../../../node_modules/@uploadcare/blocks/blocks/UrlSource/UrlSource.js","../../../node_modules/@uploadcare/blocks/blocks/utils/abilities.js","../../../node_modules/@uploadcare/blocks/blocks/CameraSource/CameraSource.js","../../../node_modules/@uploadcare/blocks/blocks/UploadDetails/UploadDetails.js","../../../node_modules/@uploadcare/blocks/blocks/ConfirmationDialog/ConfirmationDialog.js","../../../node_modules/@uploadcare/blocks/blocks/ProgressBarCommon/ProgressBarCommon.js","../../../node_modules/@uploadcare/blocks/blocks/ProgressBar/ProgressBar.js","../../../node_modules/@uploadcare/blocks/utils/transparentPixelSrc.js","../../../node_modules/@uploadcare/blocks/blocks/FilePreview/FilePreview.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/CloudImageEditorBase.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/lib/classNames.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/lib/debounce.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/lib/transformationUtils.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/state.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/template.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/toolbar-constants.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/CloudImageEditorBlock.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/cropper-constants.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/crop-utils.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/CropFrame.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorButtonControl.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorCropButtonControl.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorSlider.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/lib/preloadImage.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorFilterControl.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorOperationControl.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/util.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorImageCropper.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/lib/pick.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/lib/linspace.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorImageFader.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorScroller.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/EditorToolbar.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/elements/button/LrBtnUi.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/elements/line-loader/LineLoaderUi.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/elements/presence-toggle/PresenceToggle.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditor/src/elements/slider/SliderUi.js","../../../node_modules/@uploadcare/blocks/utils/wildcardRegexp.js","../../../node_modules/@uploadcare/blocks/blocks/ExternalSource/buildStyles.js","../../../node_modules/@uploadcare/blocks/blocks/ExternalSource/messages.js","../../../node_modules/@uploadcare/blocks/blocks/ExternalSource/ExternalSource.js","../../../node_modules/@uploadcare/blocks/blocks/ExternalSource/query-string.js","../../../node_modules/@uploadcare/blocks/blocks/Tabs/Tabs.js","../../../node_modules/@uploadcare/blocks/blocks/DataOutput/DataOutput.js","../../../node_modules/@uploadcare/blocks/blocks/Select/Select.js","../../../node_modules/@uploadcare/blocks/blocks/Video/Video.js","../../../node_modules/@uploadcare/blocks/blocks/ShadowWrapper/ShadowWrapper.js","../../../node_modules/@uploadcare/blocks/abstract/SolutionBlock.js","../../../node_modules/@uploadcare/blocks/solutions/file-uploader/regular/FileUploaderRegular.js","../../../node_modules/@uploadcare/blocks/solutions/file-uploader/minimal/FileUploaderMinimal.js","../../../node_modules/@uploadcare/blocks/solutions/file-uploader/inline/FileUploaderInline.js","../../../node_modules/@uploadcare/blocks/solutions/cloud-image-editor/CloudImageEditor.js","../../../node_modules/@uploadcare/blocks/abstract/registerBlocks.js","../../../node_modules/@uploadcare/blocks/abstract/connectBlocksFrom.js","../../../node_modules/@uploadcare/blocks/blocks/ActivityHeader/ActivityHeader.js","../../../node_modules/@uploadcare/blocks/blocks/CloudImageEditorActivity/CloudImageEditorActivity.js","../../../node_modules/@uploadcare/blocks/blocks/Copyright/Copyright.js","../../../node_modules/@uploadcare/blocks/blocks/Img/Img.js","../../../node_modules/@uploadcare/blocks/blocks/SourceList/SourceList.js","../../../node_modules/@uploadcare/blocks/blocks/StartFrom/StartFrom.js","../../../node_modules/@uploadcare/blocks/blocks/UploadCtxProvider/UploadCtxProvider.js","../src/App.svelte","../src/main.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\nfunction is_promise(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function') && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\nfunction split_css_unit(value) {\n    const split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n    return split ? [parseFloat(split[1]), split[2] || 'px'] : [value, 'px'];\n}\nconst contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element.sheet;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n    return style.sheet;\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentNode !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    if (node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction comment(content) {\n    return document.createComment(content);\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_immediate_propagation(fn) {\n    return function (event) {\n        event.stopImmediatePropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data_map(node, data_map) {\n    Object.keys(data_map).forEach((key) => {\n        set_custom_element_data(node, key, data_map[key]);\n    });\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction set_dynamic_element_data(tag) {\n    return (/-/.test(tag)) ? set_custom_element_data_map : set_attributes;\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction init_binding_group(group) {\n    let _inputs;\n    return {\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            _inputs.forEach(input => group.push(input));\n        },\n        /* remove */ r() {\n            _inputs.forEach(input => group.splice(group.indexOf(input), 1));\n        }\n    };\n}\nfunction init_binding_group_dynamic(group, indexes) {\n    let _group = get_binding_group(group);\n    let _inputs;\n    function get_binding_group(group) {\n        for (let i = 0; i < indexes.length; i++) {\n            group = group[indexes[i]] = group[indexes[i]] || [];\n        }\n        return group;\n    }\n    function push() {\n        _inputs.forEach(input => _group.push(input));\n    }\n    function remove() {\n        _inputs.forEach(input => _group.splice(_group.indexOf(input), 1));\n    }\n    return {\n        /* update */ u(new_indexes) {\n            indexes = new_indexes;\n            const new_group = get_binding_group(group);\n            if (new_group !== _group) {\n                remove();\n                _group = new_group;\n                push();\n            }\n        },\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            push();\n        },\n        /* remove */ r: remove\n    };\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction claim_comment(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 8, (node) => {\n        node.data = '' + data;\n        return undefined;\n    }, () => comment(data), true);\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes, is_svg) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration(undefined, is_svg);\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes, is_svg);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    text.data = data;\n}\nfunction set_data_contenteditable(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    text.data = data;\n}\nfunction set_data_maybe_contenteditable(text, data, attr_value) {\n    if (~contenteditable_truthy_values.indexOf(attr_value)) {\n        set_data_contenteditable(text, data);\n    }\n    else {\n        set_data(text, data);\n    }\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    if (value === null) {\n        node.style.removeProperty(key);\n    }\n    else {\n        node.style.setProperty(key, value, important ? 'important' : '');\n    }\n}\nfunction select_option(select, value, mounting) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    if (!mounting || value !== undefined) {\n        select.selectedIndex = -1; // no option should be selected\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked');\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n            // make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n            // see https://github.com/sveltejs/svelte/issues/4233\n            fn();\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, cancelable, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nfunction head_selector(nodeId, head) {\n    const result = [];\n    let started = 0;\n    for (const node of head.childNodes) {\n        if (node.nodeType === 8 /* comment node */) {\n            const comment = node.textContent.trim();\n            if (comment === `HEAD_${nodeId}_END`) {\n                started -= 1;\n                result.push(node);\n            }\n            else if (comment === `HEAD_${nodeId}_START`) {\n                started += 1;\n                result.push(node);\n            }\n        }\n        else if (started > 0) {\n            result.push(node);\n        }\n    }\n    return result;\n}\nclass HtmlTag {\n    constructor(is_svg = false) {\n        this.is_svg = false;\n        this.is_svg = is_svg;\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            if (this.is_svg)\n                this.e = svg_element(target.nodeName);\n            /** #7364  target for <template> may be provided as #document-fragment(11) */\n            else\n                this.e = element((target.nodeType === 11 ? 'TEMPLATE' : target.nodeName));\n            this.t = target.tagName !== 'TEMPLATE' ? target : target.content;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes, is_svg = false) {\n        super(is_svg);\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\nfunction construct_svelte_component(component, props) {\n    return new component(props);\n}\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\nconst managed_styles = new Map();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_style_information(doc, node) {\n    const info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n    managed_styles.set(doc, info);\n    return info;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    const { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n    if (!rules[name]) {\n        rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        managed_styles.forEach(info => {\n            const { ownerNode } = info.stylesheet;\n            // there is no ownerNode if it runs on jsdom.\n            if (ownerNode)\n                detach(ownerNode);\n        });\n        managed_styles.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs#run-time-svelte-beforeupdate\n */\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * `onMount` does not run inside a [server-side component](/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs#run-time-svelte-onmount\n */\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n */\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs#run-time-svelte-ondestroy\n */\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * https://svelte.dev/docs#run-time-svelte-createeventdispatcher\n */\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail, { cancelable = false } = {}) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail, { cancelable });\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n            return !event.defaultPrevented;\n        }\n        return true;\n    };\n}\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-setcontext\n */\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n    return context;\n}\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-getcontext\n */\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs#run-time-svelte-getallcontexts\n */\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-hascontext\n */\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nlet render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\nlet flushidx = 0; // Do *not* move this inside the flush() function\nfunction flush() {\n    // Do not reenter flush while dirty components are updated, as this can\n    // result in an infinite loop. Instead, let the inner flush handle it.\n    // Reentrancy is ok afterwards for bindings etc.\n    if (flushidx !== 0) {\n        return;\n    }\n    const saved_component = current_component;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        try {\n            while (flushidx < dirty_components.length) {\n                const component = dirty_components[flushidx];\n                flushidx++;\n                set_current_component(component);\n                update(component.$$);\n            }\n        }\n        catch (e) {\n            // reset dirty state to not end up in a deadlocked state and then rethrow\n            dirty_components.length = 0;\n            flushidx = 0;\n            throw e;\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        flushidx = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    seen_callbacks.clear();\n    set_current_component(saved_component);\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n */\nfunction flush_render_callbacks(fns) {\n    const filtered = [];\n    const targets = [];\n    render_callbacks.forEach((c) => fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c));\n    targets.forEach((c) => c());\n    render_callbacks = filtered;\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n    else if (callback) {\n        callback();\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    const options = { direction: 'in' };\n    let config = fn(node, params, options);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config(options);\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    const options = { direction: 'out' };\n    let config = fn(node, params, options);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config(options);\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    const options = { direction: 'both' };\n    let config = fn(node, params, options);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config(options);\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    const updates = [];\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            // defer updates until all the DOM shuffling is done\n            updates.push(() => block.p(child_ctx, dirty));\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    run_all(updates);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\nconst _boolean_attributes = [\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'inert',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n];\n/**\n * List of HTML boolean attributes (e.g. `<input disabled>`).\n * Source: https://html.spec.whatwg.org/multipage/indices.html\n */\nconst boolean_attributes = new Set([..._boolean_attributes]);\n\n/** regex of all html void element names */\nconst void_element_names = /^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;\nfunction is_void(name) {\n    return void_element_names.test(name) || name.toLowerCase() === '!doctype';\n}\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, attrs_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (attrs_to_add) {\n        const classes_to_add = attrs_to_add.classes;\n        const styles_to_add = attrs_to_add.styles;\n        if (classes_to_add) {\n            if (attributes.class == null) {\n                attributes.class = classes_to_add;\n            }\n            else {\n                attributes.class += ' ' + classes_to_add;\n            }\n        }\n        if (styles_to_add) {\n            if (attributes.style == null) {\n                attributes.style = style_object_to_string(styles_to_add);\n            }\n            else {\n                attributes.style = style_object_to_string(merge_ssr_styles(attributes.style, styles_to_add));\n            }\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nfunction merge_ssr_styles(style_attribute, style_directive) {\n    const style_object = {};\n    for (const individual_style of style_attribute.split(';')) {\n        const colon_index = individual_style.indexOf(':');\n        const name = individual_style.slice(0, colon_index).trim();\n        const value = individual_style.slice(colon_index + 1).trim();\n        if (!name)\n            continue;\n        style_object[name] = value;\n    }\n    for (const name in style_directive) {\n        const value = style_directive[name];\n        if (value) {\n            style_object[name] = value;\n        }\n        else {\n            delete style_object[name];\n        }\n    }\n    return style_object;\n}\nconst ATTR_REGEX = /[&\"]/g;\nconst CONTENT_REGEX = /[&<]/g;\n/**\n * Note: this method is performance sensitive and has been optimized\n * https://github.com/sveltejs/svelte/pull/5701\n */\nfunction escape(value, is_attr = false) {\n    const str = String(value);\n    const pattern = is_attr ? ATTR_REGEX : CONTENT_REGEX;\n    pattern.lastIndex = 0;\n    let escaped = '';\n    let last = 0;\n    while (pattern.test(str)) {\n        const i = pattern.lastIndex - 1;\n        const ch = str[i];\n        escaped += str.substring(last, i) + (ch === '&' ? '&amp;' : (ch === '\"' ? '&quot;' : '&lt;'));\n        last = i + 1;\n    }\n    return escaped + str.substring(last);\n}\nfunction escape_attribute_value(value) {\n    // keep booleans, null, and undefined for the sake of `spread`\n    const should_escape = typeof value === 'string' || (value && typeof value === 'object');\n    return should_escape ? escape(value, true) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules. Otherwise you may need to fix a <${name}>.`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    const assignment = (boolean && value === true) ? '' : `=\"${escape(value, true)}\"`;\n    return ` ${name}${assignment}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\nfunction style_object_to_string(style_object) {\n    return Object.keys(style_object)\n        .filter(key => style_object[key])\n        .map(key => `${key}: ${escape_attribute_value(style_object[key])};`)\n        .join(' ');\n}\nfunction add_styles(style_object) {\n    const styles = style_object_to_string(style_object);\n    return styles ? ` style=\"${styles}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n            // if the component was destroyed immediately\n            // it will update the `$$.on_destroy` reference to `null`.\n            // the destructured on_destroy may still reference to the old array\n            if (component.$$.on_destroy) {\n                component.$$.on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        flush_render_callbacks($$.after_update);\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: [],\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            if (!is_function(callback)) {\n                return noop;\n            }\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        if (!is_function(callback)) {\n            return noop;\n        }\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.58.0' }, detail), { bubbles: true }));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation, has_stop_immediate_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    if (has_stop_immediate_propagation)\n        modifiers.push('stopImmediatePropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction set_data_contenteditable_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction set_data_maybe_contenteditable_dev(text, data, attr_value) {\n    if (~contenteditable_truthy_values.indexOf(attr_value)) {\n        set_data_contenteditable_dev(text, data);\n    }\n    else {\n        set_data_dev(text, data);\n    }\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nfunction validate_dynamic_element(tag) {\n    const is_string = typeof tag === 'string';\n    if (tag && !is_string) {\n        throw new Error('<svelte:element> expects \"this\" attribute to be a string.');\n    }\n}\nfunction validate_void_dynamic_element(tag) {\n    if (tag && is_void(tag)) {\n        console.warn(`<svelte:element this=\"${tag}\"> is self-closing and cannot have content.`);\n    }\n}\nfunction construct_svelte_component_dev(component, props) {\n    const error_message = 'this={...} of <svelte:component> should specify a Svelte component.';\n    try {\n        const instance = new component(props);\n        if (!instance.$$ || !instance.$set || !instance.$on || !instance.$destroy) {\n            throw new Error(error_message);\n        }\n        return instance;\n    }\n    catch (err) {\n        const { message } = err;\n        if (typeof message === 'string' && message.indexOf('is not a constructor') !== -1) {\n            throw new Error(error_message);\n        }\n        else {\n            throw err;\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_styles, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_comment, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, comment, component_subscribe, compute_rest_props, compute_slots, construct_svelte_component, construct_svelte_component_dev, contenteditable_truthy_values, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, flush_render_callbacks, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, head_selector, identity, init, init_binding_group, init_binding_group_dynamic, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, is_void, listen, listen_dev, loop, loop_guard, merge_ssr_styles, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_custom_element_data_map, set_data, set_data_contenteditable, set_data_contenteditable_dev, set_data_dev, set_data_maybe_contenteditable, set_data_maybe_contenteditable_dev, set_dynamic_element_data, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, split_css_unit, spread, src_url_equal, start_hydrating, stop_immediate_propagation, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_dynamic_element, validate_each_argument, validate_each_keys, validate_slots, validate_store, validate_void_dynamic_element, xlink_attr };\n","var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\n\n// core/Data.js\nfunction cloneObj(obj) {\n  let clone = (o) => {\n    var _a;\n    for (let prop in o) {\n      if (((_a = o[prop]) == null ? void 0 : _a.constructor) === Object) {\n        o[prop] = clone(o[prop]);\n      }\n    }\n    return { ...o };\n  };\n  return clone(obj);\n}\nvar Data = class {\n  constructor(schema) {\n    if (schema.constructor === Object) {\n      this.store = cloneObj(schema);\n    } else {\n      this._storeIsProxy = true;\n      this.store = schema;\n    }\n    this.callbackMap = Object.create(null);\n  }\n  static warn(actionName, prop) {\n    console.warn(`Symbiote Data: cannot ${actionName}. Prop name: ` + prop);\n  }\n  read(prop) {\n    if (!this._storeIsProxy && !this.store.hasOwnProperty(prop)) {\n      Data.warn(\"read\", prop);\n      return null;\n    }\n    return this.store[prop];\n  }\n  has(prop) {\n    return this._storeIsProxy ? this.store[prop] !== void 0 : this.store.hasOwnProperty(prop);\n  }\n  add(prop, val, rewrite = false) {\n    if (!rewrite && Object.keys(this.store).includes(prop)) {\n      return;\n    }\n    this.store[prop] = val;\n    this.notify(prop);\n  }\n  pub(prop, val) {\n    if (!this._storeIsProxy && !this.store.hasOwnProperty(prop)) {\n      Data.warn(\"publish\", prop);\n      return;\n    }\n    this.store[prop] = val;\n    this.notify(prop);\n  }\n  multiPub(updObj) {\n    for (let prop in updObj) {\n      this.pub(prop, updObj[prop]);\n    }\n  }\n  notify(prop) {\n    if (this.callbackMap[prop]) {\n      this.callbackMap[prop].forEach((callback) => {\n        callback(this.store[prop]);\n      });\n    }\n  }\n  sub(prop, callback, init = true) {\n    if (!this._storeIsProxy && !this.store.hasOwnProperty(prop)) {\n      Data.warn(\"subscribe\", prop);\n      return null;\n    }\n    if (!this.callbackMap[prop]) {\n      this.callbackMap[prop] = /* @__PURE__ */ new Set();\n    }\n    this.callbackMap[prop].add(callback);\n    if (init) {\n      callback(this.store[prop]);\n    }\n    return {\n      remove: () => {\n        this.callbackMap[prop].delete(callback);\n        if (!this.callbackMap[prop].size) {\n          delete this.callbackMap[prop];\n        }\n      },\n      callback\n    };\n  }\n  static registerCtx(schema, uid = Symbol()) {\n    let data = Data.globalStore.get(uid);\n    if (data) {\n      console.warn('State: context UID \"' + uid + '\" already in use');\n    } else {\n      data = new Data(schema);\n      Data.globalStore.set(uid, data);\n    }\n    return data;\n  }\n  static deleteCtx(uid) {\n    Data.globalStore.delete(uid);\n  }\n  static getCtx(uid, notify = true) {\n    return Data.globalStore.get(uid) || (notify && console.warn('State: wrong context UID - \"' + uid + '\"'), null);\n  }\n};\nData.globalStore = /* @__PURE__ */ new Map();\n\n// core/dictionary.js\nvar DICT = Object.freeze({\n  BIND_ATTR: \"set\",\n  ATTR_BIND_PRFX: \"@\",\n  EXT_DATA_CTX_PRFX: \"*\",\n  NAMED_DATA_CTX_SPLTR: \"/\",\n  CTX_NAME_ATTR: \"ctx-name\",\n  CTX_OWNER_ATTR: \"ctx-owner\",\n  CSS_CTX_PROP: \"--ctx-name\",\n  EL_REF_ATTR: \"ref\",\n  AUTO_TAG_PRFX: \"sym\",\n  REPEAT_ATTR: \"repeat\",\n  REPEAT_ITEM_TAG_ATTR: \"repeat-item-tag\",\n  SET_LATER_KEY: \"__toSetLater__\",\n  USE_TPL: \"use-template\",\n  ROOT_STYLE_ATTR_NAME: \"sym-component\"\n});\n\n// utils/UID.js\nvar CHARS = \"1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm\";\nvar CHLENGTH = CHARS.length - 1;\nvar UID = class {\n  static generate(pattern = \"XXXXXXXXX-XXX\") {\n    let uid = \"\";\n    for (let i = 0; i < pattern.length; i++) {\n      uid += pattern[i] === \"-\" ? pattern[i] : CHARS.charAt(Math.random() * CHLENGTH);\n    }\n    return uid;\n  }\n};\n\n// utils/setNestedProp.js\nfunction setNestedProp(parent, path, value) {\n  let success = true;\n  let lastStep;\n  let propPath = path.split(\".\");\n  propPath.forEach((step, idx) => {\n    if (idx < propPath.length - 1) {\n      parent = parent[step];\n    } else {\n      lastStep = step;\n    }\n  });\n  if (parent) {\n    parent[lastStep] = value;\n  } else {\n    success = false;\n  }\n  return success;\n}\n\n// utils/kebabToCamel.js\nfunction kebabToCamel(string) {\n  return string.split(\"-\").map((p, i) => {\n    return p && i ? p[0].toUpperCase() + p.slice(1) : p;\n  }).join(\"\").split(\"_\").map((p, i) => {\n    return p && i ? p.toUpperCase() : p;\n  }).join(\"\");\n}\n\n// core/repeatProcessor.js\nfunction repeatProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll(`[${DICT.REPEAT_ATTR}]`)].forEach((el) => {\n    let itemTag = el.getAttribute(DICT.REPEAT_ITEM_TAG_ATTR);\n    let itemClass;\n    if (itemTag) {\n      itemClass = window.customElements.get(itemTag);\n    }\n    if (!itemClass) {\n      itemClass = class extends fnCtx.BaseComponent {\n        constructor() {\n          super();\n          if (!itemTag) {\n            this.style.display = \"contents\";\n          }\n        }\n      };\n      let itemTpl = el.innerHTML;\n      itemClass.template = itemTpl;\n      itemClass.reg(itemTag);\n    }\n    while (el.firstChild) {\n      el.firstChild.remove();\n    }\n    let repeatDataKey = el.getAttribute(DICT.REPEAT_ATTR);\n    fnCtx.sub(repeatDataKey, (data) => {\n      if (!data) {\n        while (el.firstChild) {\n          el.firstChild.remove();\n        }\n        return;\n      }\n      let currentList = [...el.children];\n      let fragment;\n      let fillItems = (items) => {\n        items.forEach((item, idx) => {\n          if (currentList[idx]) {\n            if (currentList[idx].set$) {\n              setTimeout(() => {\n                currentList[idx].set$(item);\n              });\n            } else {\n              for (let k in item) {\n                currentList[idx][k] = item[k];\n              }\n            }\n          } else {\n            if (!fragment) {\n              fragment = new DocumentFragment();\n            }\n            let repeatItem = new itemClass();\n            Object.assign(repeatItem.init$, item);\n            fragment.appendChild(repeatItem);\n          }\n        });\n        fragment && el.appendChild(fragment);\n        let oversize = currentList.slice(items.length, currentList.length);\n        for (let exItm of oversize) {\n          exItm.remove();\n        }\n      };\n      if (data.constructor === Array) {\n        fillItems(data);\n      } else if (data.constructor === Object) {\n        let items = [];\n        for (let itemKey in data) {\n          let init = data[itemKey];\n          Object.defineProperty(init, \"_KEY_\", {\n            value: itemKey,\n            enumerable: true\n          });\n          items.push(init);\n        }\n        fillItems(items);\n      } else {\n        console.warn(\"Symbiote repeat data type error:\");\n        console.log(data);\n      }\n    });\n    el.removeAttribute(DICT.REPEAT_ATTR);\n    el.removeAttribute(DICT.REPEAT_ITEM_TAG_ATTR);\n  });\n}\n\n// core/tpl-processors.js\nvar DEFAULT_SLOT_KEY = \"__default__\";\nfunction slotProcessor(fr, fnCtx) {\n  if (fnCtx.shadowRoot) {\n    return;\n  }\n  let slots = [...fr.querySelectorAll(\"slot\")];\n  if (!slots.length) {\n    return;\n  }\n  let slotMap = {};\n  slots.forEach((slot) => {\n    let slotName = slot.getAttribute(\"name\") || DEFAULT_SLOT_KEY;\n    slotMap[slotName] = {\n      slot,\n      fr: document.createDocumentFragment()\n    };\n  });\n  fnCtx.initChildren.forEach((child) => {\n    var _a;\n    let slotName = DEFAULT_SLOT_KEY;\n    if (child instanceof Element && child.hasAttribute(\"slot\")) {\n      slotName = child.getAttribute(\"slot\");\n      child.removeAttribute(\"slot\");\n    }\n    (_a = slotMap[slotName]) == null ? void 0 : _a.fr.appendChild(child);\n  });\n  Object.values(slotMap).forEach((mapObj) => {\n    if (mapObj.fr.childNodes.length) {\n      mapObj.slot.parentNode.replaceChild(mapObj.fr, mapObj.slot);\n    } else if (mapObj.slot.childNodes.length) {\n      let slotFr = document.createDocumentFragment();\n      slotFr.append(...mapObj.slot.childNodes);\n      mapObj.slot.parentNode.replaceChild(slotFr, mapObj.slot);\n    } else {\n      mapObj.slot.remove();\n    }\n  });\n}\nfunction refProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll(`[${DICT.EL_REF_ATTR}]`)].forEach((el) => {\n    let refName = el.getAttribute(DICT.EL_REF_ATTR);\n    fnCtx.ref[refName] = el;\n    el.removeAttribute(DICT.EL_REF_ATTR);\n  });\n}\nfunction domSetProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll(`[${DICT.BIND_ATTR}]`)].forEach((el) => {\n    let subStr = el.getAttribute(DICT.BIND_ATTR);\n    let keyValArr = subStr.split(\";\");\n    [...el.attributes].forEach((attr) => {\n      if (attr.name.startsWith(\"-\") && attr.value) {\n        let key = kebabToCamel(attr.name.replace(\"-\", \"\"));\n        keyValArr.push(key + \":\" + attr.value);\n        el.removeAttribute(attr.name);\n      }\n    });\n    keyValArr.forEach((keyValStr) => {\n      if (!keyValStr) {\n        return;\n      }\n      let kv = keyValStr.split(\":\").map((str) => str.trim());\n      let prop = kv[0];\n      let isAttr;\n      if (prop.indexOf(DICT.ATTR_BIND_PRFX) === 0) {\n        isAttr = true;\n        prop = prop.replace(DICT.ATTR_BIND_PRFX, \"\");\n      }\n      let valKeysArr = kv[1].split(\",\").map((valKey) => {\n        return valKey.trim();\n      });\n      for (let valKey of valKeysArr) {\n        let castType;\n        if (valKey.startsWith(\"!!\")) {\n          castType = \"double\";\n          valKey = valKey.replace(\"!!\", \"\");\n        } else if (valKey.startsWith(\"!\")) {\n          castType = \"single\";\n          valKey = valKey.replace(\"!\", \"\");\n        }\n        fnCtx.sub(valKey, (val) => {\n          if (castType === \"double\") {\n            val = !!val;\n          } else if (castType === \"single\") {\n            val = !val;\n          }\n          if (isAttr) {\n            if ((val == null ? void 0 : val.constructor) === Boolean) {\n              val ? el.setAttribute(prop, \"\") : el.removeAttribute(prop);\n            } else {\n              el.setAttribute(prop, val);\n            }\n          } else {\n            if (!setNestedProp(el, prop, val)) {\n              if (!el[DICT.SET_LATER_KEY]) {\n                el[DICT.SET_LATER_KEY] = Object.create(null);\n              }\n              el[DICT.SET_LATER_KEY][prop] = val;\n            }\n          }\n        });\n      }\n    });\n    el.removeAttribute(DICT.BIND_ATTR);\n  });\n}\nvar OPEN_TOKEN = \"{{\";\nvar CLOSE_TOKEN = \"}}\";\nvar SKIP_ATTR = \"skip-text\";\nfunction getTextNodesWithTokens(el) {\n  let node;\n  let result = [];\n  let walk = document.createTreeWalker(el, NodeFilter.SHOW_TEXT, {\n    acceptNode: (txt) => {\n      var _a;\n      return !((_a = txt.parentElement) == null ? void 0 : _a.hasAttribute(SKIP_ATTR)) && txt.textContent.includes(OPEN_TOKEN) && txt.textContent.includes(CLOSE_TOKEN) && 1;\n    }\n  });\n  while (node = walk.nextNode()) {\n    result.push(node);\n  }\n  return result;\n}\nvar txtNodesProcessor = function(fr, fnCtx) {\n  let txtNodes = getTextNodesWithTokens(fr);\n  txtNodes.forEach((txtNode) => {\n    let tokenNodes = [];\n    let offset;\n    while (txtNode.textContent.includes(CLOSE_TOKEN)) {\n      if (txtNode.textContent.startsWith(OPEN_TOKEN)) {\n        offset = txtNode.textContent.indexOf(CLOSE_TOKEN) + CLOSE_TOKEN.length;\n        txtNode.splitText(offset);\n        tokenNodes.push(txtNode);\n      } else {\n        offset = txtNode.textContent.indexOf(OPEN_TOKEN);\n        txtNode.splitText(offset);\n      }\n      txtNode = txtNode.nextSibling;\n    }\n    tokenNodes.forEach((tNode) => {\n      let prop = tNode.textContent.replace(OPEN_TOKEN, \"\").replace(CLOSE_TOKEN, \"\");\n      tNode.textContent = \"\";\n      fnCtx.sub(prop, (val) => {\n        tNode.textContent = val;\n      });\n    });\n  });\n};\nvar tpl_processors_default = [repeatProcessor, slotProcessor, refProcessor, domSetProcessor, txtNodesProcessor];\n\n// utils/parseCssPropertyValue.js\nvar SINGLE_QUOTE = \"'\";\nvar DOUBLE_QUOTE = '\"';\nvar ESCAPED_PATTERN = /\\\\([0-9a-fA-F]{1,6} ?)/g;\nfunction hasLeadingTrailingQuotes(str) {\n  return (str[0] === DOUBLE_QUOTE || str[0] === SINGLE_QUOTE) && (str[str.length - 1] === DOUBLE_QUOTE || str[str.length - 1] === SINGLE_QUOTE);\n}\nfunction trimQuotes(str) {\n  if (str[0] === DOUBLE_QUOTE || str[0] === SINGLE_QUOTE) {\n    str = str.slice(1);\n  }\n  if (str[str.length - 1] === DOUBLE_QUOTE || str[str.length - 1] === SINGLE_QUOTE) {\n    str = str.slice(0, -1);\n  }\n  return str;\n}\nfunction escapeQuotes(str) {\n  let result = \"\";\n  let prev = \"\";\n  for (var i = 0; i < str.length; i++) {\n    const next = str[i + 1];\n    if (str[i] === \"\\\\\" && next === '\"') {\n      result += '\\\\\"';\n      i++;\n    } else if (str[i] === '\"' && prev !== \"\\\\\") {\n      result += '\\\\\"';\n    } else {\n      result += str[i];\n    }\n    prev = str[i];\n  }\n  return result;\n}\nfunction parseCssPropertyValue(input) {\n  let output = input;\n  if (hasLeadingTrailingQuotes(input)) {\n    output = trimQuotes(output);\n    output = output.replace(ESCAPED_PATTERN, (match, p1) => {\n      return String.fromCodePoint(parseInt(p1.trim(), 16));\n    });\n    output = output.replaceAll(\"\\\\\\n\", \"\\\\n\");\n    output = escapeQuotes(output);\n    output = DOUBLE_QUOTE + output + DOUBLE_QUOTE;\n  }\n  try {\n    return JSON.parse(output);\n  } catch (err) {\n    throw new Error(`Failed to parse CSS property value: ${output}. Original input: ${input}`);\n  }\n}\n\n// core/BaseComponent.js\nvar autoTagsCount = 0;\nvar styleMutationObserver = null;\nvar styleMutationObserverCbList = null;\nvar _BaseComponent = class extends HTMLElement {\n  constructor() {\n    super();\n    __publicField(this, \"updateCssData\", () => {\n      var _a;\n      this.dropCssDataCache();\n      (_a = this.__boundCssProps) == null ? void 0 : _a.forEach((ctxProp) => {\n        let val = this.getCssData(this.__extractCssName(ctxProp), true);\n        val !== null && this.$[ctxProp] !== val && (this.$[ctxProp] = val);\n      });\n    });\n    this.init$ = Object.create(null);\n    this.cssInit$ = Object.create(null);\n    this.tplProcessors = /* @__PURE__ */ new Set();\n    this.ref = Object.create(null);\n    this.allSubs = /* @__PURE__ */ new Set();\n    this.pauseRender = false;\n    this.renderShadow = false;\n    this.readyToDestroy = true;\n    this.processInnerHtml = false;\n    this.allowCustomTemplate = false;\n    this.ctxOwner = false;\n  }\n  get BaseComponent() {\n    return _BaseComponent;\n  }\n  initCallback() {\n  }\n  __initCallback() {\n    var _a;\n    if (this.__initialized) {\n      return;\n    }\n    this.__initialized = true;\n    (_a = this.initCallback) == null ? void 0 : _a.call(this);\n  }\n  render(template, shadow = this.renderShadow) {\n    let fr;\n    if ((shadow || this.constructor[\"__shadowStylesUrl\"]) && !this.shadowRoot) {\n      this.attachShadow({\n        mode: \"open\"\n      });\n    }\n    if (this.allowCustomTemplate) {\n      let customTplSelector = this.getAttribute(DICT.USE_TPL);\n      if (customTplSelector) {\n        let root = this.getRootNode();\n        let customTpl = (root == null ? void 0 : root.querySelector(customTplSelector)) || document.querySelector(customTplSelector);\n        if (customTpl) {\n          template = customTpl.content.cloneNode(true);\n        } else {\n          console.warn(`Symbiote template \"${customTplSelector}\" is not found...`);\n        }\n      }\n    }\n    if (this.processInnerHtml) {\n      for (let fn of this.tplProcessors) {\n        fn(this, this);\n      }\n    }\n    if (template || this.constructor[\"template\"]) {\n      if (this.constructor[\"template\"] && !this.constructor[\"__tpl\"]) {\n        this.constructor[\"__tpl\"] = document.createElement(\"template\");\n        this.constructor[\"__tpl\"].innerHTML = this.constructor[\"template\"];\n      }\n      if ((template == null ? void 0 : template.constructor) === DocumentFragment) {\n        fr = template;\n      } else if ((template == null ? void 0 : template.constructor) === String) {\n        let tpl = document.createElement(\"template\");\n        tpl.innerHTML = template;\n        fr = tpl.content.cloneNode(true);\n      } else if (this.constructor[\"__tpl\"]) {\n        fr = this.constructor[\"__tpl\"].content.cloneNode(true);\n      }\n      for (let fn of this.tplProcessors) {\n        fn(fr, this);\n      }\n    }\n    let addFr = () => {\n      fr && (shadow && this.shadowRoot.appendChild(fr) || this.appendChild(fr));\n      this.__initCallback();\n    };\n    if (this.constructor[\"__shadowStylesUrl\"]) {\n      shadow = true;\n      let styleLink = document.createElement(\"link\");\n      styleLink.rel = \"stylesheet\";\n      styleLink.href = this.constructor[\"__shadowStylesUrl\"];\n      styleLink.onload = addFr;\n      this.shadowRoot.prepend(styleLink);\n    } else {\n      addFr();\n    }\n  }\n  addTemplateProcessor(processorFn) {\n    this.tplProcessors.add(processorFn);\n  }\n  get autoCtxName() {\n    if (!this.__autoCtxName) {\n      this.__autoCtxName = UID.generate();\n      this.style.setProperty(DICT.CSS_CTX_PROP, `'${this.__autoCtxName}'`);\n    }\n    return this.__autoCtxName;\n  }\n  get cssCtxName() {\n    return this.getCssData(DICT.CSS_CTX_PROP, true);\n  }\n  get ctxName() {\n    var _a;\n    let ctxName = ((_a = this.getAttribute(DICT.CTX_NAME_ATTR)) == null ? void 0 : _a.trim()) || this.cssCtxName || this.__cachedCtxName || this.autoCtxName;\n    this.__cachedCtxName = ctxName;\n    return ctxName;\n  }\n  get localCtx() {\n    if (!this.__localCtx) {\n      this.__localCtx = Data.registerCtx({}, this);\n    }\n    return this.__localCtx;\n  }\n  get nodeCtx() {\n    return Data.getCtx(this.ctxName, false) || Data.registerCtx({}, this.ctxName);\n  }\n  static __parseProp(prop, fnCtx) {\n    let ctx;\n    let name;\n    if (prop.startsWith(DICT.EXT_DATA_CTX_PRFX)) {\n      ctx = fnCtx.nodeCtx;\n      name = prop.replace(DICT.EXT_DATA_CTX_PRFX, \"\");\n    } else if (prop.includes(DICT.NAMED_DATA_CTX_SPLTR)) {\n      let pArr = prop.split(DICT.NAMED_DATA_CTX_SPLTR);\n      ctx = Data.getCtx(pArr[0]);\n      name = pArr[1];\n    } else {\n      ctx = fnCtx.localCtx;\n      name = prop;\n    }\n    return {\n      ctx,\n      name\n    };\n  }\n  sub(prop, handler, init = true) {\n    let subCb = (val) => {\n      if (!this.isConnected) {\n        return;\n      }\n      handler(val);\n    };\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    if (!parsed.ctx.has(parsed.name)) {\n      window.setTimeout(() => {\n        this.allSubs.add(parsed.ctx.sub(parsed.name, subCb, init));\n      });\n    } else {\n      this.allSubs.add(parsed.ctx.sub(parsed.name, subCb, init));\n    }\n  }\n  notify(prop) {\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    parsed.ctx.notify(parsed.name);\n  }\n  has(prop) {\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    return parsed.ctx.has(parsed.name);\n  }\n  add(prop, val, rewrite = false) {\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    parsed.ctx.add(parsed.name, val, rewrite);\n  }\n  add$(obj, rewrite = false) {\n    for (let prop in obj) {\n      this.add(prop, obj[prop], rewrite);\n    }\n  }\n  get $() {\n    if (!this.__stateProxy) {\n      let o = Object.create(null);\n      this.__stateProxy = new Proxy(o, {\n        set: (obj, prop, val) => {\n          let parsed = _BaseComponent.__parseProp(prop, this);\n          parsed.ctx.pub(parsed.name, val);\n          return true;\n        },\n        get: (obj, prop) => {\n          let parsed = _BaseComponent.__parseProp(prop, this);\n          return parsed.ctx.read(parsed.name);\n        }\n      });\n    }\n    return this.__stateProxy;\n  }\n  set$(kvObj, forcePrimitives = false) {\n    for (let key in kvObj) {\n      let val = kvObj[key];\n      let primArr = [String, Number, Boolean];\n      if (forcePrimitives || !primArr.includes(val == null ? void 0 : val.constructor)) {\n        this.$[key] = val;\n      } else {\n        this.$[key] !== val && (this.$[key] = val);\n      }\n    }\n  }\n  get __ctxOwner() {\n    return this.ctxOwner || this.hasAttribute(DICT.CTX_OWNER_ATTR) && this.getAttribute(DICT.CTX_OWNER_ATTR) !== \"false\";\n  }\n  __initDataCtx() {\n    let attrDesc = this.constructor[\"__attrDesc\"];\n    if (attrDesc) {\n      for (let prop of Object.values(attrDesc)) {\n        if (!Object.keys(this.init$).includes(prop)) {\n          this.init$[prop] = \"\";\n        }\n      }\n    }\n    for (let prop in this.init$) {\n      if (prop.startsWith(DICT.EXT_DATA_CTX_PRFX)) {\n        this.nodeCtx.add(prop.replace(DICT.EXT_DATA_CTX_PRFX, \"\"), this.init$[prop], this.__ctxOwner);\n      } else if (prop.includes(DICT.NAMED_DATA_CTX_SPLTR)) {\n        let propArr = prop.split(DICT.NAMED_DATA_CTX_SPLTR);\n        let ctxName = propArr[0].trim();\n        let propName = propArr[1].trim();\n        if (ctxName && propName) {\n          let namedCtx = Data.getCtx(ctxName, false);\n          if (!namedCtx) {\n            namedCtx = Data.registerCtx({}, ctxName);\n          }\n          namedCtx.add(propName, this.init$[prop]);\n        }\n      } else {\n        this.localCtx.add(prop, this.init$[prop]);\n      }\n    }\n    for (let cssProp in this.cssInit$) {\n      this.bindCssData(cssProp, this.cssInit$[cssProp]);\n    }\n    this.__dataCtxInitialized = true;\n  }\n  connectedCallback() {\n    var _a;\n    if (!this.isConnected) {\n      return;\n    }\n    if (this.__disconnectTimeout) {\n      window.clearTimeout(this.__disconnectTimeout);\n    }\n    if (!this.connectedOnce) {\n      let ctxNameAttrVal = (_a = this.getAttribute(DICT.CTX_NAME_ATTR)) == null ? void 0 : _a.trim();\n      if (ctxNameAttrVal) {\n        this.style.setProperty(DICT.CSS_CTX_PROP, `'${ctxNameAttrVal}'`);\n      }\n      this.__initDataCtx();\n      if (this[DICT.SET_LATER_KEY]) {\n        for (let prop in this[DICT.SET_LATER_KEY]) {\n          setNestedProp(this, prop, this[DICT.SET_LATER_KEY][prop]);\n        }\n        delete this[DICT.SET_LATER_KEY];\n      }\n      this.initChildren = [...this.childNodes];\n      for (let proc of tpl_processors_default) {\n        this.addTemplateProcessor(proc);\n      }\n      if (this.pauseRender) {\n        this.__initCallback();\n      } else {\n        if (this.constructor[\"__rootStylesLink\"]) {\n          let root = this.getRootNode();\n          if (!root) {\n            return;\n          }\n          let hasLink = root == null ? void 0 : root.querySelector(`link[${DICT.ROOT_STYLE_ATTR_NAME}=\"${this.constructor.is}\"]`);\n          if (hasLink) {\n            this.render();\n            return;\n          }\n          let rootLink = this.constructor[\"__rootStylesLink\"].cloneNode(true);\n          rootLink.setAttribute(DICT.ROOT_STYLE_ATTR_NAME, this.constructor[\"is\"]);\n          rootLink.onload = () => {\n            this.render();\n          };\n          root.nodeType === Node.DOCUMENT_NODE ? root.head.appendChild(rootLink) : root.prepend(rootLink);\n        } else {\n          this.render();\n        }\n      }\n    }\n    this.connectedOnce = true;\n  }\n  destroyCallback() {\n  }\n  disconnectedCallback() {\n    if (!this.connectedOnce) {\n      return;\n    }\n    this.dropCssDataCache();\n    if (!this.readyToDestroy) {\n      return;\n    }\n    if (this.__disconnectTimeout) {\n      window.clearTimeout(this.__disconnectTimeout);\n    }\n    this.__disconnectTimeout = window.setTimeout(() => {\n      this.destroyCallback();\n      for (let sub of this.allSubs) {\n        sub.remove();\n        this.allSubs.delete(sub);\n      }\n      for (let proc of this.tplProcessors) {\n        this.tplProcessors.delete(proc);\n      }\n      styleMutationObserverCbList == null ? void 0 : styleMutationObserverCbList.delete(this.updateCssData);\n      if (!(styleMutationObserverCbList == null ? void 0 : styleMutationObserverCbList.size)) {\n        styleMutationObserver == null ? void 0 : styleMutationObserver.disconnect();\n        styleMutationObserver = null;\n        styleMutationObserverCbList = null;\n      }\n    }, 100);\n  }\n  static reg(tagName, isAlias = false) {\n    if (!tagName) {\n      autoTagsCount++;\n      tagName = `${DICT.AUTO_TAG_PRFX}-${autoTagsCount}`;\n    }\n    this.__tag = tagName;\n    let registeredClass = window.customElements.get(tagName);\n    if (registeredClass) {\n      if (!isAlias && registeredClass !== this) {\n        console.warn([\n          `Element with tag name \"${tagName}\" already registered.`,\n          `You're trying to override it with another class \"${this.name}\".`,\n          `This is most likely a mistake.`,\n          `New element will not be registered.`\n        ].join(\"\\n\"));\n      }\n      return;\n    }\n    window.customElements.define(tagName, isAlias ? class extends this {\n    } : this);\n  }\n  static get is() {\n    if (!this.__tag) {\n      this.reg();\n    }\n    return this.__tag;\n  }\n  static bindAttributes(desc) {\n    this.observedAttributes = Object.keys(desc);\n    this.__attrDesc = desc;\n  }\n  attributeChangedCallback(name, oldVal, newVal) {\n    var _a;\n    if (oldVal === newVal) {\n      return;\n    }\n    let $prop = (_a = this.constructor[\"__attrDesc\"]) == null ? void 0 : _a[name];\n    if ($prop) {\n      if (this.__dataCtxInitialized) {\n        this.$[$prop] = newVal;\n      } else {\n        this.init$[$prop] = newVal;\n      }\n    } else {\n      this[name] = newVal;\n    }\n  }\n  getCssData(propName, silentCheck = false) {\n    if (!this.__cssDataCache) {\n      this.__cssDataCache = Object.create(null);\n    }\n    if (!Object.keys(this.__cssDataCache).includes(propName)) {\n      if (!this.__computedStyle) {\n        this.__computedStyle = window.getComputedStyle(this);\n      }\n      let val = this.__computedStyle.getPropertyValue(propName).trim();\n      try {\n        this.__cssDataCache[propName] = parseCssPropertyValue(val);\n      } catch (e) {\n        !silentCheck && console.warn(`CSS Data error: ${propName}`);\n        this.__cssDataCache[propName] = null;\n      }\n    }\n    return this.__cssDataCache[propName];\n  }\n  __extractCssName(ctxPropName) {\n    return ctxPropName.split(\"--\").map((part, idx) => {\n      return idx === 0 ? \"\" : part;\n    }).join(\"--\");\n  }\n  __initStyleAttrObserver() {\n    if (!styleMutationObserverCbList) {\n      styleMutationObserverCbList = /* @__PURE__ */ new Set();\n    }\n    styleMutationObserverCbList.add(this.updateCssData);\n    if (!styleMutationObserver) {\n      styleMutationObserver = new MutationObserver((records) => {\n        records[0].type === \"attributes\" && styleMutationObserverCbList.forEach((cb) => {\n          cb();\n        });\n      });\n      styleMutationObserver.observe(document, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        attributeFilter: [\"style\"]\n      });\n    }\n  }\n  bindCssData(propName, initValue = \"\") {\n    if (!this.__boundCssProps) {\n      this.__boundCssProps = /* @__PURE__ */ new Set();\n    }\n    this.__boundCssProps.add(propName);\n    let val = this.getCssData(this.__extractCssName(propName), true);\n    val === null && (val = initValue);\n    this.add(propName, val);\n    this.__initStyleAttrObserver();\n  }\n  dropCssDataCache() {\n    this.__cssDataCache = null;\n    this.__computedStyle = null;\n  }\n  defineAccessor(propName, handler, isAsync) {\n    let localPropName = \"__\" + propName;\n    this[localPropName] = this[propName];\n    Object.defineProperty(this, propName, {\n      set: (val) => {\n        this[localPropName] = val;\n        if (isAsync) {\n          window.setTimeout(() => {\n            handler == null ? void 0 : handler(val);\n          });\n        } else {\n          handler == null ? void 0 : handler(val);\n        }\n      },\n      get: () => {\n        return this[localPropName];\n      }\n    });\n    this[propName] = this[localPropName];\n  }\n  static set shadowStyles(cssTxt) {\n    let styleBlob = new Blob([cssTxt], {\n      type: \"text/css\"\n    });\n    this.__shadowStylesUrl = URL.createObjectURL(styleBlob);\n  }\n  static set rootStyles(cssTxt) {\n    if (!this.__rootStylesLink) {\n      let styleBlob = new Blob([cssTxt], {\n        type: \"text/css\"\n      });\n      let url = URL.createObjectURL(styleBlob);\n      let link = document.createElement(\"link\");\n      link.href = url;\n      link.rel = \"stylesheet\";\n      this.__rootStylesLink = link;\n    }\n  }\n};\nvar BaseComponent = _BaseComponent;\n__publicField(BaseComponent, \"template\");\n\n// core/AppRouter.js\nvar AppRouter = class {\n  static _print(msg) {\n    console.warn(msg);\n  }\n  static setDefaultTitle(title) {\n    this.defaultTitle = title;\n  }\n  static setRoutingMap(map) {\n    Object.assign(this.appMap, map);\n    for (let route in this.appMap) {\n      if (!this.defaultRoute && this.appMap[route].default === true) {\n        this.defaultRoute = route;\n      } else if (!this.errorRoute && this.appMap[route].error === true) {\n        this.errorRoute = route;\n      }\n    }\n  }\n  static set routingEventName(name) {\n    this.__routingEventName = name;\n  }\n  static get routingEventName() {\n    return this.__routingEventName || \"sym-on-route\";\n  }\n  static readAddressBar() {\n    let result = {\n      route: null,\n      options: {}\n    };\n    let paramsArr = window.location.search.split(this.separator);\n    paramsArr.forEach((part) => {\n      if (part.includes(\"?\")) {\n        result.route = part.replace(\"?\", \"\");\n      } else if (part.includes(\"=\")) {\n        let pair = part.split(\"=\");\n        result.options[pair[0]] = decodeURI(pair[1]);\n      } else {\n        result.options[part] = true;\n      }\n    });\n    return result;\n  }\n  static notify() {\n    let routeBase = this.readAddressBar();\n    let routeScheme = this.appMap[routeBase.route];\n    if (routeScheme && routeScheme.title) {\n      document.title = routeScheme.title;\n    }\n    if (routeBase.route === null && this.defaultRoute) {\n      this.applyRoute(this.defaultRoute);\n      return;\n    } else if (!routeScheme && this.errorRoute) {\n      this.applyRoute(this.errorRoute);\n      return;\n    } else if (!routeScheme && this.defaultRoute) {\n      this.applyRoute(this.defaultRoute);\n      return;\n    } else if (!routeScheme) {\n      this._print(`Route \"${routeBase.route}\" not found...`);\n      return;\n    }\n    let event = new CustomEvent(AppRouter.routingEventName, {\n      detail: {\n        route: routeBase.route,\n        options: Object.assign(routeScheme || {}, routeBase.options)\n      }\n    });\n    window.dispatchEvent(event);\n  }\n  static reflect(route, options = {}) {\n    let routeScheme = this.appMap[route];\n    if (!routeScheme) {\n      this._print(\"Wrong route: \" + route);\n      return;\n    }\n    let routeStr = \"?\" + route;\n    for (let prop in options) {\n      if (options[prop] === true) {\n        routeStr += this.separator + prop;\n      } else {\n        routeStr += this.separator + prop + `=${options[prop]}`;\n      }\n    }\n    let title = routeScheme.title || this.defaultTitle || \"\";\n    window.history.pushState(null, title, routeStr);\n    document.title = title;\n  }\n  static applyRoute(route, options = {}) {\n    this.reflect(route, options);\n    this.notify();\n  }\n  static setSeparator(char) {\n    this._separator = char;\n  }\n  static get separator() {\n    return this._separator || \"&\";\n  }\n  static createRouterData(ctxName, routingMap) {\n    this.setRoutingMap(routingMap);\n    let routeData = Data.registerCtx({\n      route: null,\n      options: null,\n      title: null\n    }, ctxName);\n    window.addEventListener(this.routingEventName, (e) => {\n      var _a;\n      routeData.multiPub({\n        route: e.detail.route,\n        options: e.detail.options,\n        title: ((_a = e.detail.options) == null ? void 0 : _a.title) || this.defaultTitle || \"\"\n      });\n    });\n    AppRouter.notify();\n    this.initPopstateListener();\n    return routeData;\n  }\n  static initPopstateListener() {\n    if (this.__onPopstate) {\n      return;\n    }\n    this.__onPopstate = () => {\n      this.notify();\n    };\n    window.addEventListener(\"popstate\", this.__onPopstate);\n  }\n  static removePopstateListener() {\n    window.removeEventListener(\"popstate\", this.__onPopstate);\n    this.__onPopstate = null;\n  }\n};\nAppRouter.appMap = Object.create(null);\n\n// utils/dom-helpers.js\nfunction applyStyles(el, styleMap) {\n  for (let prop in styleMap) {\n    if (prop.includes(\"-\")) {\n      el.style.setProperty(prop, styleMap[prop]);\n    } else {\n      el.style[prop] = styleMap[prop];\n    }\n  }\n}\nfunction applyAttributes(el, attrMap) {\n  for (let attrName in attrMap) {\n    if (attrMap[attrName].constructor === Boolean) {\n      if (attrMap[attrName]) {\n        el.setAttribute(attrName, \"\");\n      } else {\n        el.removeAttribute(attrName);\n      }\n    } else {\n      el.setAttribute(attrName, attrMap[attrName]);\n    }\n  }\n}\nfunction create(desc = { tag: \"div\" }) {\n  let el = document.createElement(desc.tag);\n  if (desc.attributes) {\n    applyAttributes(el, desc.attributes);\n  }\n  if (desc.styles) {\n    applyStyles(el, desc.styles);\n  }\n  if (desc.properties) {\n    for (let prop in desc.properties) {\n      el[prop] = desc.properties[prop];\n    }\n  }\n  if (desc.processors) {\n    desc.processors.forEach((fn) => {\n      fn(el);\n    });\n  }\n  if (desc.children) {\n    desc.children.forEach((desc2) => {\n      let child = create(desc2);\n      el.appendChild(child);\n    });\n  }\n  return el;\n}\n\n// utils/IDB.js\nvar READY_EVENT_NAME = \"idb-store-ready\";\nvar DEFAULT_DB_NAME = `symbiote-db`;\nvar UPD_EVENT_PREFIX = `symbiote-idb-update_`;\nvar DbInstance = class {\n  _notifyWhenReady(event = null) {\n    window.dispatchEvent(new CustomEvent(READY_EVENT_NAME, {\n      detail: {\n        dbName: this.name,\n        storeName: this.storeName,\n        event\n      }\n    }));\n  }\n  get _updEventName() {\n    return UPD_EVENT_PREFIX + this.name;\n  }\n  _getUpdateEvent(key) {\n    return new CustomEvent(this._updEventName, {\n      detail: {\n        key: this.name,\n        newValue: key\n      }\n    });\n  }\n  _notifySubscribers(key) {\n    window.localStorage.removeItem(this.name);\n    window.localStorage.setItem(this.name, key);\n    window.dispatchEvent(this._getUpdateEvent(key));\n  }\n  constructor(dbName, storeName) {\n    this.name = dbName;\n    this.storeName = storeName;\n    this.version = 1;\n    this.request = window.indexedDB.open(this.name, this.version);\n    this.request.onupgradeneeded = (e) => {\n      this.db = e.target[\"result\"];\n      this.objStore = this.db.createObjectStore(storeName, {\n        keyPath: \"_key\"\n      });\n      this.objStore.transaction.oncomplete = (ev) => {\n        this._notifyWhenReady(ev);\n      };\n    };\n    this.request.onsuccess = (e) => {\n      this.db = e.target.result;\n      this._notifyWhenReady(e);\n    };\n    this.request.onerror = (e) => {\n      console.error(e);\n    };\n    this._subscriptionsMap = {};\n    this._updateHandler = (e) => {\n      if (e.key === this.name && this._subscriptionsMap[e.newValue]) {\n        let set = this._subscriptionsMap[e.newValue];\n        set.forEach(async (callback) => {\n          callback(await this.read(e.newValue));\n        });\n      }\n    };\n    this._localUpdateHandler = (e) => {\n      this._updateHandler(e.detail);\n    };\n    window.addEventListener(\"storage\", this._updateHandler);\n    window.addEventListener(this._updEventName, this._localUpdateHandler);\n  }\n  read(key) {\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).get(key);\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        var _a;\n        if ((_a = e.target.result) == null ? void 0 : _a._value) {\n          resolve(e.target.result._value);\n        } else {\n          resolve(null);\n          console.warn(`IDB: cannot read \"${key}\"`);\n        }\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  write(key, value, silent = false) {\n    let data = {\n      _key: key,\n      _value: value\n    };\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).put(data);\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        if (!silent) {\n          this._notifySubscribers(key);\n        }\n        resolve(e.target.result);\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  delete(key, silent = false) {\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).delete(key);\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        if (!silent) {\n          this._notifySubscribers(key);\n        }\n        resolve(e);\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  getAll() {\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).getAll();\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        let all = e.target.result;\n        resolve(all.map((obj) => {\n          return obj._value;\n        }));\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  subscribe(key, callback) {\n    if (!this._subscriptionsMap[key]) {\n      this._subscriptionsMap[key] = /* @__PURE__ */ new Set();\n    }\n    let set = this._subscriptionsMap[key];\n    set.add(callback);\n    return {\n      remove: () => {\n        set.delete(callback);\n        if (!set.size) {\n          delete this._subscriptionsMap[key];\n        }\n      }\n    };\n  }\n  stop() {\n    window.removeEventListener(\"storage\", this._updateHandler);\n    this._subscriptionsMap = null;\n    IDB.clear(this.name);\n  }\n};\nvar IDB = class {\n  static get readyEventName() {\n    return READY_EVENT_NAME;\n  }\n  static open(dbName = DEFAULT_DB_NAME, storeName = \"store\") {\n    let key = dbName + \"/\" + storeName;\n    if (!this._reg[key]) {\n      this._reg[key] = new DbInstance(dbName, storeName);\n    }\n    return this._reg[key];\n  }\n  static clear(dbName) {\n    window.indexedDB.deleteDatabase(dbName);\n    for (let key in this._reg) {\n      if (key.split(\"/\")[0] === dbName) {\n        delete this._reg[key];\n      }\n    }\n  }\n};\n__publicField(IDB, \"_reg\", Object.create(null));\nexport {\n  AppRouter,\n  BaseComponent,\n  Data,\n  IDB,\n  UID,\n  applyAttributes,\n  applyStyles,\n  create,\n  kebabToCamel,\n  setNestedProp\n};\n","/**\n * @template {Function} T\n * @param {T} callback\n * @param {number} wait\n * @returns {T & { cancel: function }}\n */\nexport function debounce(callback, wait) {\n  let timer;\n  /** @type {any} */\n  let debounced = (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => callback(...args), wait);\n  };\n  debounced.cancel = () => {\n    clearTimeout(timer);\n  };\n  return debounced;\n}\n","import { debounce } from '../blocks/utils/debounce.js';\n\nconst WINDOW_HEIGHT_TRACKER_PROPERTY = '--uploadcare-blocks-window-height';\nconst WINDOW_CACHE_KEY = '__UPLOADCARE_BLOCKS_WINDOW_HEIGHT_TRACKER_ENABLED__';\n\nexport function getIsWindowHeightTracked() {\n  return typeof window[WINDOW_CACHE_KEY] === 'undefined' ? false : !!window[WINDOW_CACHE_KEY];\n}\n\nexport function createWindowHeightTracker() {\n  if (getIsWindowHeightTracked()) {\n    return;\n  }\n  const callback = () => {\n    document.documentElement.style.setProperty(WINDOW_HEIGHT_TRACKER_PROPERTY, `${window.innerHeight}px`);\n    window[WINDOW_CACHE_KEY] = true;\n  };\n  const debouncedCallback = debounce(callback, 100);\n  window.addEventListener('resize', debouncedCallback, { passive: true });\n  callback();\n\n  return () => {\n    window[WINDOW_CACHE_KEY] = false;\n    window.removeEventListener('resize', debouncedCallback);\n  };\n}\n","/** @typedef {{ [key: String]: String | Number | Boolean | InputData }} InputData */\n\nconst DEFAULT_TRANSFORMER = (value) => value;\nconst OPEN_TOKEN = '{{';\nconst CLOSE_TOKEN = '}}';\nconst PLURAL_PREFIX = 'plural:';\n\n/**\n * @typedef {Object} Options\n * @property {String} [openToken='{{'] Default is `'{{'`\n * @property {String} [closeToken='}}'] Default is `'}}'`\n * @property {(value: String) => String} [transform=DEFAULT_TRANSFORMER] Default is `DEFAULT_TRANSFORMER`\n */\n\n/**\n * @param {String} template\n * @param {InputData} [data={}] Default is `{}`\n * @param {Options} [options={}] Default is `{}`\n * @returns {String}\n */\nexport function applyTemplateData(template, data, options = {}) {\n  let { openToken = OPEN_TOKEN, closeToken = CLOSE_TOKEN, transform = DEFAULT_TRANSFORMER } = options;\n\n  for (let key in data) {\n    let value = data[key]?.toString();\n    template = template.replaceAll(openToken + key + closeToken, typeof value === 'string' ? transform(value) : value);\n  }\n  return template;\n}\n\n/**\n * @param {String} template\n * @returns {{ variable: string; pluralKey: string; countVariable: string }[]}\n */\nexport function getPluralObjects(template) {\n  const pluralObjects = [];\n  let open = template.indexOf(OPEN_TOKEN);\n  while (open !== -1) {\n    const close = template.indexOf(CLOSE_TOKEN, open);\n    const variable = template.substring(open + 2, close);\n    if (variable.startsWith(PLURAL_PREFIX)) {\n      const keyValue = template.substring(open + 2, close).replace(PLURAL_PREFIX, '');\n      const key = keyValue.substring(0, keyValue.indexOf('('));\n      const count = keyValue.substring(keyValue.indexOf('(') + 1, keyValue.indexOf(')'));\n      pluralObjects.push({ variable, pluralKey: key, countVariable: count });\n    }\n    open = template.indexOf(OPEN_TOKEN, close);\n  }\n  return pluralObjects;\n}\n","function isObject(o) {\n    return Object.prototype.toString.call(o) === '[object Object]';\n}\n\nconst SEPARATOR = /\\W|_/g;\nfunction camelizeString(text) {\n    return text\n        .split(SEPARATOR)\n        .map((word, index) => word.charAt(0)[index > 0 ? 'toUpperCase' : 'toLowerCase']() +\n        word.slice(1))\n        .join('');\n}\nfunction camelizeArrayItems(array, { ignoreKeys } = { ignoreKeys: [] }) {\n    if (!Array.isArray(array)) {\n        return array;\n    }\n    return array.map((item) => camelizeKeys(item, { ignoreKeys }));\n}\nfunction camelizeKeys(source, { ignoreKeys } = { ignoreKeys: [] }) {\n    if (Array.isArray(source)) {\n        return camelizeArrayItems(source, { ignoreKeys });\n    }\n    if (!isObject(source)) {\n        return source;\n    }\n    const result = {};\n    for (const key of Object.keys(source)) {\n        let value = source[key];\n        if (ignoreKeys.includes(key)) {\n            result[key] = value;\n            continue;\n        }\n        if (isObject(value)) {\n            value = camelizeKeys(value, { ignoreKeys });\n        }\n        else if (Array.isArray(value)) {\n            value = camelizeArrayItems(value, { ignoreKeys });\n        }\n        result[camelizeString(key)] = value;\n    }\n    return result;\n}\n\n/**\n * SetTimeout as Promise.\n *\n * @param {number} ms Timeout in milliseconds.\n */\nconst delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\n\nfunction getUserAgent$1({ libraryName, libraryVersion, userAgent, publicKey = '', integration = '' }) {\n    const languageName = 'JavaScript';\n    if (typeof userAgent === 'string') {\n        return userAgent;\n    }\n    if (typeof userAgent === 'function') {\n        return userAgent({\n            publicKey,\n            libraryName,\n            libraryVersion,\n            languageName,\n            integration\n        });\n    }\n    const mainInfo = [libraryName, libraryVersion, publicKey]\n        .filter(Boolean)\n        .join('/');\n    const additionInfo = [languageName, integration].filter(Boolean).join('; ');\n    return `${mainInfo} (${additionInfo})`;\n}\n\nconst defaultOptions = {\n    factor: 2,\n    time: 100\n};\nfunction retrier(fn, options = defaultOptions) {\n    let attempts = 0;\n    function runAttempt(fn) {\n        const defaultDelayTime = Math.round(options.time * options.factor ** attempts);\n        const retry = (ms) => delay(ms ?? defaultDelayTime).then(() => {\n            attempts += 1;\n            return runAttempt(fn);\n        });\n        return fn({\n            attempt: attempts,\n            retry\n        });\n    }\n    return runAttempt(fn);\n}\n\nclass UploadcareNetworkError extends Error {\n    originalProgressEvent;\n    constructor(progressEvent) {\n        super();\n        this.name = 'UploadcareNetworkError';\n        this.message = 'Network error';\n        Object.setPrototypeOf(this, UploadcareNetworkError.prototype);\n        this.originalProgressEvent = progressEvent;\n    }\n}\n\nconst onCancel = (signal, callback) => {\n    if (signal) {\n        if (signal.aborted) {\n            Promise.resolve().then(callback);\n        }\n        else {\n            signal.addEventListener('abort', () => callback(), { once: true });\n        }\n    }\n};\n\nclass CancelError extends Error {\n    isCancel = true;\n    constructor(message = 'Request canceled') {\n        super(message);\n        Object.setPrototypeOf(this, CancelError.prototype);\n    }\n}\n\nconst DEFAULT_INTERVAL = 500;\nconst poll = ({ check, interval = DEFAULT_INTERVAL, timeout, signal }) => new Promise((resolve, reject) => {\n    let tickTimeoutId;\n    let timeoutId;\n    onCancel(signal, () => {\n        tickTimeoutId && clearTimeout(tickTimeoutId);\n        reject(new CancelError('Poll cancelled'));\n    });\n    if (timeout) {\n        timeoutId = setTimeout(() => {\n            tickTimeoutId && clearTimeout(tickTimeoutId);\n            reject(new CancelError('Timed out'));\n        }, timeout);\n    }\n    const tick = () => {\n        try {\n            Promise.resolve(check(signal))\n                .then((result) => {\n                if (result) {\n                    timeoutId && clearTimeout(timeoutId);\n                    resolve(result);\n                }\n                else {\n                    tickTimeoutId = setTimeout(tick, interval);\n                }\n            })\n                .catch((error) => {\n                timeoutId && clearTimeout(timeoutId);\n                reject(error);\n            });\n        }\n        catch (error) {\n            timeoutId && clearTimeout(timeoutId);\n            reject(error);\n        }\n    };\n    tickTimeoutId = setTimeout(tick, 0);\n});\n\n/*\n  Settings for future support:\n  parallelDirectUploads: 10,\n */\nconst defaultSettings = {\n    baseCDN: 'https://ucarecdn.com',\n    baseURL: 'https://upload.uploadcare.com',\n    maxContentLength: 50 * 1024 * 1024,\n    retryThrottledRequestMaxTimes: 1,\n    retryNetworkErrorMaxTimes: 3,\n    multipartMinFileSize: 25 * 1024 * 1024,\n    multipartChunkSize: 5 * 1024 * 1024,\n    multipartMinLastPartSize: 1024 * 1024,\n    maxConcurrentRequests: 4,\n    pollingTimeoutMilliseconds: 10000,\n    pusherKey: '79ae88bd931ea68464d9'\n};\nconst defaultContentType = 'application/octet-stream';\nconst defaultFilename = 'original';\n\nconst request = ({ method, url, data, headers = {}, signal, onProgress }) => new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    const requestMethod = method?.toUpperCase() || 'GET';\n    let aborted = false;\n    /**\n     * Force synchronous flag to be off Some chrome versions gets\n     * `InvalidAccessError` error when we set `responseType` See\n     * https://xhr.spec.whatwg.org/#synchronous-flag and\n     * https://bugs.chromium.org/p/chromium/issues/detail?id=1346628\n     */\n    xhr.open(requestMethod, url, true);\n    if (headers) {\n        Object.entries(headers).forEach((entry) => {\n            const [key, value] = entry;\n            typeof value !== 'undefined' &&\n                !Array.isArray(value) &&\n                xhr.setRequestHeader(key, value);\n        });\n    }\n    xhr.responseType = 'text';\n    onCancel(signal, () => {\n        aborted = true;\n        xhr.abort();\n        reject(new CancelError());\n    });\n    xhr.onload = () => {\n        if (xhr.status != 200) {\n            // analyze HTTP status of the response\n            reject(new Error(`Error ${xhr.status}: ${xhr.statusText}`)); // e.g. 404: Not Found\n        }\n        else {\n            const request = {\n                method: requestMethod,\n                url,\n                data,\n                headers: headers || undefined,\n                signal,\n                onProgress\n            };\n            // Convert the header string into an array\n            // of individual headers\n            const headersArray = xhr\n                .getAllResponseHeaders()\n                .trim()\n                .split(/[\\r\\n]+/);\n            // Create a map of header names to values\n            const responseHeaders = {};\n            headersArray.forEach(function (line) {\n                const parts = line.split(': ');\n                const header = parts.shift();\n                const value = parts.join(': ');\n                if (header && typeof header !== 'undefined') {\n                    responseHeaders[header] = value;\n                }\n            });\n            const responseData = xhr.response;\n            const responseStatus = xhr.status;\n            resolve({\n                request,\n                data: responseData,\n                headers: responseHeaders,\n                status: responseStatus\n            });\n        }\n    };\n    xhr.onerror = (progressEvent) => {\n        if (aborted)\n            return;\n        // only triggers if the request couldn't be made at all\n        reject(new UploadcareNetworkError(progressEvent));\n    };\n    if (onProgress && typeof onProgress === 'function') {\n        xhr.upload.onprogress = (event) => {\n            if (event.lengthComputable) {\n                onProgress({\n                    isComputable: true,\n                    value: event.loaded / event.total\n                });\n            }\n            else {\n                onProgress({ isComputable: false });\n            }\n        };\n    }\n    if (data) {\n        xhr.send(data);\n    }\n    else {\n        xhr.send();\n    }\n});\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction identity(obj, ..._args) {\n    return obj;\n}\n\nconst getFileOptions = ({ name }) => name ? [name] : [];\nconst transformFile = identity;\nvar getFormData = () => new FormData();\n\nconst isBuffer = (data) => false;\n\nconst isBlob = (data) => {\n    return typeof Blob !== 'undefined' && data instanceof Blob;\n};\nconst isFile = (data) => {\n    return typeof File !== 'undefined' && data instanceof File;\n};\nconst isReactNativeAsset = (data) => {\n    return (!!data &&\n        typeof data === 'object' &&\n        !Array.isArray(data) &&\n        'uri' in data &&\n        typeof data.uri === 'string');\n};\nconst isFileData = (data) => {\n    return (isBlob(data) || isFile(data) || isBuffer() || isReactNativeAsset(data));\n};\n\nconst isSimpleValue = (value) => {\n    return (typeof value === 'string' ||\n        typeof value === 'number' ||\n        typeof value === 'undefined');\n};\nconst isObjectValue = (value) => {\n    return !!value && typeof value === 'object' && !Array.isArray(value);\n};\nconst isFileValue = (value) => !!value &&\n    typeof value === 'object' &&\n    'data' in value &&\n    isFileData(value.data);\nfunction collectParams(params, inputKey, inputValue) {\n    if (isFileValue(inputValue)) {\n        const { name, contentType } = inputValue;\n        const file = transformFile(inputValue.data, name, contentType ?? defaultContentType);\n        const options = getFileOptions({ name, contentType });\n        params.push([inputKey, file, ...options]);\n    }\n    else if (isObjectValue(inputValue)) {\n        for (const [key, value] of Object.entries(inputValue)) {\n            if (typeof value !== 'undefined') {\n                params.push([`${inputKey}[${key}]`, String(value)]);\n            }\n        }\n    }\n    else if (isSimpleValue(inputValue) && inputValue) {\n        params.push([inputKey, inputValue.toString()]);\n    }\n}\nfunction getFormDataParams(options) {\n    const params = [];\n    for (const [key, value] of Object.entries(options)) {\n        collectParams(params, key, value);\n    }\n    return params;\n}\nfunction buildFormData(options) {\n    const formData = getFormData();\n    const paramsList = getFormDataParams(options);\n    for (const params of paramsList) {\n        const [key, value, ...rest] = params;\n        // node form-data has another signature for append\n        formData.append(key, value, ...rest);\n    }\n    return formData;\n}\n\nclass UploadClientError extends Error {\n    isCancel;\n    code;\n    request;\n    response;\n    headers;\n    constructor(message, code, request, response, headers) {\n        super();\n        this.name = 'UploadClientError';\n        this.message = message;\n        this.code = code;\n        this.request = request;\n        this.response = response;\n        this.headers = headers;\n        Object.setPrototypeOf(this, UploadClientError.prototype);\n    }\n}\n\nconst buildSearchParams = (query) => {\n    const searchParams = new URLSearchParams();\n    for (const [key, value] of Object.entries(query)) {\n        if (value && typeof value === 'object' && !Array.isArray(value)) {\n            Object.entries(value)\n                .filter((entry) => entry[1] ?? false)\n                .forEach((entry) => searchParams.set(`${key}[${entry[0]}]`, String(entry[1])));\n        }\n        else if (Array.isArray(value)) {\n            value.forEach((val) => {\n                searchParams.append(`${key}[]`, val);\n            });\n        }\n        else if (typeof value === 'string' && value) {\n            searchParams.set(key, value);\n        }\n        else if (typeof value === 'number') {\n            searchParams.set(key, value.toString());\n        }\n    }\n    return searchParams.toString();\n};\nconst getUrl = (base, path, query) => {\n    const url = new URL(base);\n    url.pathname = (url.pathname + path).replace('//', '/');\n    if (query) {\n        url.search = buildSearchParams(query);\n    }\n    return url.toString();\n};\n\nvar version = '6.6.1';\n\nconst LIBRARY_NAME = 'UploadcareUploadClient';\nconst LIBRARY_VERSION = version;\nfunction getUserAgent(options) {\n    return getUserAgent$1({\n        libraryName: LIBRARY_NAME,\n        libraryVersion: LIBRARY_VERSION,\n        ...options\n    });\n}\n\nconst REQUEST_WAS_THROTTLED_CODE = 'RequestThrottledError';\nconst DEFAULT_RETRY_AFTER_TIMEOUT = 15000;\nconst DEFAULT_NETWORK_ERROR_TIMEOUT = 1000;\nfunction getTimeoutFromThrottledRequest(error) {\n    const { headers } = error || {};\n    if (!headers || typeof headers['retry-after'] !== 'string') {\n        return DEFAULT_RETRY_AFTER_TIMEOUT;\n    }\n    const seconds = parseInt(headers['retry-after'], 10);\n    if (!Number.isFinite(seconds)) {\n        return DEFAULT_RETRY_AFTER_TIMEOUT;\n    }\n    return seconds * 1000;\n}\nfunction retryIfFailed(fn, options) {\n    const { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes } = options;\n    return retrier(({ attempt, retry }) => fn().catch((error) => {\n        if ('response' in error &&\n            error?.code === REQUEST_WAS_THROTTLED_CODE &&\n            attempt < retryThrottledRequestMaxTimes) {\n            return retry(getTimeoutFromThrottledRequest(error));\n        }\n        if (error instanceof UploadcareNetworkError &&\n            attempt < retryNetworkErrorMaxTimes) {\n            return retry((attempt + 1) * DEFAULT_NETWORK_ERROR_TIMEOUT);\n        }\n        throw error;\n    }));\n}\n\nconst getContentType = (file) => {\n    let contentType = '';\n    if (isBlob(file) || isFile(file) || isReactNativeAsset(file)) {\n        contentType = file.type;\n    }\n    return contentType || defaultContentType;\n};\n\nconst getFileName = (file) => {\n    let filename = '';\n    if (isFile(file) && file.name) {\n        filename = file.name;\n    }\n    else if (isBlob(file) || isBuffer()) {\n        filename = '';\n    }\n    else if (isReactNativeAsset(file) && file.name) {\n        filename = file.name;\n    }\n    return filename || defaultFilename;\n};\n\nfunction getStoreValue(store) {\n    if (typeof store === 'undefined' || store === 'auto') {\n        return 'auto';\n    }\n    return store ? '1' : '0';\n}\n\n/**\n * Performs file uploading request to Uploadcare Upload API. Can be canceled and\n * has progress.\n */\nfunction base(file, { publicKey, fileName, contentType, baseURL = defaultSettings.baseURL, secureSignature, secureExpire, store, signal, onProgress, source = 'local', integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes, metadata }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        url: getUrl(baseURL, '/base/', {\n            jsonerrors: 1\n        }),\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        data: buildFormData({\n            file: {\n                data: file,\n                name: fileName || getFileName(file),\n                contentType: contentType || getContentType(file)\n            },\n            UPLOADCARE_PUB_KEY: publicKey,\n            UPLOADCARE_STORE: getStoreValue(store),\n            signature: secureSignature,\n            expire: secureExpire,\n            source: source,\n            metadata\n        }),\n        signal,\n        onProgress\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\nvar TypeEnum;\n(function (TypeEnum) {\n    TypeEnum[\"Token\"] = \"token\";\n    TypeEnum[\"FileInfo\"] = \"file_info\";\n})(TypeEnum || (TypeEnum = {}));\n/** Uploading files from URL. */\nfunction fromUrl(sourceUrl, { publicKey, baseURL = defaultSettings.baseURL, store, fileName, checkForUrlDuplicates, saveUrlForRecurrentUploads, secureSignature, secureExpire, source = 'url', signal, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes, metadata }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/from_url/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            source_url: sourceUrl,\n            store: getStoreValue(store),\n            filename: fileName,\n            check_URL_duplicates: checkForUrlDuplicates ? 1 : undefined,\n            save_URL_duplicates: saveUrlForRecurrentUploads ? 1 : undefined,\n            signature: secureSignature,\n            expire: secureExpire,\n            source: source,\n            metadata\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\nvar Status;\n(function (Status) {\n    Status[\"Unknown\"] = \"unknown\";\n    Status[\"Waiting\"] = \"waiting\";\n    Status[\"Progress\"] = \"progress\";\n    Status[\"Error\"] = \"error\";\n    Status[\"Success\"] = \"success\";\n})(Status || (Status = {}));\nconst isErrorResponse = (response) => {\n    return 'status' in response && response.status === Status.Error;\n};\n/** Checking upload status and working with file tokens. */\nfunction fromUrlStatus(token, { publicKey, baseURL = defaultSettings.baseURL, signal, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes } = {}) {\n    return retryIfFailed(() => request({\n        method: 'GET',\n        headers: publicKey\n            ? {\n                'X-UC-User-Agent': getUserAgent({\n                    publicKey,\n                    integration,\n                    userAgent\n                })\n            }\n            : undefined,\n        url: getUrl(baseURL, '/from_url/status/', {\n            jsonerrors: 1,\n            token\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response && !isErrorResponse(response)) {\n            throw new UploadClientError(response.error.content, undefined, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\n/** Create files group. */\nfunction group(uuids, { publicKey, baseURL = defaultSettings.baseURL, jsonpCallback, secureSignature, secureExpire, signal, source, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/group/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            files: uuids,\n            callback: jsonpCallback,\n            signature: secureSignature,\n            expire: secureExpire,\n            source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\n/** Get info about group. */\nfunction groupInfo(id, { publicKey, baseURL = defaultSettings.baseURL, signal, source, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'GET',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/group/info/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            group_id: id,\n            source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\n/** Returns a JSON dictionary holding file info. */\nfunction info(uuid, { publicKey, baseURL = defaultSettings.baseURL, signal, source, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'GET',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/info/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            file_id: uuid,\n            source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\n/** Start multipart uploading. */\nfunction multipartStart(size, { publicKey, contentType, fileName, multipartChunkSize = defaultSettings.multipartChunkSize, baseURL = '', secureSignature, secureExpire, store, signal, source = 'local', integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes, metadata }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        url: getUrl(baseURL, '/multipart/start/', { jsonerrors: 1 }),\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        data: buildFormData({\n            filename: fileName || defaultFilename,\n            size: size,\n            content_type: contentType || defaultContentType,\n            part_size: multipartChunkSize,\n            UPLOADCARE_STORE: getStoreValue(store),\n            UPLOADCARE_PUB_KEY: publicKey,\n            signature: secureSignature,\n            expire: secureExpire,\n            source: source,\n            metadata\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            // convert to array\n            response.parts = Object.keys(response.parts).map((key) => response.parts[key]);\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\n/** Complete multipart uploading. */\nfunction multipartUpload(part, url, { contentType, signal, onProgress, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'PUT',\n        url,\n        data: part,\n        // Upload request can't be non-computable because we always know exact size\n        onProgress: onProgress,\n        signal,\n        headers: {\n            'Content-Type': contentType || defaultContentType\n        }\n    })\n        .then((result) => {\n        // hack for node ¯\\_(ツ)_/¯\n        if (onProgress)\n            onProgress({\n                isComputable: true,\n                value: 1\n            });\n        return result;\n    })\n        .then(({ status }) => ({ code: status })), {\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes\n    });\n}\n\n/** Complete multipart uploading. */\nfunction multipartComplete(uuid, { publicKey, baseURL = defaultSettings.baseURL, source = 'local', signal, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        url: getUrl(baseURL, '/multipart/complete/', { jsonerrors: 1 }),\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        data: buildFormData({\n            uuid: uuid,\n            UPLOADCARE_PUB_KEY: publicKey,\n            source: source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\nfunction isReadyPoll({ file, publicKey, baseURL, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, signal, onProgress }) {\n    return poll({\n        check: (signal) => info(file, {\n            publicKey,\n            baseURL,\n            signal,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes\n        }).then((response) => {\n            if (response.isReady) {\n                return response;\n            }\n            onProgress && onProgress({ isComputable: true, value: 1 });\n            return false;\n        }),\n        signal\n    });\n}\n\nclass UploadcareFile {\n    uuid;\n    name = null;\n    size = null;\n    isStored = null;\n    isImage = null;\n    mimeType = null;\n    cdnUrl = null;\n    s3Url = null;\n    originalFilename = null;\n    imageInfo = null;\n    videoInfo = null;\n    contentInfo = null;\n    metadata = null;\n    s3Bucket = null;\n    constructor(fileInfo, { baseCDN = defaultSettings.baseCDN, fileName } = {}) {\n        const { uuid, s3Bucket } = fileInfo;\n        const cdnUrl = getUrl(baseCDN, `${uuid}/`);\n        const s3Url = s3Bucket\n            ? getUrl(`https://${s3Bucket}.s3.amazonaws.com/`, `${uuid}/${fileInfo.filename}`)\n            : null;\n        this.uuid = uuid;\n        this.name = fileName || fileInfo.filename;\n        this.size = fileInfo.size;\n        this.isStored = fileInfo.isStored;\n        this.isImage = fileInfo.isImage;\n        this.mimeType = fileInfo.mimeType;\n        this.cdnUrl = cdnUrl;\n        this.originalFilename = fileInfo.originalFilename;\n        this.imageInfo = fileInfo.imageInfo;\n        this.videoInfo = fileInfo.videoInfo;\n        this.contentInfo = fileInfo.contentInfo;\n        this.metadata = fileInfo.metadata || null;\n        this.s3Bucket = s3Bucket || null;\n        this.s3Url = s3Url;\n    }\n}\n\nconst uploadDirect = (file, { publicKey, fileName, baseURL, secureSignature, secureExpire, store, contentType, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, baseCDN, metadata }) => {\n    return base(file, {\n        publicKey,\n        fileName,\n        contentType,\n        baseURL,\n        secureSignature,\n        secureExpire,\n        store,\n        signal,\n        onProgress,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes,\n        metadata\n    })\n        .then(({ file }) => {\n        return isReadyPoll({\n            file,\n            publicKey,\n            baseURL,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            onProgress,\n            signal\n        });\n    })\n        .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN }));\n};\n\nconst uploadFromUploaded = (uuid, { publicKey, fileName, baseURL, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, baseCDN }) => {\n    return info(uuid, {\n        publicKey,\n        baseURL,\n        signal,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes\n    })\n        .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN, fileName }))\n        .then((result) => {\n        // hack for node ¯\\_(ツ)_/¯\n        if (onProgress)\n            onProgress({\n                isComputable: true,\n                value: 1\n            });\n        return result;\n    });\n};\n\nconst race = (fns, { signal } = {}) => {\n    let lastError = null;\n    let winnerIndex = null;\n    const controllers = fns.map(() => new AbortController());\n    const createStopRaceCallback = (i) => () => {\n        winnerIndex = i;\n        controllers.forEach((controller, index) => index !== i && controller.abort());\n    };\n    onCancel(signal, () => {\n        controllers.forEach((controller) => controller.abort());\n    });\n    return Promise.all(fns.map((fn, i) => {\n        const stopRace = createStopRaceCallback(i);\n        return Promise.resolve()\n            .then(() => fn({ stopRace, signal: controllers[i].signal }))\n            .then((result) => {\n            stopRace();\n            return result;\n        })\n            .catch((error) => {\n            lastError = error;\n            return null;\n        });\n    })).then((results) => {\n        if (winnerIndex === null) {\n            throw lastError;\n        }\n        else {\n            return results[winnerIndex];\n        }\n    });\n};\n\nvar WebSocket = window.WebSocket;\n\nclass Events {\n    events = Object.create({});\n    emit(event, data) {\n        this.events[event]?.forEach((fn) => fn(data));\n    }\n    on(event, callback) {\n        this.events[event] = this.events[event] || [];\n        this.events[event].push(callback);\n    }\n    off(event, callback) {\n        if (callback) {\n            this.events[event] = this.events[event].filter((fn) => fn !== callback);\n        }\n        else {\n            this.events[event] = [];\n        }\n    }\n}\n\nconst response = (type, data) => {\n    if (type === 'success') {\n        return { status: Status.Success, ...data };\n    }\n    if (type === 'progress') {\n        return { status: Status.Progress, ...data };\n    }\n    return { status: Status.Error, ...data };\n};\nclass Pusher {\n    key;\n    disconnectTime;\n    ws = undefined;\n    queue = [];\n    isConnected = false;\n    subscribers = 0;\n    emmitter = new Events();\n    disconnectTimeoutId = null;\n    constructor(pusherKey, disconnectTime = 30000) {\n        this.key = pusherKey;\n        this.disconnectTime = disconnectTime;\n    }\n    connect() {\n        this.disconnectTimeoutId && clearTimeout(this.disconnectTimeoutId);\n        if (!this.isConnected && !this.ws) {\n            const pusherUrl = `wss://ws.pusherapp.com/app/${this.key}?protocol=5&client=js&version=1.12.2`;\n            this.ws = new WebSocket(pusherUrl);\n            this.ws.addEventListener('error', (error) => {\n                this.emmitter.emit('error', new Error(error.message));\n            });\n            this.emmitter.on('connected', () => {\n                this.isConnected = true;\n                this.queue.forEach((message) => this.send(message.event, message.data));\n                this.queue = [];\n            });\n            this.ws.addEventListener('message', (e) => {\n                const data = JSON.parse(e.data.toString());\n                switch (data.event) {\n                    case 'pusher:connection_established': {\n                        this.emmitter.emit('connected', undefined);\n                        break;\n                    }\n                    case 'pusher:ping': {\n                        this.send('pusher:pong', {});\n                        break;\n                    }\n                    case 'progress':\n                    case 'success':\n                    case 'fail': {\n                        this.emmitter.emit(data.channel, response(data.event, JSON.parse(data.data)));\n                    }\n                }\n            });\n        }\n    }\n    disconnect() {\n        const actualDisconect = () => {\n            this.ws?.close();\n            this.ws = undefined;\n            this.isConnected = false;\n        };\n        if (this.disconnectTime) {\n            this.disconnectTimeoutId = setTimeout(() => {\n                actualDisconect();\n            }, this.disconnectTime);\n        }\n        else {\n            actualDisconect();\n        }\n    }\n    send(event, data) {\n        const str = JSON.stringify({ event, data });\n        this.ws?.send(str);\n    }\n    subscribe(token, handler) {\n        this.subscribers += 1;\n        this.connect();\n        const channel = `task-status-${token}`;\n        const message = {\n            event: 'pusher:subscribe',\n            data: { channel }\n        };\n        this.emmitter.on(channel, handler);\n        if (this.isConnected) {\n            this.send(message.event, message.data);\n        }\n        else {\n            this.queue.push(message);\n        }\n    }\n    unsubscribe(token) {\n        this.subscribers -= 1;\n        const channel = `task-status-${token}`;\n        const message = {\n            event: 'pusher:unsubscribe',\n            data: { channel }\n        };\n        this.emmitter.off(channel);\n        if (this.isConnected) {\n            this.send(message.event, message.data);\n        }\n        else {\n            this.queue = this.queue.filter((msg) => msg.data.channel !== channel);\n        }\n        if (this.subscribers === 0) {\n            this.disconnect();\n        }\n    }\n    onError(callback) {\n        this.emmitter.on('error', callback);\n        return () => this.emmitter.off('error', callback);\n    }\n}\nlet pusher = null;\nconst getPusher = (key) => {\n    if (!pusher) {\n        // no timeout for nodeJS and 30000 ms for browser\n        const disconectTimeout = typeof window === 'undefined' ? 0 : 30000;\n        pusher = new Pusher(key, disconectTimeout);\n    }\n    return pusher;\n};\nconst preconnect = (key) => {\n    getPusher(key).connect();\n};\n\nfunction pollStrategy({ token, publicKey, baseURL, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, onProgress, signal }) {\n    return poll({\n        check: (signal) => fromUrlStatus(token, {\n            publicKey,\n            baseURL,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            signal\n        }).then((response) => {\n            switch (response.status) {\n                case Status.Error: {\n                    return new UploadClientError(response.error, response.errorCode);\n                }\n                case Status.Waiting: {\n                    return false;\n                }\n                case Status.Unknown: {\n                    return new UploadClientError(`Token \"${token}\" was not found.`);\n                }\n                case Status.Progress: {\n                    if (onProgress) {\n                        if (response.total === 'unknown') {\n                            onProgress({ isComputable: false });\n                        }\n                        else {\n                            onProgress({\n                                isComputable: true,\n                                value: response.done / response.total\n                            });\n                        }\n                    }\n                    return false;\n                }\n                case Status.Success: {\n                    if (onProgress)\n                        onProgress({\n                            isComputable: true,\n                            value: response.done / response.total\n                        });\n                    return response;\n                }\n                default: {\n                    throw new Error('Unknown status');\n                }\n            }\n        }),\n        signal\n    });\n}\nconst pushStrategy = ({ token, pusherKey, signal, onProgress }) => new Promise((resolve, reject) => {\n    const pusher = getPusher(pusherKey);\n    const unsubErrorHandler = pusher.onError(reject);\n    const destroy = () => {\n        unsubErrorHandler();\n        pusher.unsubscribe(token);\n    };\n    onCancel(signal, () => {\n        destroy();\n        reject(new CancelError('pusher cancelled'));\n    });\n    pusher.subscribe(token, (result) => {\n        switch (result.status) {\n            case Status.Progress: {\n                if (onProgress) {\n                    if (result.total === 'unknown') {\n                        onProgress({ isComputable: false });\n                    }\n                    else {\n                        onProgress({\n                            isComputable: true,\n                            value: result.done / result.total\n                        });\n                    }\n                }\n                break;\n            }\n            case Status.Success: {\n                destroy();\n                if (onProgress)\n                    onProgress({\n                        isComputable: true,\n                        value: result.done / result.total\n                    });\n                resolve(result);\n                break;\n            }\n            case Status.Error: {\n                destroy();\n                reject(new UploadClientError(result.msg, result.error_code));\n            }\n        }\n    });\n});\nconst uploadFromUrl = (sourceUrl, { publicKey, fileName, baseURL, baseCDN, checkForUrlDuplicates, saveUrlForRecurrentUploads, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, pusherKey = defaultSettings.pusherKey, metadata }) => Promise.resolve(preconnect(pusherKey))\n    .then(() => fromUrl(sourceUrl, {\n    publicKey,\n    fileName,\n    baseURL,\n    checkForUrlDuplicates,\n    saveUrlForRecurrentUploads,\n    secureSignature,\n    secureExpire,\n    store,\n    signal,\n    source,\n    integration,\n    userAgent,\n    retryThrottledRequestMaxTimes,\n    metadata\n}))\n    .catch((error) => {\n    const pusher = getPusher(pusherKey);\n    pusher?.disconnect();\n    return Promise.reject(error);\n})\n    .then((urlResponse) => {\n    if (urlResponse.type === TypeEnum.FileInfo) {\n        return urlResponse;\n    }\n    else {\n        return race([\n            ({ signal }) => pollStrategy({\n                token: urlResponse.token,\n                publicKey,\n                baseURL,\n                integration,\n                userAgent,\n                retryThrottledRequestMaxTimes,\n                onProgress,\n                signal\n            }),\n            ({ signal }) => pushStrategy({\n                token: urlResponse.token,\n                pusherKey,\n                signal,\n                onProgress\n            })\n        ], { signal });\n    }\n})\n    .then((result) => {\n    if (result instanceof UploadClientError)\n        throw result;\n    return result;\n})\n    .then((result) => isReadyPoll({\n    file: result.uuid,\n    publicKey,\n    baseURL,\n    integration,\n    userAgent,\n    retryThrottledRequestMaxTimes,\n    onProgress,\n    signal\n}))\n    .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN }));\n\nconst memo = new WeakMap();\nconst getBlobFromReactNativeAsset = async (asset) => {\n    if (memo.has(asset)) {\n        return memo.get(asset);\n    }\n    const blob = await fetch(asset.uri).then((res) => res.blob());\n    memo.set(asset, blob);\n    return blob;\n};\n\nconst getFileSize = async (file) => {\n    if (isFile(file) || isBlob(file)) {\n        return file.size;\n    }\n    if (isReactNativeAsset(file)) {\n        const blob = await getBlobFromReactNativeAsset(file);\n        return blob.size;\n    }\n    throw new Error(`Unknown file type. Cannot determine file size.`);\n};\n\n/** Check if FileData is multipart data. */\nconst isMultipart = (fileSize, multipartMinFileSize = defaultSettings.multipartMinFileSize) => {\n    return fileSize >= multipartMinFileSize;\n};\n\n/** Uuid type guard. */\nconst isUuid = (data) => {\n    const UUID_REGEX = '[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}';\n    const regExp = new RegExp(UUID_REGEX);\n    return !isFileData(data) && regExp.test(data);\n};\n/**\n * Url type guard.\n *\n * @param {SupportedFileInput | Url | Uuid} data\n */\nconst isUrl = (data) => {\n    const URL_REGEX = '^(?:\\\\w+:)?\\\\/\\\\/([^\\\\s\\\\.]+\\\\.\\\\S{2}|localhost[\\\\:?\\\\d]*)\\\\S*$';\n    const regExp = new RegExp(URL_REGEX);\n    return !isFileData(data) && regExp.test(data);\n};\n\nconst runWithConcurrency = (concurrency, tasks) => {\n    return new Promise((resolve, reject) => {\n        const results = [];\n        let rejected = false;\n        let settled = tasks.length;\n        const forRun = [...tasks];\n        const run = () => {\n            const index = tasks.length - forRun.length;\n            const next = forRun.shift();\n            if (next) {\n                next()\n                    .then((result) => {\n                    if (rejected)\n                        return;\n                    results[index] = result;\n                    settled -= 1;\n                    if (settled) {\n                        run();\n                    }\n                    else {\n                        resolve(results);\n                    }\n                })\n                    .catch((error) => {\n                    rejected = true;\n                    reject(error);\n                });\n            }\n        };\n        for (let i = 0; i < concurrency; i++) {\n            run();\n        }\n    });\n};\n\nconst sliceChunk = (file, index, fileSize, chunkSize) => {\n    const start = chunkSize * index;\n    const end = Math.min(start + chunkSize, fileSize);\n    return file.slice(start, end);\n};\n\nconst prepareChunks = async (file, fileSize, chunkSize) => {\n    return (index) => sliceChunk(file, index, fileSize, chunkSize);\n};\n\nconst uploadPart = (chunk, url, { publicKey, contentType, onProgress, signal, integration, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes }) => multipartUpload(chunk, url, {\n    publicKey,\n    contentType,\n    onProgress,\n    signal,\n    integration,\n    retryThrottledRequestMaxTimes,\n    retryNetworkErrorMaxTimes\n});\nconst uploadMultipart = async (file, { publicKey, fileName, fileSize, baseURL, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, contentType, multipartChunkSize = defaultSettings.multipartChunkSize, maxConcurrentRequests = defaultSettings.maxConcurrentRequests, baseCDN, metadata }) => {\n    const size = fileSize ?? (await getFileSize(file));\n    let progressValues;\n    const createProgressHandler = (totalChunks, chunkIdx) => {\n        if (!onProgress)\n            return;\n        if (!progressValues) {\n            progressValues = Array(totalChunks).fill(0);\n        }\n        const sum = (values) => values.reduce((sum, next) => sum + next, 0);\n        return (info) => {\n            if (!info.isComputable) {\n                return;\n            }\n            progressValues[chunkIdx] = info.value;\n            onProgress({\n                isComputable: true,\n                value: sum(progressValues) / totalChunks\n            });\n        };\n    };\n    contentType ||= getContentType(file);\n    return multipartStart(size, {\n        publicKey,\n        contentType,\n        fileName: fileName || getFileName(file),\n        baseURL,\n        secureSignature,\n        secureExpire,\n        store,\n        signal,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes,\n        metadata\n    })\n        .then(async ({ uuid, parts }) => {\n        const getChunk = await prepareChunks(file, size, multipartChunkSize);\n        return Promise.all([\n            uuid,\n            runWithConcurrency(maxConcurrentRequests, parts.map((url, index) => () => uploadPart(getChunk(index), url, {\n                publicKey,\n                contentType,\n                onProgress: createProgressHandler(parts.length, index),\n                signal,\n                integration,\n                retryThrottledRequestMaxTimes,\n                retryNetworkErrorMaxTimes\n            })))\n        ]);\n    })\n        .then(([uuid]) => multipartComplete(uuid, {\n        publicKey,\n        baseURL,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes\n    }))\n        .then((fileInfo) => {\n        if (fileInfo.isReady) {\n            return fileInfo;\n        }\n        else {\n            return isReadyPoll({\n                file: fileInfo.uuid,\n                publicKey,\n                baseURL,\n                source,\n                integration,\n                userAgent,\n                retryThrottledRequestMaxTimes,\n                retryNetworkErrorMaxTimes,\n                onProgress,\n                signal\n            });\n        }\n    })\n        .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN }));\n};\n\n/** Uploads file from provided data. */\nasync function uploadFile(data, { publicKey, fileName, baseURL = defaultSettings.baseURL, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, contentType, multipartMinFileSize, multipartChunkSize, maxConcurrentRequests, baseCDN = defaultSettings.baseCDN, checkForUrlDuplicates, saveUrlForRecurrentUploads, pusherKey, metadata }) {\n    if (isFileData(data)) {\n        const fileSize = await getFileSize(data);\n        if (isMultipart(fileSize, multipartMinFileSize)) {\n            return uploadMultipart(data, {\n                publicKey,\n                contentType,\n                multipartChunkSize,\n                fileSize,\n                fileName,\n                baseURL,\n                secureSignature,\n                secureExpire,\n                store,\n                signal,\n                onProgress,\n                source,\n                integration,\n                userAgent,\n                maxConcurrentRequests,\n                retryThrottledRequestMaxTimes,\n                retryNetworkErrorMaxTimes,\n                baseCDN,\n                metadata\n            });\n        }\n        return uploadDirect(data, {\n            publicKey,\n            fileName,\n            contentType,\n            baseURL,\n            secureSignature,\n            secureExpire,\n            store,\n            signal,\n            onProgress,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            baseCDN,\n            metadata\n        });\n    }\n    if (isUrl(data)) {\n        return uploadFromUrl(data, {\n            publicKey,\n            fileName,\n            baseURL,\n            baseCDN,\n            checkForUrlDuplicates,\n            saveUrlForRecurrentUploads,\n            secureSignature,\n            secureExpire,\n            store,\n            signal,\n            onProgress,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            pusherKey,\n            metadata\n        });\n    }\n    if (isUuid(data)) {\n        return uploadFromUploaded(data, {\n            publicKey,\n            fileName,\n            baseURL,\n            signal,\n            onProgress,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            baseCDN\n        });\n    }\n    throw new TypeError(`File uploading from \"${data}\" is not supported`);\n}\n\nclass UploadcareGroup {\n    uuid;\n    filesCount;\n    totalSize;\n    isStored;\n    isImage;\n    cdnUrl;\n    files;\n    createdAt;\n    storedAt = null;\n    constructor(groupInfo, files) {\n        this.uuid = groupInfo.id;\n        this.filesCount = groupInfo.filesCount;\n        this.totalSize = Object.values(groupInfo.files).reduce((acc, file) => acc + file.size, 0);\n        this.isStored = !!groupInfo.datetimeStored;\n        this.isImage = !!Object.values(groupInfo.files).filter((file) => file.isImage).length;\n        this.cdnUrl = groupInfo.cdnUrl;\n        this.files = files;\n        this.createdAt = groupInfo.datetimeCreated;\n        this.storedAt = groupInfo.datetimeStored;\n    }\n}\n\n/** FileData type guard. */\nconst isFileDataArray = (data) => {\n    for (const item of data) {\n        if (!isFileData(item)) {\n            return false;\n        }\n    }\n    return true;\n};\n/** Uuid type guard. */\nconst isUuidArray = (data) => {\n    for (const item of data) {\n        if (!isUuid(item)) {\n            return false;\n        }\n    }\n    return true;\n};\n/** Url type guard. */\nconst isUrlArray = (data) => {\n    for (const item of data) {\n        if (!isUrl(item)) {\n            return false;\n        }\n    }\n    return true;\n};\n\nfunction uploadFileGroup(data, { publicKey, fileName, baseURL = defaultSettings.baseURL, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, contentType, multipartChunkSize = defaultSettings.multipartChunkSize, baseCDN = defaultSettings.baseCDN, checkForUrlDuplicates, saveUrlForRecurrentUploads, jsonpCallback }) {\n    if (!isFileDataArray(data) && !isUrlArray(data) && !isUuidArray(data)) {\n        throw new TypeError(`Group uploading from \"${data}\" is not supported`);\n    }\n    let progressValues;\n    let isStillComputable = true;\n    const filesCount = data.length;\n    const createProgressHandler = (size, index) => {\n        if (!onProgress)\n            return;\n        if (!progressValues) {\n            progressValues = Array(size).fill(0);\n        }\n        const normalize = (values) => values.reduce((sum, next) => sum + next) / size;\n        return (info) => {\n            if (!info.isComputable || !isStillComputable) {\n                isStillComputable = false;\n                onProgress({ isComputable: false });\n                return;\n            }\n            progressValues[index] = info.value;\n            onProgress({ isComputable: true, value: normalize(progressValues) });\n        };\n    };\n    return Promise.all(data.map((file, index) => uploadFile(file, {\n        publicKey,\n        fileName,\n        baseURL,\n        secureSignature,\n        secureExpire,\n        store,\n        signal,\n        onProgress: createProgressHandler(filesCount, index),\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes,\n        contentType,\n        multipartChunkSize,\n        baseCDN,\n        checkForUrlDuplicates,\n        saveUrlForRecurrentUploads\n    }))).then((files) => {\n        const uuids = files.map((file) => file.uuid);\n        return group(uuids, {\n            publicKey,\n            baseURL,\n            jsonpCallback,\n            secureSignature,\n            secureExpire,\n            signal,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes\n        })\n            .then((groupInfo) => new UploadcareGroup(groupInfo, files))\n            .then((group) => {\n            onProgress && onProgress({ isComputable: true, value: 1 });\n            return group;\n        });\n    });\n}\n\n/** Populate options with settings. */\nconst populateOptionsWithSettings = (options, settings) => ({\n    ...settings,\n    ...options\n});\nclass UploadClient {\n    settings;\n    constructor(settings) {\n        this.settings = Object.assign({}, defaultSettings, settings);\n    }\n    updateSettings(newSettings) {\n        this.settings = Object.assign(this.settings, newSettings);\n    }\n    getSettings() {\n        return this.settings;\n    }\n    base(file, options = {}) {\n        const settings = this.getSettings();\n        return base(file, populateOptionsWithSettings(options, settings));\n    }\n    info(uuid, options = {}) {\n        const settings = this.getSettings();\n        return info(uuid, populateOptionsWithSettings(options, settings));\n    }\n    fromUrl(sourceUrl, options = {}) {\n        const settings = this.getSettings();\n        return fromUrl(sourceUrl, populateOptionsWithSettings(options, settings));\n    }\n    fromUrlStatus(token, options = {}) {\n        const settings = this.getSettings();\n        return fromUrlStatus(token, populateOptionsWithSettings(options, settings));\n    }\n    group(uuids, options = {}) {\n        const settings = this.getSettings();\n        return group(uuids, populateOptionsWithSettings(options, settings));\n    }\n    groupInfo(id, options = {}) {\n        const settings = this.getSettings();\n        return groupInfo(id, populateOptionsWithSettings(options, settings));\n    }\n    multipartStart(size, options = {}) {\n        const settings = this.getSettings();\n        return multipartStart(size, populateOptionsWithSettings(options, settings));\n    }\n    multipartUpload(part, url, options = {}) {\n        const settings = this.getSettings();\n        return multipartUpload(part, url, populateOptionsWithSettings(options, settings));\n    }\n    multipartComplete(uuid, options = {}) {\n        const settings = this.getSettings();\n        return multipartComplete(uuid, populateOptionsWithSettings(options, settings));\n    }\n    uploadFile(data, options = {}) {\n        const settings = this.getSettings();\n        return uploadFile(data, populateOptionsWithSettings(options, settings));\n    }\n    uploadFileGroup(data, options = {}) {\n        const settings = this.getSettings();\n        return uploadFileGroup(data, populateOptionsWithSettings(options, settings));\n    }\n}\n\nclass Queue {\n    #concurrency = 1;\n    #pending = [];\n    #running = 0;\n    #resolvers = new WeakMap();\n    #rejectors = new WeakMap();\n    constructor(concurrency) {\n        this.#concurrency = concurrency;\n    }\n    #run() {\n        const tasksLeft = this.#concurrency - this.#running;\n        for (let i = 0; i < tasksLeft; i++) {\n            const task = this.#pending.shift();\n            if (!task) {\n                return;\n            }\n            const resolver = this.#resolvers.get(task);\n            const rejector = this.#rejectors.get(task);\n            if (!resolver || !rejector)\n                throw new Error('Unexpected behavior: resolver or rejector is undefined');\n            this.#running += 1;\n            task()\n                .finally(() => {\n                this.#resolvers.delete(task);\n                this.#rejectors.delete(task);\n                this.#running -= 1;\n                this.#run();\n            })\n                .then((value) => resolver(value))\n                .catch((error) => rejector(error));\n        }\n    }\n    add(task) {\n        return new Promise((resolve, reject) => {\n            this.#resolvers.set(task, resolve);\n            this.#rejectors.set(task, reject);\n            this.#pending.push(task);\n            this.#run();\n        });\n    }\n    get pending() {\n        return this.#pending.length;\n    }\n    get running() {\n        return this.#running;\n    }\n    set concurrency(value) {\n        this.#concurrency = value;\n        this.#run();\n    }\n    get concurrency() {\n        return this.#concurrency;\n    }\n}\n\nexport { Queue, UploadClient, UploadClientError, UploadcareFile, UploadcareGroup, UploadcareNetworkError, base, fromUrl, fromUrlStatus, getUserAgent$1 as getUserAgent, group, groupInfo, info, multipartComplete, multipartStart, multipartUpload, uploadDirect, uploadFile, uploadFileGroup, uploadFromUploaded, uploadFromUrl, uploadMultipart };\n","// @ts-check\nimport { Queue } from '@uploadcare/upload-client';\n\nexport const blockCtx = () => ({\n  /** @type {Set<import('./Block').Block>} */\n  '*blocksRegistry': new Set(),\n});\n\n/** @param {import('./Block').Block} fnCtx */\nexport const activityBlockCtx = (fnCtx) => ({\n  ...blockCtx(),\n  '*currentActivity': '',\n  '*currentActivityParams': {},\n  '*history': [],\n  '*historyBack': null,\n  '*closeModal': () => {\n    fnCtx.set$({\n      '*modalActive': false,\n      '*currentActivity': '',\n    });\n  },\n});\n\n/** @param {import('./Block').Block} fnCtx */\nexport const uploaderBlockCtx = (fnCtx) => ({\n  ...activityBlockCtx(fnCtx),\n  '*commonProgress': 0,\n  '*uploadList': [],\n  '*outputData': null,\n  '*focusedEntry': null,\n  '*uploadMetadata': null,\n  '*uploadQueue': new Queue(1),\n});\n","/**\n * @template {import('./Block.js').Block} T\n * @param {DocumentFragment} fr\n * @param {T} fnCtx\n */\nexport function l10nProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll('[l10n]')].forEach((el) => {\n    let key = el.getAttribute('l10n');\n    let elProp = 'textContent';\n    if (key.includes(':')) {\n      let arr = key.split(':');\n      elProp = arr[0];\n      key = arr[1];\n    }\n    let ctxKey = 'l10n:' + key;\n    // @ts-ignore\n    fnCtx.__l10nKeys.push(ctxKey);\n    fnCtx.add(ctxKey, key);\n    fnCtx.sub(ctxKey, (val) => {\n      el[elProp] = fnCtx.l10n(val);\n    });\n    el.removeAttribute('l10n');\n  });\n}\n","// @ts-check\n\n/**\n * @template {keyof import('../types').ConfigType} T\n * @param {T} key\n * @returns {`*cfg/${T}`}\n */\nexport const sharedConfigKey = (key) => `*cfg/${key}`;\n","/**\n * @template {string} T\n * @typedef {T extends `${infer Head} ${infer Tail}` ? `${Lowercase<Head>}-${KebabCase<Tail>}` : Lowercase<T>} KebabCase\n */\n\n/**\n * @template {string} T\n * @param {T} str\n * @returns {KebabCase<T>}\n */\nexport const toKebabCase = (str) =>\n  str\n    .match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g)\n    ?.map((x) => x.toLowerCase())\n    .join('-');\n","const warnings = new Set();\n\n/** @param {string} message */\nexport function warnOnce(message) {\n  if (warnings.has(message)) {\n    return;\n  }\n\n  warnings.add(message);\n  console.warn(message);\n}\n","// @ts-check\n\n/** @typedef {Intl.LDMLPluralRule} PluralForm */\n\n/**\n * @param {string} locale\n * @param {number} count\n * @returns {PluralForm}\n */\nexport const getPluralForm = (locale, count) => {\n  const pluralForm = new Intl.PluralRules(locale).select(count);\n  return pluralForm;\n};\n","// @ts-check\nimport { BaseComponent } from '@symbiotejs/symbiote';\nimport { createWindowHeightTracker, getIsWindowHeightTracked } from '../utils/createWindowHeightTracker.js';\nimport { applyTemplateData, getPluralObjects } from '../utils/template-utils.js';\nimport { blockCtx } from './CTX.js';\nimport { l10nProcessor } from './l10nProcessor.js';\nimport { sharedConfigKey } from './sharedConfigKey.js';\nimport { toKebabCase } from '../utils/toKebabCase.js';\nimport { warnOnce } from '../utils/warnOnce.js';\nimport { getPluralForm } from '../utils/getPluralForm.js';\n\nconst TAG_PREFIX = 'lr-';\n\n// @ts-ignore TODO: fix this\nexport class Block extends BaseComponent {\n  /** @type {string | null} */\n  static StateConsumerScope = null;\n  static className = '';\n  allowCustomTemplate = true;\n\n  init$ = blockCtx();\n\n  /**\n   * @param {String} str\n   * @param {{ [key: string]: string | number }} variables\n   * @returns {String}\n   */\n  l10n(str, variables = {}) {\n    if (!str) {\n      return '';\n    }\n    let template = this.getCssData('--l10n-' + str, true) || str;\n    let pluralObjects = getPluralObjects(template);\n    for (let pluralObject of pluralObjects) {\n      variables[pluralObject.variable] = this.pluralize(\n        pluralObject.pluralKey,\n        Number(variables[pluralObject.countVariable])\n      );\n    }\n    let result = applyTemplateData(template, variables);\n    return result;\n  }\n\n  /**\n   * @param {string} key\n   * @param {number} count\n   * @returns {string}\n   */\n  pluralize(key, count) {\n    const locale = this.l10n('locale-name') || 'en-US';\n    const pluralForm = getPluralForm(locale, count);\n    return this.l10n(`${key}__${pluralForm}`);\n  }\n\n  constructor() {\n    super();\n    /** @type {String} */\n    // @ts-ignore TODO: fix this\n    this.activityType = null;\n    // @ts-ignore TODO: fix this\n    this.addTemplateProcessor(l10nProcessor);\n    // TODO: inspect template on lr-* elements\n    // this.addTemplateProcessor((fr) => {\n    //   [...fr.querySelectorAll('*')].forEach((el) => {\n    //     if (el.tagName.includes('LR-')) {\n    //       let tag = el.tagName.toLowerCase();\n    //       console.log(window.customElements.get(tag)?.name);\n    //     }\n    //   });\n    // });\n    /**\n     * @private\n     * @type {String[]}\n     */\n    this.__l10nKeys = [];\n  }\n\n  /**\n   * @param {String} localPropKey\n   * @param {String} l10nKey\n   */\n  applyL10nKey(localPropKey, l10nKey) {\n    let prop = 'l10n:' + localPropKey;\n    this.$[prop] = /** @type {any} */ (l10nKey);\n    this.__l10nKeys.push(localPropKey);\n  }\n\n  /**\n   * @param {(block: Block) => boolean} callback\n   * @returns {Boolean}\n   */\n  hasBlockInCtx(callback) {\n    // @ts-ignore TODO: fix this\n    /** @type {Set} */\n    let blocksRegistry = this.$['*blocksRegistry'];\n    for (let block of blocksRegistry) {\n      if (callback(block)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * @param {String} consumerScope\n   * @param {String} prop\n   * @param {any} newVal\n   */\n  setForCtxTarget(consumerScope, prop, newVal) {\n    if (this.hasBlockInCtx((b) => /** @type {typeof Block} */ (b.constructor).StateConsumerScope === consumerScope)) {\n      this.$[prop] = newVal;\n    }\n  }\n\n  /** @param {String} activityType */\n  setActivity(activityType) {\n    if (this.hasBlockInCtx((b) => b.activityType === activityType)) {\n      this.$['*currentActivity'] = activityType;\n      return;\n    }\n    console.warn(`Activity type \"${activityType}\" not found in the context`);\n  }\n\n  connectedCallback() {\n    const className = /** @type {typeof Block} */ (this.constructor).className;\n    if (className) {\n      this.classList.toggle(`${TAG_PREFIX}${className}`, true);\n    }\n\n    if (!getIsWindowHeightTracked()) {\n      this._destroyInnerHeightTracker = createWindowHeightTracker();\n    }\n    if (this.hasAttribute('retpl')) {\n      // @ts-ignore TODO: fix this\n      this.constructor['template'] = null;\n      this.processInnerHtml = true;\n    }\n    super.connectedCallback();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._destroyInnerHeightTracker?.();\n  }\n\n  initCallback() {\n    let blocksRegistry = this.$['*blocksRegistry'];\n    blocksRegistry.add(this);\n  }\n\n  destroyCallback() {\n    let blocksRegistry = this.$['*blocksRegistry'];\n    blocksRegistry.delete(this);\n  }\n\n  /**\n   * @param {Number} bytes\n   * @param {Number} [decimals]\n   */\n  fileSizeFmt(bytes, decimals = 2) {\n    let units = ['B', 'KB', 'MB', 'GB', 'TB'];\n    /**\n     * @param {String} str\n     * @returns {String}\n     */\n    let getUnit = (str) => {\n      return this.getCssData('--l10n-unit-' + str.toLowerCase(), true) || str;\n    };\n    if (bytes === 0) {\n      return `0 ${getUnit(units[0])}`;\n    }\n    let k = 1024;\n    let dm = decimals < 0 ? 0 : decimals;\n    let i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / k ** i).toFixed(dm)) + ' ' + getUnit(units[i]);\n  }\n\n  /**\n   * @param {String} url\n   * @returns {String}\n   */\n  proxyUrl(url) {\n    let previewProxy = this.cfg.secureDeliveryProxy;\n    if (!previewProxy) {\n      return url;\n    }\n    return applyTemplateData(\n      previewProxy,\n      { previewUrl: url },\n      { transform: (value) => window.encodeURIComponent(value) }\n    );\n  }\n\n  /**\n   * @param {String} prop\n   * @protected\n   */\n  parseCfgProp(prop) {\n    return {\n      ctx: this.nodeCtx,\n      name: prop.replace('*', ''),\n    };\n  }\n\n  /** @returns {import('../types').ConfigType} } */\n  get cfg() {\n    if (!this.__cfgProxy) {\n      let o = Object.create(null);\n      /** @private */\n      this.__cfgProxy = new Proxy(o, {\n        /**\n         * @param {never} obj\n         * @param {keyof import('../types').ConfigType} key\n         */\n        get: (obj, key) => {\n          const sharedKey = sharedConfigKey(key);\n          const parsed = this.parseCfgProp(sharedKey);\n          if (parsed.ctx.has(parsed.name)) {\n            return parsed.ctx.read(parsed.name);\n          } else {\n            warnOnce(\n              'Using CSS variables for configuration is deprecated. Please use `lr-config` instead. See migration guide: https://uploadcare.com/docs/file-uploader/migration-to-0.25.0/'\n            );\n            return this.getCssData(`--cfg-${toKebabCase(key)}`);\n          }\n        },\n      });\n    }\n    return this.__cfgProxy;\n  }\n\n  /**\n   * @template {keyof import('../types').ConfigType} T\n   * @param {T} key\n   * @param {(value: import('../types').ConfigType[T]) => void} callback\n   */\n  subConfigValue(key, callback) {\n    const parsed = this.parseCfgProp(sharedConfigKey(key));\n    if (parsed.ctx.has(parsed.name)) {\n      this.sub(sharedConfigKey(key), callback);\n    } else {\n      this.bindCssData(`--cfg-${toKebabCase(key)}`);\n      this.sub(`--cfg-${toKebabCase(key)}`, callback);\n    }\n  }\n\n  updateCtxCssData = () => {\n    /** @type {Set<Block>} */\n    let blocks = this.$['*blocksRegistry'];\n    for (let block of blocks) {\n      if (block.isConnected) {\n        block.updateCssData();\n      }\n    }\n  };\n\n  /** @param {String} [name] */\n  static reg(name) {\n    if (!name) {\n      super.reg();\n      return;\n    }\n    super.reg(name.startsWith(TAG_PREFIX) ? name : TAG_PREFIX + name);\n  }\n}\n\nexport { BaseComponent };\n","// @ts-check\nimport { Block } from '../../abstract/Block.js';\n\nexport class Modal extends Block {\n  static StateConsumerScope = 'modal';\n\n  _handleBackdropClick = () => {\n    this._closeDialog();\n  };\n\n  _closeDialog = () => {\n    this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', false);\n  };\n\n  _handleDialogClose = () => {\n    this._closeDialog();\n  };\n\n  /** @param {Event} e */\n  _handleDialogClick = (e) => {\n    if (e.target === this.ref.dialog) {\n      this._closeDialog();\n    }\n  };\n\n  // @ts-ignore TODO: fix this\n  init$ = {\n    ...this.init$,\n    '*modalActive': false,\n    isOpen: false,\n    closeClicked: this._handleDialogClose,\n  };\n\n  show() {\n    if (this.ref.dialog.showModal) {\n      this.ref.dialog.showModal();\n    } else {\n      this.ref.dialog.setAttribute('open', '');\n    }\n  }\n\n  hide() {\n    if (this.ref.dialog.close) {\n      this.ref.dialog.close();\n    } else {\n      this.ref.dialog.removeAttribute('open');\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    if (typeof HTMLDialogElement === 'function') {\n      this.ref.dialog.addEventListener('close', this._handleDialogClose);\n      this.ref.dialog.addEventListener('click', this._handleDialogClick);\n    } else {\n      this.setAttribute('dialog-fallback', '');\n      let backdrop = document.createElement('div');\n      backdrop.className = 'backdrop';\n      this.appendChild(backdrop);\n      backdrop.addEventListener('click', this._handleBackdropClick);\n    }\n\n    this.sub('*modalActive', (modalActive) => {\n      if (this.$.isOpen !== modalActive) {\n        this.$.isOpen = modalActive;\n      }\n\n      if (modalActive && this.cfg.modalScrollLock) {\n        document.body.style.overflow = 'hidden';\n      } else {\n        document.body.style.overflow = '';\n      }\n    });\n\n    this.subConfigValue('modalBackdropStrokes', (val) => {\n      if (val) {\n        this.setAttribute('strokes', '');\n      } else {\n        this.removeAttribute('strokes');\n      }\n    });\n\n    this.sub('isOpen', (isOpen) => {\n      if (isOpen) {\n        this.show();\n      } else {\n        this.hide();\n      }\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    document.body.style.overflow = '';\n    this.ref.dialog.removeEventListener('close', this._handleDialogClose);\n    this.ref.dialog.removeEventListener('click', this._handleDialogClick);\n  }\n}\n\nModal.template = /* HTML */ `\n  <dialog ref=\"dialog\">\n    <slot></slot>\n  </dialog>\n`;\n","// @ts-check\nimport { Modal } from '../blocks/Modal/Modal.js';\nimport { debounce } from '../blocks/utils/debounce.js';\nimport { Block } from './Block.js';\nimport { activityBlockCtx } from './CTX.js';\n\nconst ACTIVE_ATTR = 'active';\nconst ACTIVE_PROP = '___ACTIVITY_IS_ACTIVE___';\n\nexport class ActivityBlock extends Block {\n  historyTracked = false;\n  init$ = activityBlockCtx(this);\n\n  _debouncedHistoryFlush = debounce(this._historyFlush.bind(this), 10);\n\n  /** @private */\n  _deactivate() {\n    // @ts-ignore TODO: fix this\n    let actDesc = ActivityBlock._activityRegistry[this.activityKey];\n    this[ACTIVE_PROP] = false;\n    this.removeAttribute(ACTIVE_ATTR);\n    actDesc?.deactivateCallback?.();\n    // console.log(`Activity \"${this.activityType}\" deactivated`);\n  }\n\n  /** @private */\n  _activate() {\n    // @ts-ignore TODO: fix this\n    let actDesc = ActivityBlock._activityRegistry[this.activityKey];\n    this.$['*historyBack'] = this.historyBack.bind(this);\n    /** @private */\n    this[ACTIVE_PROP] = true;\n    this.setAttribute(ACTIVE_ATTR, '');\n    actDesc?.activateCallback?.();\n    // console.log(`Activity \"${this.activityType}\" activated`);\n\n    this._debouncedHistoryFlush();\n  }\n\n  initCallback() {\n    super.initCallback();\n    if (this.hasAttribute('current-activity')) {\n      this.sub('*currentActivity', (/** @type {String} */ val) => {\n        this.setAttribute('current-activity', val);\n      });\n    }\n\n    // TODO: rename activityType to activityId\n    if (this.activityType) {\n      if (!this.hasAttribute('activity')) {\n        this.setAttribute('activity', this.activityType);\n      }\n      this.sub('*currentActivity', (/** @type {String} */ val) => {\n        if (this.activityType !== val && this[ACTIVE_PROP]) {\n          this._deactivate();\n        } else if (this.activityType === val && !this[ACTIVE_PROP]) {\n          this._activate();\n        }\n\n        if (!val) {\n          this.$['*history'] = [];\n        }\n      });\n    }\n  }\n\n  /** @private */\n  _historyFlush() {\n    let history = this.$['*history'];\n    if (history) {\n      if (history.length > 10) {\n        history = history.slice(history.length - 11, history.length - 1);\n      }\n      if (this.historyTracked) {\n        history.push(this.activityType);\n      }\n      this.$['*history'] = history;\n    }\n  }\n\n  /** @private */\n  _isActivityRegistered() {\n    // @ts-ignore TODO: fix this\n    return this.activityType && !!ActivityBlock._activityRegistry[this.activityKey];\n  }\n\n  /**\n   * @private\n   * @type {{ String: { activateCallback: Function; deactivateCallback: Function } }}\n   */\n  static _activityRegistry = Object.create(null);\n\n  get isActivityActive() {\n    return this[ACTIVE_PROP];\n  }\n\n  /**\n   * TODO: remove name argument\n   *\n   * @param {String} name\n   * @param {Object} [options]\n   * @param {() => void} [options.onActivate]\n   * @param {() => void} [options.onDeactivate]\n   */\n  registerActivity(name, options = {}) {\n    const { onActivate, onDeactivate } = options;\n    if (!ActivityBlock._activityRegistry) {\n      ActivityBlock._activityRegistry = Object.create(null);\n    }\n    // @ts-ignore TODO: fix this\n    ActivityBlock._activityRegistry[this.activityKey] = {\n      activateCallback: onActivate,\n      deactivateCallback: onDeactivate,\n    };\n  }\n\n  unregisterActivity() {\n    if (this.isActivityActive) {\n      this._deactivate();\n    }\n    // @ts-ignore TODO: fix this\n    ActivityBlock._activityRegistry[this.activityKey] = undefined;\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this._isActivityRegistered() && this.unregisterActivity();\n\n    if (Object.keys(ActivityBlock._activityRegistry).length === 0) {\n      // TODO: we should track activities more precise and reset current activity only if there is no such registered activity\n      this.$['*currentActivity'] = null;\n    }\n  }\n\n  get activityKey() {\n    return this.ctxName + this.activityType;\n  }\n\n  get activityParams() {\n    return this.$['*currentActivityParams'];\n  }\n\n  /** @type {String} */\n  get initActivity() {\n    return this.getCssData('--cfg-init-activity');\n  }\n\n  /** @type {String} */\n  get doneActivity() {\n    return this.getCssData('--cfg-done-activity');\n  }\n\n  historyBack() {\n    /** @type {String[]} */\n    let history = this.$['*history'];\n    if (history) {\n      let nextActivity = history.pop();\n      while (nextActivity === this.activityType) {\n        nextActivity = history.pop();\n      }\n      this.$['*currentActivity'] = nextActivity;\n      this.$['*history'] = history;\n      if (!nextActivity) {\n        this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', false);\n      }\n    }\n  }\n}\n\n/** @enum {String} */\nActivityBlock.activities = Object.freeze({\n  START_FROM: 'start-from',\n  CAMERA: 'camera',\n  DRAW: 'draw',\n  UPLOAD_LIST: 'upload-list',\n  URL: 'url',\n  CONFIRMATION: 'confirmation',\n  CLOUD_IMG_EDIT: 'cloud-image-edit',\n  EXTERNAL: 'external',\n  DETAILS: 'details',\n});\n","/**\n * @param {string} str\n * @returns {string[]}\n */\nexport const stringToArray = (str, delimiter = ',') => {\n  return str\n    .trim()\n    .split(delimiter)\n    .map((part) => part.trim())\n    .filter((part) => part.length > 0);\n};\n","// @ts-check\nimport { stringToArray } from './stringToArray.js';\n\nexport const IMAGE_ACCEPT_LIST = [\n  'image/*',\n  'image/heif',\n  'image/heif-sequence',\n  'image/heic',\n  'image/heic-sequence',\n  'image/avif',\n  'image/avif-sequence',\n  '.heif',\n  '.heifs',\n  '.heic',\n  '.heics',\n  '.avif',\n  '.avifs',\n];\n\n/**\n * @param {string[]} [fileTypes]\n * @returns {string[]}\n */\nexport const mergeFileTypes = (fileTypes) => {\n  if (!fileTypes) {\n    return [];\n  }\n  return fileTypes\n    .filter((item) => typeof item === 'string')\n    .map((str) => stringToArray(str))\n    .flat();\n};\n\n/**\n * @param {String} mimeType\n * @param {String[]} allowedFileTypes\n * @returns {Boolean}\n */\nexport const matchMimeType = (mimeType, allowedFileTypes) => {\n  return allowedFileTypes.some((type) => {\n    if (type.endsWith('*')) {\n      type = type.replace('*', '');\n      return mimeType.startsWith(type);\n    }\n\n    return mimeType === type;\n  });\n};\n\n/**\n * @param {String} fileName\n * @param {String[]} allowedFileTypes\n * @returns {Boolean}\n */\nexport const matchExtension = (fileName, allowedFileTypes) => {\n  return allowedFileTypes.some((type) => {\n    if (!type.startsWith('.')) {\n      return false;\n    }\n\n    return fileName.toLowerCase().endsWith(type.toLowerCase());\n  });\n};\n\n/**\n * @param {File | Blob} file\n * @returns {Boolean}\n */\nexport const fileIsImage = (file) => {\n  let type = file?.type;\n  if (!type) {\n    return false;\n  }\n  return matchMimeType(type, IMAGE_ACCEPT_LIST);\n};\n\n/**\n * Checks if the given data is a Blob.\n *\n * @param {unknown} data - The data to check.\n * @returns {boolean} - True if the data is a Blob, false otherwise.\n */\nexport const isBlob = (data) => {\n  return typeof Blob !== 'undefined' && data instanceof Blob;\n};\n\n/**\n * Checks if the given data is a File.\n *\n * @param {unknown} data - The data to check.\n * @returns {boolean} - True if the data is a File, false otherwise.\n */\nexport const isFile = (data) => {\n  return typeof File !== 'undefined' && data instanceof File;\n};\n","// @ts-check\nimport { UploadcareFile } from '@uploadcare/upload-client';\n\n/**\n * @typedef {Object} UploadEntry\n * @property {File} file\n * @property {String} externalUrl\n * @property {String} fileName\n * @property {number} fileSize\n * @property {number} lastModified\n * @property {number} uploadProgress\n * @property {String} uuid\n * @property {Boolean} isImage\n * @property {String} mimeType\n * @property {Error} uploadError\n * @property {String} validationErrorMsg\n * @property {String} ctxName\n * @property {String} cdnUrl\n * @property {String} cdnUrlModifiers\n * @property {UploadcareFile} fileInfo\n * @property {Boolean} isUploading\n * @property {String} thumbUrl\n * @property {Boolean} silentUpload\n */\n\n/**\n * @template {keyof UploadEntry} K\n * @type {Record<K, { type: Function; value: any; nullable?: Boolean }>}\n */\nexport const uploadEntrySchema = Object.freeze({\n  file: {\n    type: File,\n    value: null,\n  },\n  externalUrl: {\n    type: String,\n    value: null,\n  },\n  fileName: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  fileSize: {\n    type: Number,\n    value: null,\n    nullable: true,\n  },\n  lastModified: {\n    type: Number,\n    value: Date.now(),\n  },\n  uploadProgress: {\n    type: Number,\n    value: 0,\n  },\n  uuid: {\n    type: String,\n    value: null,\n  },\n  isImage: {\n    type: Boolean,\n    value: false,\n  },\n  mimeType: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  uploadError: {\n    // TODO: there could be Error or UploadcareClientError\n    type: Error,\n    value: null,\n    nullable: true,\n  },\n  validationErrorMsg: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  validationMultipleLimitMsg: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  ctxName: {\n    type: String,\n    value: null,\n  },\n  cdnUrl: {\n    type: String,\n    value: null,\n  },\n  cdnUrlModifiers: {\n    type: String,\n    value: null,\n  },\n  fileInfo: {\n    type: UploadcareFile,\n    value: null,\n  },\n  isUploading: {\n    type: Boolean,\n    value: false,\n  },\n  abortController: {\n    type: AbortController,\n    value: null,\n    nullable: true,\n  },\n  thumbUrl: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  silentUpload: {\n    type: Boolean,\n    value: false,\n  },\n  source: {\n    type: String,\n    value: false,\n    nullable: true,\n  },\n});\n","/** Do not edit this file manually. It's generated during build process. */\nexport const PACKAGE_NAME = 'blocks';\nexport const PACKAGE_VERSION = '0.25.6';\n","import { getUserAgent } from '@uploadcare/upload-client';\nimport { PACKAGE_VERSION, PACKAGE_NAME } from '../../env.js';\n\n/**\n * @param {import('@uploadcare/upload-client').CustomUserAgentOptions} options\n * @returns {ReturnType<import('@uploadcare/upload-client').CustomUserAgentFn>}\n */\nexport function customUserAgent(options) {\n  return getUserAgent({\n    ...options,\n    libraryName: PACKAGE_NAME,\n    libraryVersion: PACKAGE_VERSION,\n  });\n}\n","import { Data, UID } from '@symbiotejs/symbiote';\n\nconst MSG_NAME = '[Typed State] Wrong property name: ';\nconst MSG_TYPE = '[Typed State] Wrong property type: ';\n\nexport class TypedData {\n  /**\n   * @param {Object<string, { type: any; value: any; nullable?: Boolean }>} typedSchema\n   * @param {String} [ctxName]\n   */\n  constructor(typedSchema, ctxName) {\n    /** @private */\n    this.__typedSchema = typedSchema;\n    /** @private */\n    this.__ctxId = ctxName || UID.generate();\n    /** @private */\n    this.__schema = Object.keys(typedSchema).reduce((acc, key) => {\n      acc[key] = typedSchema[key].value;\n      return acc;\n    }, {});\n    /**\n     * @private\n     * @type {Data}\n     */\n    this.__data = Data.registerCtx(this.__schema, this.__ctxId);\n  }\n\n  /** @returns {String} */\n  get uid() {\n    return this.__ctxId;\n  }\n\n  /**\n   * @param {String} prop\n   * @param {any} value\n   */\n  setValue(prop, value) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return;\n    }\n    let pDesc = this.__typedSchema[prop];\n    if (value?.constructor === pDesc.type || value instanceof pDesc.type || (pDesc.nullable && value === null)) {\n      this.__data.pub(prop, value);\n      return;\n    }\n    console.warn(MSG_TYPE + prop);\n  }\n\n  /** @param {Object<string, any>} updObj */\n  setMultipleValues(updObj) {\n    for (let prop in updObj) {\n      this.setValue(prop, updObj[prop]);\n    }\n  }\n\n  /** @param {String} prop */\n  getValue(prop) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return undefined;\n    }\n    return this.__data.read(prop);\n  }\n\n  /**\n   * @param {String} prop\n   * @param {(newVal: any) => void} handler\n   */\n  subscribe(prop, handler) {\n    return this.__data.sub(prop, handler);\n  }\n\n  remove() {\n    Data.deleteCtx(this.__ctxId);\n  }\n}\n","import { Data, UID } from '@symbiotejs/symbiote';\nimport { TypedData } from './TypedData.js';\n\nexport class TypedCollection {\n  /**\n   * @param {Object} options\n   * @param {Object<string, { type: any; value: any }>} options.typedSchema\n   * @param {String[]} [options.watchList]\n   * @param {(list: string[], added: Set<any>, removed: Set<any>) => void} [options.handler]\n   * @param {String} [options.ctxName]\n   */\n  constructor(options) {\n    /**\n     * @private\n     * @type {Object<string, { type: any; value: any }>}\n     */\n    this.__typedSchema = options.typedSchema;\n    /**\n     * @private\n     * @type {String}\n     */\n    this.__ctxId = options.ctxName || UID.generate();\n    /**\n     * @private\n     * @type {Data}\n     */\n    this.__data = Data.registerCtx({}, this.__ctxId);\n    /**\n     * @private\n     * @type {string[]}\n     */\n    this.__watchList = options.watchList || [];\n    /**\n     * @private\n     * @type {(list: string[], added: Set<any>, removed: Set<any>) => void}\n     */\n    this.__handler = options.handler || null;\n    /**\n     * @private\n     * @type {Object<string, any>}\n     */\n    this.__subsMap = Object.create(null);\n    /**\n     * @private\n     * @type {Set}\n     */\n    this.__observers = new Set();\n    /**\n     * @private\n     * @type {Set<string>}\n     */\n    this.__items = new Set();\n    /**\n     * @private\n     * @type {Set<any>}\n     */\n    this.__removed = new Set();\n    /**\n     * @private\n     * @type {Set<any>}\n     */\n    this.__added = new Set();\n\n    let changeMap = Object.create(null);\n\n    /**\n     * @private\n     * @param {String} propName\n     * @param {String} ctxId\n     */\n    this.__notifyObservers = (propName, ctxId) => {\n      if (this.__observeTimeout) {\n        window.clearTimeout(this.__observeTimeout);\n      }\n      if (!changeMap[propName]) {\n        changeMap[propName] = new Set();\n      }\n      changeMap[propName].add(ctxId);\n      /** @private */\n      this.__observeTimeout = window.setTimeout(() => {\n        this.__observers.forEach((handler) => {\n          handler({ ...changeMap });\n        });\n        changeMap = Object.create(null);\n      });\n    };\n  }\n\n  notify() {\n    if (this.__notifyTimeout) {\n      window.clearTimeout(this.__notifyTimeout);\n    }\n    /** @private */\n    this.__notifyTimeout = window.setTimeout(() => {\n      let added = new Set(this.__added);\n      let removed = new Set(this.__removed);\n      this.__added.clear();\n      this.__removed.clear();\n      this.__handler?.([...this.__items], added, removed);\n    });\n  }\n\n  /** @param {(list: string[], added: Set<any>, removed: Set<any>) => void} handler */\n  setHandler(handler) {\n    this.__handler = handler;\n    this.notify();\n  }\n\n  getHandler() {\n    return this.__handler;\n  }\n\n  removeHandler() {\n    this.__handler = null;\n  }\n\n  /**\n   * @param {Object<string, any>} init\n   * @returns {any}\n   */\n  add(init) {\n    let item = new TypedData(this.__typedSchema);\n    for (let prop in init) {\n      item.setValue(prop, init[prop]);\n    }\n    this.__data.add(item.uid, item);\n    this.__added.add(item);\n    this.__watchList.forEach((propName) => {\n      if (!this.__subsMap[item.uid]) {\n        this.__subsMap[item.uid] = [];\n      }\n      this.__subsMap[item.uid].push(\n        item.subscribe(propName, () => {\n          this.__notifyObservers(propName, item.uid);\n        })\n      );\n    });\n    this.__items.add(item.uid);\n    this.notify();\n    return item;\n  }\n\n  /**\n   * @param {String} id\n   * @returns {TypedData}\n   */\n  read(id) {\n    return this.__data.read(id);\n  }\n\n  /**\n   * @param {String} id\n   * @param {String} propName\n   * @returns {any}\n   */\n  readProp(id, propName) {\n    let item = this.read(id);\n    return item.getValue(propName);\n  }\n\n  /**\n   * @template T\n   * @param {String} id\n   * @param {String} propName\n   * @param {T} value\n   */\n  publishProp(id, propName, value) {\n    let item = this.read(id);\n    item.setValue(propName, value);\n  }\n\n  /** @param {String} id */\n  remove(id) {\n    this.__removed.add(this.__data.read(id));\n    this.__items.delete(id);\n    this.notify();\n    this.__data.pub(id, null);\n    delete this.__subsMap[id];\n  }\n\n  clearAll() {\n    this.__items.forEach((id) => {\n      this.remove(id);\n    });\n  }\n\n  /** @param {Function} handler */\n  observe(handler) {\n    this.__observers.add(handler);\n  }\n\n  /** @param {Function} handler */\n  unobserve(handler) {\n    this.__observers.delete(handler);\n  }\n\n  /**\n   * @param {(item: TypedData) => Boolean} checkFn\n   * @returns {String[]}\n   */\n  findItems(checkFn) {\n    let result = [];\n    this.__items.forEach((id) => {\n      let item = this.read(id);\n      if (checkFn(item)) {\n        result.push(id);\n      }\n    });\n    return result;\n  }\n\n  items() {\n    return [...this.__items];\n  }\n\n  get size() {\n    return this.__items.size;\n  }\n\n  destroy() {\n    Data.deleteCtx(this.__data);\n    this.__observers = null;\n    this.__handler = null;\n    for (let id in this.__subsMap) {\n      this.__subsMap[id].forEach((sub) => {\n        sub.remove();\n      });\n      delete this.__subsMap[id];\n    }\n  }\n}\n","/** @enum {String} */\nexport const EVENT_TYPES = {\n  UPLOAD_START: 'UPLOAD_START',\n  REMOVE: 'REMOVE',\n  UPLOAD_PROGRESS: 'UPLOAD_PROGRESS',\n  UPLOAD_FINISH: 'UPLOAD_FINISH',\n  UPLOAD_ERROR: 'UPLOAD_ERROR',\n  VALIDATION_ERROR: 'VALIDATION_ERROR',\n  CDN_MODIFICATION: 'CLOUD_MODIFICATION',\n  DATA_OUTPUT: 'DATA_OUTPUT',\n  DONE_FLOW: 'DONE_FLOW',\n  INIT_FLOW: 'INIT_FLOW',\n};\n\nexport class EventData {\n  /**\n   * @param {Object} src\n   * @param {EVENT_TYPES} src.type\n   * @param {String} src.ctx\n   * @param {any} [src.data]\n   */\n  constructor(src) {\n    /** @type {String} */\n    this.ctx = src.ctx;\n    /** @type {EVENT_TYPES} */\n    this.type = src.type;\n    this.data = src.data;\n  }\n}\n\nexport class EventManager {\n  /** @param {EVENT_TYPES} type */\n  static eName(type) {\n    return 'LR_' + type;\n  }\n\n  /** @private */\n  static _timeoutStore = Object.create(null);\n\n  /**\n   * @param {EventData} eData\n   * @param {import('./UploaderBlock.js').UploaderBlock | Window} [el]\n   * @param {Boolean} [debounce]\n   */\n  static emit(eData, el = window, debounce = true) {\n    let dispatch = () => {\n      el.dispatchEvent(\n        new CustomEvent(this.eName(eData.type), {\n          detail: eData,\n        })\n      );\n    };\n    if (!debounce) {\n      dispatch();\n      return;\n    }\n    let timeoutKey = eData.type + eData.ctx;\n    if (this._timeoutStore[timeoutKey]) {\n      window.clearTimeout(this._timeoutStore[timeoutKey]);\n    }\n    this._timeoutStore[timeoutKey] = window.setTimeout(() => {\n      dispatch();\n      delete this._timeoutStore[timeoutKey];\n    }, 20);\n  }\n}\n","export const UploadSource = Object.freeze({\n  LOCAL: 'local',\n  DROP_AREA: 'drop-area',\n  URL_TAB: 'url-tab',\n  CAMERA: 'camera',\n  EXTERNAL: 'external',\n  API: 'js-api',\n});\n","// @ts-check\nimport { getPluralForm } from './getPluralForm.js';\n\nconst BASE = 1000;\n\nexport const ByteUnitEnum = Object.freeze({\n  AUTO: 'auto',\n  BYTE: 'byte',\n  KB: 'kb',\n  MB: 'mb',\n  GB: 'gb',\n  TB: 'tb',\n  PB: 'pb',\n});\n\n/**\n * Round a specified number to decimal with two places. Round to larger value, because basically we use it for usage and\n * we charge customers for 1 GB even he consumed 1 byte. Feature limits are usually specified in exact MB/GB/TB, so they\n * will not be rounded.\n *\n * @param {number} number\n * @returns {number}\n */\nconst round = (number) => Math.ceil(number * 100) / 100;\n\n/**\n * @param {number} bytes\n * @param {(typeof ByteUnitEnum)[keyof typeof ByteUnitEnum]} unit\n * @returns {string}\n */\nexport const prettyBytes = (bytes, unit = ByteUnitEnum.AUTO) => {\n  const isAutoMode = unit === ByteUnitEnum.AUTO;\n\n  if (unit === ByteUnitEnum.BYTE || (isAutoMode && bytes < BASE ** 1)) {\n    // TODO: handle blocks locale\n    const pluralForm = /** @type {Extract<import('./getPluralForm').PluralForm, 'one' | 'other'>} */ (\n      getPluralForm('en-US', bytes)\n    );\n    const pluralized = {\n      one: 'byte',\n      other: 'bytes',\n    }[pluralForm];\n\n    return `${bytes} ${pluralized}`;\n  }\n\n  if (unit === ByteUnitEnum.KB || (isAutoMode && bytes < BASE ** 2)) {\n    return `${round(bytes / BASE ** 1)} KB`;\n  }\n\n  if (unit === ByteUnitEnum.MB || (isAutoMode && bytes < BASE ** 3)) {\n    return `${round(bytes / BASE ** 2)} MB`;\n  }\n\n  if (unit === ByteUnitEnum.GB || (isAutoMode && bytes < BASE ** 4)) {\n    return `${round(bytes / BASE ** 3)} GB`;\n  }\n\n  if (unit === ByteUnitEnum.TB || (isAutoMode && bytes < BASE ** 5)) {\n    return `${round(bytes / BASE ** 4)} TB`;\n  }\n\n  return `${round(bytes / BASE ** 5)} PB`;\n};\n","// @ts-check\nimport { ActivityBlock } from './ActivityBlock.js';\n\nimport { Data } from '@symbiotejs/symbiote';\nimport { IMAGE_ACCEPT_LIST, mergeFileTypes, fileIsImage, matchMimeType, matchExtension } from '../utils/fileTypes.js';\nimport { uploadEntrySchema } from './uploadEntrySchema.js';\nimport { customUserAgent } from '../blocks/utils/userAgent.js';\nimport { TypedCollection } from './TypedCollection.js';\nimport { uploaderBlockCtx } from './CTX.js';\nimport { EVENT_TYPES, EventData, EventManager } from './EventManager.js';\nimport { Modal } from '../blocks/Modal/Modal.js';\nimport { stringToArray } from '../utils/stringToArray.js';\nimport { warnOnce } from '../utils/warnOnce.js';\nimport { UploadSource } from '../blocks/utils/UploadSource.js';\nimport { prettyBytes } from '../utils/prettyBytes.js';\nimport { debounce } from '../blocks/utils/debounce.js';\n\nexport class UploaderBlock extends ActivityBlock {\n  couldBeUploadCollectionOwner = false;\n  isUploadCollectionOwner = false;\n\n  init$ = uploaderBlockCtx(this);\n\n  /** @private */\n  __initialUploadMetadata = null;\n\n  /** @private */\n  _validators = [\n    this._validateMultipleLimit.bind(this),\n    this._validateIsImage.bind(this),\n    this._validateFileType.bind(this),\n    this._validateMaxSizeLimit.bind(this),\n  ];\n\n  /**\n   * This is Public JS API method. Could be called before block initialization, so we need to delay state interactions\n   * until block init.\n   *\n   * TODO: If we add more public methods, it is better to use the single queue instead of tons of private fields per\n   * each method. See https://github.com/uploadcare/blocks/pull/162/\n   *\n   * @deprecated Use `metadata` instance property on `lr-config` block instead.\n   * @param {import('@uploadcare/upload-client').Metadata} metadata\n   * @public\n   */\n  setUploadMetadata(metadata) {\n    warnOnce(\n      'setUploadMetadata is deprecated. Use `metadata` instance property on `lr-config` block instead. See migration guide: https://uploadcare.com/docs/file-uploader/migration-to-0.25.0/'\n    );\n    if (!this.connectedOnce) {\n      // @ts-ignore TODO: fix this\n      this.__initialUploadMetadata = metadata;\n    } else {\n      this.$['*uploadMetadata'] = metadata;\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    if (!this.has('*uploadCollection')) {\n      let uploadCollection = new TypedCollection({\n        typedSchema: uploadEntrySchema,\n        watchList: [\n          'uploadProgress',\n          'fileInfo',\n          'uploadError',\n          'validationErrorMsg',\n          'validationMultipleLimitMsg',\n          'cdnUrlModifiers',\n        ],\n      });\n      this.add('*uploadCollection', uploadCollection);\n    }\n\n    const hasUploadCollectionOwner = () =>\n      this.hasBlockInCtx((block) => {\n        if (block instanceof UploaderBlock) {\n          return block.isUploadCollectionOwner && block.isConnected && block !== this;\n        }\n        return false;\n      });\n\n    if (this.couldBeUploadCollectionOwner && !hasUploadCollectionOwner()) {\n      this.isUploadCollectionOwner = true;\n\n      /**\n       * @private\n       * @type {Parameters<import('./TypedCollection.js').TypedCollection['setHandler']>[0]}\n       */\n      this.__uploadCollectionHandler = (entries, added, removed) => {\n        this._runValidators();\n\n        for (let entry of removed) {\n          entry?.getValue('abortController')?.abort();\n          entry?.setValue('abortController', null);\n          URL.revokeObjectURL(entry?.getValue('thumbUrl'));\n        }\n        this.$['*uploadList'] = entries.map((uid) => {\n          return { uid };\n        });\n      };\n      this.uploadCollection.setHandler(this.__uploadCollectionHandler);\n\n      this.uploadCollection.observe(this._handleCollectionUpdate);\n\n      this.subConfigValue('maxLocalFileSizeBytes', () => this._debouncedRunValidators());\n      this.subConfigValue('multipleMin', () => this._debouncedRunValidators());\n      this.subConfigValue('multipleMax', () => this._debouncedRunValidators());\n      this.subConfigValue('multiple', () => this._debouncedRunValidators());\n      this.subConfigValue('imgOnly', () => this._debouncedRunValidators());\n      this.subConfigValue('accept', () => this._debouncedRunValidators());\n    }\n\n    if (this.__initialUploadMetadata) {\n      this.$['*uploadMetadata'] = this.__initialUploadMetadata;\n    }\n\n    this.subConfigValue('maxConcurrentRequests', (value) => {\n      this.$['*uploadQueue'].concurrency = Number(value) || 1;\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    if (this.isUploadCollectionOwner) {\n      this.uploadCollection.unobserve(this._handleCollectionUpdate);\n      if (this.uploadCollection.getHandler() === this.__uploadCollectionHandler) {\n        this.uploadCollection.removeHandler();\n      }\n    }\n  }\n\n  // TODO: Probably we should not allow user to override `source` property\n\n  /**\n   * @param {string} url\n   * @param {{ silent?: boolean; fileName?: string; source?: string }} [options]\n   */\n  addFileFromUrl(url, { silent, fileName, source } = {}) {\n    this.uploadCollection.add({\n      externalUrl: url,\n      fileName: fileName ?? null,\n      silentUpload: silent ?? false,\n      source: source ?? UploadSource.API,\n    });\n  }\n\n  /**\n   * @param {string} uuid\n   * @param {{ silent?: boolean; fileName?: string; source?: string }} [options]\n   */\n  addFileFromUuid(uuid, { silent, fileName, source } = {}) {\n    this.uploadCollection.add({\n      uuid,\n      fileName: fileName ?? null,\n      silentUpload: silent ?? false,\n      source: source ?? UploadSource.API,\n    });\n  }\n\n  /**\n   * @param {File} file\n   * @param {{ silent?: boolean; fileName?: string; source?: string }} [options]\n   */\n  addFileFromObject(file, { silent, fileName, source } = {}) {\n    this.uploadCollection.add({\n      file,\n      isImage: fileIsImage(file),\n      mimeType: file.type,\n      fileName: fileName ?? file.name,\n      fileSize: file.size,\n      silentUpload: silent ?? false,\n      source: source ?? UploadSource.API,\n    });\n  }\n\n  /**\n   * @deprecated Will be removed in the near future. Please use `addFileFromObject`, `addFileFromUrl` or\n   *   `addFileFromUuid` instead.\n   * @param {File[]} files\n   */\n  addFiles(files) {\n    console.warn(\n      '`addFiles` method is deprecated. Please use `addFileFromObject`, `addFileFromUrl` or `addFileFromUuid` instead.'\n    );\n    files.forEach((/** @type {File} */ file) => {\n      this.uploadCollection.add({\n        file,\n        isImage: fileIsImage(file),\n        mimeType: file.type,\n        fileName: file.name,\n        fileSize: file.size,\n      });\n    });\n  }\n\n  uploadAll() {\n    this.$['*uploadTrigger'] = {};\n  }\n\n  /** @param {{ captureCamera?: boolean }} options */\n  openSystemDialog(options = {}) {\n    let accept = mergeFileTypes([this.cfg.accept ?? '', ...(this.cfg.imgOnly ? IMAGE_ACCEPT_LIST : [])]).join(',');\n\n    if (this.cfg.accept && !!this.cfg.imgOnly) {\n      console.warn(\n        'There could be a mistake.\\n' +\n          'Both `accept` and `imgOnly` parameters are set.\\n' +\n          'The value of `accept` will be concatenated with the internal image mime types list.'\n      );\n    }\n    this.fileInput = document.createElement('input');\n    this.fileInput.type = 'file';\n    this.fileInput.multiple = this.cfg.multiple;\n    if (options.captureCamera) {\n      this.fileInput.capture = '';\n      this.fileInput.accept = IMAGE_ACCEPT_LIST.join(',');\n    } else {\n      this.fileInput.accept = accept;\n    }\n    this.fileInput.dispatchEvent(new MouseEvent('click'));\n    this.fileInput.onchange = () => {\n      // @ts-ignore TODO: fix this\n      [...this.fileInput['files']].forEach((file) => this.addFileFromObject(file, { source: UploadSource.LOCAL }));\n      // To call uploadTrigger UploadList should draw file items first:\n      this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n      this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n      // @ts-ignore TODO: fix this\n      this.fileInput['value'] = '';\n      this.fileInput = null;\n    };\n  }\n\n  /** @type {string[]} */\n  get sourceList() {\n    /** @type {string[]} */\n    let list = [];\n    if (this.cfg.sourceList) {\n      list = stringToArray(this.cfg.sourceList);\n    }\n    // @ts-ignore TODO: fix this\n    return list;\n  }\n\n  /** @param {Boolean} [force] */\n  initFlow(force = false) {\n    if (this.$['*uploadList']?.length && !force) {\n      this.set$({\n        '*currentActivity': ActivityBlock.activities.UPLOAD_LIST,\n      });\n      this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n    } else {\n      if (this.sourceList?.length === 1) {\n        let srcKey = this.sourceList[0];\n        // Single source case:\n        if (srcKey === 'local') {\n          this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n          this?.['openSystemDialog']();\n        } else {\n          if (Object.values(UploaderBlock.extSrcList).includes(/** @type {any} */ (srcKey))) {\n            this.set$({\n              '*currentActivityParams': {\n                externalSourceType: srcKey,\n              },\n              '*currentActivity': ActivityBlock.activities.EXTERNAL,\n            });\n          } else {\n            this.$['*currentActivity'] = srcKey;\n          }\n          this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n        }\n      } else {\n        // Multiple sources case:\n        this.set$({\n          '*currentActivity': ActivityBlock.activities.START_FROM,\n        });\n        this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n      }\n    }\n    EventManager.emit(\n      new EventData({\n        type: EVENT_TYPES.INIT_FLOW,\n        ctx: this.ctxName,\n      }),\n      undefined,\n      false\n    );\n  }\n\n  doneFlow() {\n    this.set$({\n      '*currentActivity': this.doneActivity,\n      '*history': this.doneActivity ? [this.doneActivity] : [],\n    });\n    if (!this.$['*currentActivity']) {\n      this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', false);\n    }\n    EventManager.emit(\n      new EventData({\n        type: EVENT_TYPES.DONE_FLOW,\n        ctx: this.ctxName,\n      }),\n      undefined,\n      false\n    );\n  }\n\n  /** @returns {TypedCollection} */\n  get uploadCollection() {\n    return this.$['*uploadCollection'];\n  }\n\n  /**\n   * @private\n   * @param {import('./TypedData.js').TypedData} entry\n   */\n  _validateFileType(entry) {\n    const imagesOnly = this.cfg.imgOnly;\n    const accept = this.cfg.accept;\n    const allowedFileTypes = mergeFileTypes([...(imagesOnly ? IMAGE_ACCEPT_LIST : []), accept]);\n    if (!allowedFileTypes.length) return;\n\n    const mimeType = entry.getValue('mimeType');\n    const fileName = entry.getValue('fileName');\n\n    if (!mimeType || !fileName) {\n      // Skip client validation if mime type or file name are not available for some reasons\n      return;\n    }\n\n    const mimeOk = matchMimeType(mimeType, allowedFileTypes);\n    const extOk = matchExtension(fileName, allowedFileTypes);\n\n    if (!mimeOk && !extOk) {\n      // Assume file type is not allowed if both mime and ext checks fail\n      return this.l10n('file-type-not-allowed');\n    }\n  }\n\n  /**\n   * @private\n   * @param {import('./TypedData.js').TypedData} entry\n   */\n  _validateMaxSizeLimit(entry) {\n    const maxFileSize = this.cfg.maxLocalFileSizeBytes;\n    const fileSize = entry.getValue('fileSize');\n    if (maxFileSize && fileSize && fileSize > maxFileSize) {\n      return this.l10n('files-max-size-limit-error', { maxFileSize: prettyBytes(maxFileSize) });\n    }\n  }\n\n  /**\n   * @private\n   * @param {import('./TypedData.js').TypedData} entry\n   */\n  _validateMultipleLimit(entry) {\n    const entryIds = this.uploadCollection.items();\n    const entryIdx = entryIds.indexOf(entry.uid);\n    const multipleMax = this.cfg.multiple ? this.cfg.multipleMax : 1;\n\n    if (multipleMax && entryIdx >= multipleMax) {\n      const message = this.l10n('files-count-allowed', {\n        count: multipleMax,\n      });\n      return message;\n    }\n  }\n\n  /**\n   * @private\n   * @param {import('./TypedData.js').TypedData} entry\n   */\n  _validateIsImage(entry) {\n    const imagesOnly = this.cfg.imgOnly;\n    const isImage = entry.getValue('isImage');\n    if (!imagesOnly || isImage) {\n      return;\n    }\n    if (!entry.getValue('fileInfo') && entry.getValue('externalUrl')) {\n      // skip validation for not uploaded files with external url, cause we don't know if they're images or not\n      return;\n    }\n    if (!entry.getValue('fileInfo') && !entry.getValue('mimeType')) {\n      // skip validation for not uploaded files without mime-type, cause we don't know if they're images or not\n      return;\n    }\n    return this.l10n('images-only-accepted');\n  }\n\n  /**\n   * @private\n   * @param {import('./TypedData.js').TypedData} entry\n   */\n  _runValidatorsForEntry(entry) {\n    for (const validator of this._validators) {\n      const errorMsg = validator(entry);\n      if (errorMsg) {\n        entry.setValue('validationErrorMsg', errorMsg);\n        return;\n      }\n    }\n    entry.setValue('validationErrorMsg', null);\n  }\n\n  /** @private */\n  _debouncedRunValidators = debounce(this._runValidators.bind(this), 100);\n\n  /** @private */\n  _runValidators() {\n    for (const id of this.uploadCollection.items()) {\n      setTimeout(() => {\n        const entry = this.uploadCollection.read(id);\n        entry && this._runValidatorsForEntry(entry);\n      });\n    }\n  }\n\n  /**\n   * @private\n   * @param {Record<string, any>} changeMap\n   */\n  _handleCollectionUpdate = (changeMap) => {\n    const uploadCollection = this.uploadCollection;\n    const updatedEntries = [\n      ...new Set(\n        Object.values(changeMap)\n          .map((ids) => [...ids])\n          .flat()\n      ),\n    ]\n      .map((id) => uploadCollection.read(id))\n      .filter(Boolean);\n\n    for (const entry of updatedEntries) {\n      this._runValidatorsForEntry(entry);\n    }\n    if (changeMap.uploadProgress) {\n      let commonProgress = 0;\n      /** @type {String[]} */\n      let items = uploadCollection.findItems((entry) => {\n        return !entry.getValue('uploadError');\n      });\n      items.forEach((id) => {\n        commonProgress += uploadCollection.readProp(id, 'uploadProgress');\n      });\n      let progress = Math.round(commonProgress / items.length);\n      this.$['*commonProgress'] = progress;\n      EventManager.emit(\n        new EventData({\n          type: EVENT_TYPES.UPLOAD_PROGRESS,\n          ctx: this.ctxName,\n          data: progress,\n        }),\n        undefined,\n        progress === 100\n      );\n    }\n    if (changeMap.fileInfo) {\n      let loadedItems = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('fileInfo');\n      });\n      let errorItems = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('uploadError') || !!entry.getValue('validationErrorMsg');\n      });\n      if (uploadCollection.size - errorItems.length === loadedItems.length) {\n        let data = this.getOutputData((dataItem) => {\n          return !!dataItem.getValue('fileInfo') && !dataItem.getValue('silentUpload');\n        });\n        data.length > 0 &&\n          EventManager.emit(\n            new EventData({\n              type: EVENT_TYPES.UPLOAD_FINISH,\n              ctx: this.ctxName,\n              data,\n            })\n          );\n      }\n    }\n    if (changeMap.uploadError) {\n      let items = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('uploadError');\n      });\n      items.forEach((id) => {\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.UPLOAD_ERROR,\n            ctx: this.ctxName,\n            data: uploadCollection.readProp(id, 'uploadError'),\n          }),\n          undefined,\n          false\n        );\n      });\n    }\n    if (changeMap.validationErrorMsg) {\n      let items = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('validationErrorMsg');\n      });\n      items.forEach((id) => {\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.VALIDATION_ERROR,\n            ctx: this.ctxName,\n            data: uploadCollection.readProp(id, 'validationErrorMsg'),\n          }),\n          undefined,\n          false\n        );\n      });\n    }\n    if (changeMap.cdnUrlModifiers) {\n      let items = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('cdnUrlModifiers');\n      });\n      items.forEach((id) => {\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.CDN_MODIFICATION,\n            ctx: this.ctxName,\n            data: Data.getCtx(id).store,\n          }),\n          undefined,\n          false\n        );\n      });\n    }\n  };\n\n  /** @private */\n  async getMetadata() {\n    const configValue = this.cfg.metadata ?? /** @type {import('../types').Metadata} */ (this.$['*uploadMetadata']);\n    if (typeof configValue === 'function') {\n      const metadata = await configValue();\n      return metadata;\n    }\n    return configValue;\n  }\n\n  /** @returns {Promise<import('@uploadcare/upload-client').FileFromOptions>} */\n  async getUploadClientOptions() {\n    let options = {\n      store: this.cfg.store,\n      publicKey: this.cfg.pubkey,\n      baseCDN: this.cfg.cdnCname,\n      baseURL: this.cfg.baseUrl,\n      userAgent: customUserAgent,\n      integration: this.cfg.userAgentIntegration,\n      secureSignature: this.cfg.secureSignature,\n      secureExpire: this.cfg.secureExpire,\n      retryThrottledRequestMaxTimes: this.cfg.retryThrottledRequestMaxTimes,\n      multipartMinFileSize: this.cfg.multipartMinFileSize,\n      multipartChunkSize: this.cfg.multipartChunkSize,\n      maxConcurrentRequests: this.cfg.multipartMaxConcurrentRequests,\n      multipartMaxAttempts: this.cfg.multipartMaxAttempts,\n      checkForUrlDuplicates: !!this.cfg.checkForUrlDuplicates,\n      saveUrlForRecurrentUploads: !!this.cfg.saveUrlForRecurrentUploads,\n      metadata: await this.getMetadata(),\n    };\n\n    console.log('Upload client options:', options);\n\n    return options;\n  }\n\n  /** @param {(item: import('./TypedData.js').TypedData) => Boolean} checkFn */\n  getOutputData(checkFn) {\n    // @ts-ignore TODO: fix this\n    let data = [];\n    let items = this.uploadCollection.findItems(checkFn);\n    items.forEach((itemId) => {\n      let uploadEntryData = Data.getCtx(itemId).store;\n      /** @type {import('@uploadcare/upload-client').UploadcareFile} */\n      let fileInfo = uploadEntryData.fileInfo || {\n        name: uploadEntryData.fileName,\n        fileSize: uploadEntryData.fileSize,\n        isImage: uploadEntryData.isImage,\n        mimeType: uploadEntryData.mimeType,\n      };\n      let outputItem = {\n        ...fileInfo,\n        cdnUrlModifiers: uploadEntryData.cdnUrlModifiers,\n        cdnUrl: uploadEntryData.cdnUrl || fileInfo.cdnUrl,\n      };\n      data.push(outputItem);\n    });\n    // @ts-ignore TODO: fix this\n    return data;\n  }\n}\n\n/** @enum {String} */\nUploaderBlock.extSrcList = Object.freeze({\n  FACEBOOK: 'facebook',\n  DROPBOX: 'dropbox',\n  GDRIVE: 'gdrive',\n  GPHOTOS: 'gphotos',\n  INSTAGRAM: 'instagram',\n  FLICKR: 'flickr',\n  VK: 'vk',\n  EVERNOTE: 'evernote',\n  BOX: 'box',\n  ONEDRIVE: 'onedrive',\n  HUDDLE: 'huddle',\n});\n\n/** @enum {String} */\nUploaderBlock.sourceTypes = Object.freeze({\n  LOCAL: 'local',\n  URL: 'url',\n  CAMERA: 'camera',\n  DRAW: 'draw',\n  ...UploaderBlock.extSrcList,\n});\n\nObject.values(EVENT_TYPES).forEach((eType) => {\n  let eName = EventManager.eName(eType);\n  window.addEventListener(eName, (e) => {\n    let outputTypes = [EVENT_TYPES.UPLOAD_FINISH, EVENT_TYPES.REMOVE, EVENT_TYPES.CDN_MODIFICATION];\n    // @ts-ignore TODO: fix this\n    if (outputTypes.includes(e.detail.type)) {\n      // @ts-ignore TODO: fix this\n      let dataCtx = Data.getCtx(e.detail.ctx);\n      /** @type {TypedCollection} */\n      let uploadCollection = dataCtx.read('uploadCollection');\n      // @ts-ignore TODO: fix this\n      let data = [];\n      uploadCollection.items().forEach((id) => {\n        let uploadEntryData = Data.getCtx(id).store;\n        /** @type {import('@uploadcare/upload-client').UploadcareFile} */\n        let fileInfo = uploadEntryData.fileInfo;\n        if (fileInfo) {\n          let outputItem = {\n            ...fileInfo,\n            cdnUrlModifiers: uploadEntryData.cdnUrlModifiers,\n            cdnUrl: uploadEntryData.cdnUrl || fileInfo.cdnUrl,\n          };\n          data.push(outputItem);\n        }\n      });\n      EventManager.emit(\n        new EventData({\n          type: EVENT_TYPES.DATA_OUTPUT,\n          // @ts-ignore TODO: fix this\n          ctx: e.detail.ctx,\n          // @ts-ignore TODO: fix this\n          data,\n        })\n      );\n      // @ts-ignore TODO: fix this\n      dataCtx.pub('outputData', data);\n    }\n  });\n});\n","// @ts-check\n\nexport const DEFAULT_CDN_CNAME = 'https://ucarecdn.com';\nexport const DEFAULT_BASE_URL = 'https://upload.uploadcare.com';\nexport const DEFAULT_SOCIAN_BASE_URL = 'https://social.uploadcare.com';\n\n/** @type {import('../../types/exported').ConfigType} */\nexport const initialConfig = Object.freeze({\n  pubkey: '',\n  multiple: true,\n  multipleMin: 0,\n  multipleMax: 0,\n\n  confirmUpload: false,\n  imgOnly: false,\n  accept: '',\n  externalSourcesPreferredTypes: '',\n  store: 'auto',\n  cameraMirror: false,\n  sourceList: 'local, url, camera, dropbox, gdrive',\n  maxLocalFileSizeBytes: 0,\n  thumbSize: 76,\n  showEmptyList: false,\n  useLocalImageEditor: false,\n  useCloudImageEditor: true,\n  removeCopyright: false,\n\n  modalScrollLock: true,\n  modalBackdropStrokes: false,\n\n  sourceListWrap: true,\n\n  remoteTabSessionKey: '',\n  cdnCname: DEFAULT_CDN_CNAME,\n  baseUrl: DEFAULT_BASE_URL,\n  socialBaseUrl: DEFAULT_SOCIAN_BASE_URL,\n  secureSignature: '',\n  secureExpire: '',\n  secureDeliveryProxy: '',\n  retryThrottledRequestMaxTimes: 1,\n  multipartMinFileSize: 26214400,\n  multipartChunkSize: 5242880,\n  maxConcurrentRequests: 10,\n  multipartMaxConcurrentRequests: 4,\n  multipartMaxAttempts: 3,\n  checkForUrlDuplicates: false,\n  saveUrlForRecurrentUploads: false,\n\n  groupOutput: false,\n  userAgentIntegration: '',\n\n  metadata: null,\n});\n","// @ts-check\n\n/** @param {unknown} value */\nconst asString = (value) => String(value);\n/** @param {unknown} value */\nconst asNumber = (value) => Number(value);\n/** @param {unknown} value */\nconst asBoolean = (value) => {\n  if (typeof value === 'boolean') return value;\n  // for attr like multiple=\"true\" (react will pass it as string)\n  if (value === 'true') return true;\n  // for attr flags like multiple=\"\" (some other libs will pass it as empty string)\n  if (value === '') return true;\n  // for attr like multiple=\"false\" (react will pass it as string)\n  if (value === 'false') return false;\n  return Boolean(value);\n};\n/** @param {unknown} value */\nconst asStore = (value) => (value === 'auto' ? value : asBoolean(value));\n\n/**\n * @type {{\n *   [Key in keyof import('../../types').ConfigPlainType]: (value: unknown) => import('../../types').ConfigType[Key];\n * }}\n */\nconst mapping = {\n  pubkey: asString,\n  multiple: asBoolean,\n  multipleMin: asNumber,\n  multipleMax: asNumber,\n\n  confirmUpload: asBoolean,\n  imgOnly: asBoolean,\n  accept: asString,\n  externalSourcesPreferredTypes: asString,\n  store: asStore,\n  cameraMirror: asBoolean,\n  sourceList: asString,\n  maxLocalFileSizeBytes: asNumber,\n  thumbSize: asNumber,\n  showEmptyList: asBoolean,\n  useLocalImageEditor: asBoolean,\n  useCloudImageEditor: asBoolean,\n  removeCopyright: asBoolean,\n\n  modalScrollLock: asBoolean,\n  modalBackdropStrokes: asBoolean,\n\n  sourceListWrap: asBoolean,\n\n  remoteTabSessionKey: asString,\n  cdnCname: asString,\n  baseUrl: asString,\n  socialBaseUrl: asString,\n  secureSignature: asString,\n  secureExpire: asString,\n  secureDeliveryProxy: asString,\n  retryThrottledRequestMaxTimes: asNumber,\n  multipartMinFileSize: asNumber,\n  multipartChunkSize: asNumber,\n  maxConcurrentRequests: asNumber,\n  multipartMaxConcurrentRequests: asNumber,\n  multipartMaxAttempts: asNumber,\n  checkForUrlDuplicates: asBoolean,\n  saveUrlForRecurrentUploads: asBoolean,\n\n  groupOutput: asBoolean,\n  userAgentIntegration: asString,\n};\n\n/**\n * @template {keyof import('../../types').ConfigPlainType} T\n * @param {T} key\n * @param {unknown} value\n * @returns {import('../../types').ConfigType[T] | undefined}\n */\nexport const normalizeConfigValue = (key, value) => {\n  if (typeof value === 'undefined' || value === null) {\n    return undefined;\n  }\n  return mapping[key](value);\n};\n","// @ts-check\nimport { Block } from '../../abstract/Block.js';\nimport { initialConfig } from './initialConfig.js';\nimport { sharedConfigKey } from '../../abstract/sharedConfigKey.js';\nimport { toKebabCase } from '../../utils/toKebabCase.js';\nimport { normalizeConfigValue } from './normalizeConfigValue.js';\n\nconst allConfigKeys = /** @type {(keyof import('../../types').ConfigType)[]} */ (Object.keys(initialConfig));\n\n/**\n * Config keys that can't be passed as atrtibute (because they are object or function)\n *\n * @type {(keyof import('../../types').ConfigComplexType)[]}\n */\nconst complexConfigKeys = ['metadata'];\n\n/** @type {(key: keyof import('../../types').ConfigType) => key is keyof import('../../types').ConfigComplexType} */\nconst isComplexKey = (key) => complexConfigKeys.includes(key);\n\n/** Config keys that can be passed as atrtibute */\nconst plainConfigKeys = /** @type {(keyof import('../../types').ConfigPlainType)[]} */ (\n  allConfigKeys.filter((key) => !isComplexKey(key))\n);\n\n/**\n * Mapping of attribute names to config keys Kebab-case and lowercase are supported. lowercase could be used by\n * frameworks like vue and react.\n */\nconst attrKeyMapping =\n  /** @type {Record<keyof import('../../types').ConfigAttributesType, keyof import('../../types').ConfigPlainType>} */ ({\n    ...Object.fromEntries(plainConfigKeys.map((key) => [toKebabCase(key), key])),\n    ...Object.fromEntries(plainConfigKeys.map((key) => [key.toLowerCase(), key])),\n  });\n\n/** Mapping of attribute names to state */\nconst attrStateMapping = /** @type {Record<keyof import('../../types').ConfigAttributesType, string>} */ ({\n  ...Object.fromEntries(allConfigKeys.map((key) => [toKebabCase(key), sharedConfigKey(key)])),\n  ...Object.fromEntries(allConfigKeys.map((key) => [key.toLowerCase(), sharedConfigKey(key)])),\n});\n\nexport class Config extends Block {\n  ctxOwner = true;\n\n  /** @type {Block['init$'] & import('../../types').ConfigType} */\n  init$ = {\n    ...this.init$,\n    ...Object.fromEntries(\n      Object.entries(initialConfig).map(([key, value]) => [\n        sharedConfigKey(/** @type {keyof import('../../types').ConfigType} */ (key)),\n        value,\n      ])\n    ),\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    for (const key of allConfigKeys) {\n      const anyThis = /** @type {typeof this & any} */ (this);\n      let localPropName = '__' + key;\n      anyThis[localPropName] = anyThis[key];\n\n      Object.defineProperty(this, key, {\n        /** @param {unknown} value */\n        set: (value) => {\n          anyThis[localPropName] = value;\n          if (plainConfigKeys.includes(key)) {\n            const attrs = [...new Set([toKebabCase(key), key.toLowerCase()])];\n            for (const attr of attrs) {\n              if (typeof value === 'undefined' || value === null) {\n                this.removeAttribute(attr);\n              } else {\n                this.setAttribute(attr, value.toString());\n              }\n            }\n          }\n          if (this.$[sharedConfigKey(key)] !== value) {\n            if (typeof value === 'undefined' || value === null) {\n              this.$[sharedConfigKey(key)] = initialConfig[key];\n            } else {\n              this.$[sharedConfigKey(key)] = value;\n            }\n          }\n        },\n        get: () => {\n          return this.$[sharedConfigKey(key)];\n        },\n      });\n\n      if (typeof anyThis[key] !== 'undefined' && anyThis[key] !== null) {\n        anyThis[key] = anyThis[localPropName];\n      }\n    }\n  }\n\n  /**\n   * @param {keyof typeof attrStateMapping} name\n   * @param {string} oldVal\n   * @param {string} newVal\n   */\n  attributeChangedCallback(name, oldVal, newVal) {\n    if (oldVal === newVal) return;\n\n    const key = attrKeyMapping[name];\n    const normalizedVal = normalizeConfigValue(key, newVal);\n    const val = normalizedVal ?? initialConfig[key];\n\n    const anyThis = /** @type {typeof this & any} */ (this);\n    anyThis[key] = val;\n  }\n}\n\nConfig.bindAttributes(attrStateMapping);\n","import { Block } from '../../abstract/Block.js';\n\nexport class Icon extends Block {\n  init$ = {\n    ...this.init$,\n    name: '',\n    path: '',\n    size: '24',\n    viewBox: '',\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.sub('name', (val) => {\n      if (!val) {\n        return;\n      }\n      let path = this.getCssData(`--icon-${val}`);\n      if (path) {\n        this.$.path = path;\n      }\n    });\n\n    this.sub('path', (path) => {\n      if (!path) {\n        return;\n      }\n      let isRaw = path.trimStart().startsWith('<');\n      if (isRaw) {\n        this.setAttribute('raw', '');\n        this.ref.svg.innerHTML = path;\n      } else {\n        this.removeAttribute('raw');\n        this.ref.svg.innerHTML = `<path fill-rule=\"evenodd\" d=\"${path}\"></path>`;\n      }\n    });\n\n    this.sub('size', (size) => {\n      this.$.viewBox = `0 0 ${size} ${size}`;\n    });\n  }\n}\n\nIcon.template = /* HTML */ `\n  <svg ref=\"svg\" xmlns=\"http://www.w3.org/2000/svg\" set=\"@viewBox: viewBox; @height: size; @width: size\"></svg>\n`;\n\nIcon.bindAttributes({\n  name: 'name',\n  size: 'size',\n});\n","/**\n * Trim leading `-/`, `/` and trailing `/` from CDN operation\n *\n * @param {String | unknown} [operation]\n * @returns {String}\n */\nexport const normalizeCdnOperation = (operation) => {\n  if (typeof operation !== 'string' || !operation) {\n    return '';\n  }\n  let str = operation.trim();\n  if (str.startsWith('-/')) {\n    str = str.slice(2);\n  } else if (str.startsWith('/')) {\n    str = str.slice(1);\n  }\n\n  if (str.endsWith('/')) {\n    str = str.slice(0, str.length - 1);\n  }\n  return str;\n};\n\n/**\n * Join multiple CDN operations into one string without trailing or leading delimeters\n *\n * @param {...(String | unknown)} [operations]\n * @returns {String}\n */\nexport const joinCdnOperations = (...operations) => {\n  return operations\n    .filter((op) => typeof op === 'string' && op)\n    .map((op) => normalizeCdnOperation(/** @type {String} */ (op)))\n    .join('/-/');\n};\n\n/**\n * Create string with leading `-/` from passed CDN operations. Do the same as `joinCdnOperations` but adds leading `-/`\n * and trailing `/`\n *\n * @param {...(String | unknown)} [cdnOperations] -\n * @returns {String}\n */\nexport const createCdnUrlModifiers = (...cdnOperations) => {\n  let joined = joinCdnOperations(...cdnOperations);\n  return joined ? `-/${joined}/` : '';\n};\n\n/**\n * Extract filename or file URL\n *\n * @param {String} cdnUrl\n * @returns {String}\n */\nexport function extractFilename(cdnUrl) {\n  let url = new URL(cdnUrl);\n  let noOrigin = url.pathname + url.search + url.hash;\n  let urlFilenameIdx = noOrigin.lastIndexOf('http');\n  let plainFilenameIdx = noOrigin.lastIndexOf('/');\n  let filename = '';\n\n  if (urlFilenameIdx >= 0) {\n    filename = noOrigin.slice(urlFilenameIdx);\n  } else if (plainFilenameIdx >= 0) {\n    filename = noOrigin.slice(plainFilenameIdx + 1);\n  }\n\n  return filename;\n}\n\n/**\n * Extract UUID from CDN URL\n *\n * @param {string} cdnUrl\n * @returns {string}\n */\nexport function extractUuid(cdnUrl) {\n  let url = new URL(cdnUrl);\n  let { pathname } = url;\n  const slashIndex = pathname.indexOf('/');\n  const secondSlashIndex = pathname.indexOf('/', slashIndex + 1);\n  return pathname.substring(slashIndex + 1, secondSlashIndex);\n}\n\n/**\n * Extract UUID from CDN URL\n *\n * @param {string} cdnUrl\n * @returns {string[]}\n */\nexport function extractOperations(cdnUrl) {\n  let withoutFilename = trimFilename(cdnUrl);\n  let url = new URL(withoutFilename);\n  let operationsMarker = url.pathname.indexOf('/-/');\n  if (operationsMarker === -1) {\n    return [];\n  }\n  let operationsStr = url.pathname.substring(operationsMarker);\n\n  return operationsStr\n    .split('/-/')\n    .filter(Boolean)\n    .map((operation) => normalizeCdnOperation(operation));\n}\n\n/**\n * Trim filename or file URL\n *\n * @param {String} cdnUrl\n * @returns {String}\n */\nexport function trimFilename(cdnUrl) {\n  let url = new URL(cdnUrl);\n  let filename = extractFilename(cdnUrl);\n  let filenamePathPart = isFileUrl(filename) ? splitFileUrl(filename).pathname : filename;\n\n  url.pathname = url.pathname.replace(filenamePathPart, '');\n  url.search = '';\n  url.hash = '';\n  return url.toString();\n}\n\n/**\n * Detect if filename is actually file URL\n *\n * @param {String} filename\n * @returns {Boolean}\n */\nexport function isFileUrl(filename) {\n  return filename.startsWith('http');\n}\n\n/**\n * Split file URL into the path and search parts\n *\n * @param {String} fileUrl\n * @returns {{ pathname: String; search: String; hash: String }}\n */\nexport function splitFileUrl(fileUrl) {\n  let url = new URL(fileUrl);\n  return {\n    pathname: url.origin + url.pathname || '',\n    search: url.search || '',\n    hash: url.hash || '',\n  };\n}\n\n/**\n * Create a final CDN URL with CDN modifiers and filename\n *\n * @param {String} baseCdnUrl - Base URL to CDN or Proxy, CDN modifiers and filename accepted\n * @param {String} [cdnModifiers] - CDN modifiers to apply, will be appended to `baseCdnUrl` ones\n * @param {String} [filename] - Filename for CDN or file URL for Proxy, will override one from `baseCdnUrl`\n * @returns {String}\n */\nexport const createCdnUrl = (baseCdnUrl, cdnModifiers, filename) => {\n  let url = new URL(trimFilename(baseCdnUrl));\n  filename = filename || extractFilename(baseCdnUrl);\n  // TODO: fix double slash pathname bug (--cfg-cdn-cname: 'https://ucarecdn.com/' - trailing slash case)\n  if (url.pathname.startsWith('//')) {\n    url.pathname = url.pathname.replace('//', '/');\n  }\n  if (isFileUrl(filename)) {\n    let splitted = splitFileUrl(filename);\n    url.pathname = url.pathname + (cdnModifiers || '') + (splitted.pathname || '');\n    url.search = splitted.search;\n    url.hash = splitted.hash;\n  } else {\n    url.pathname = url.pathname + (cdnModifiers || '') + (filename || '');\n  }\n  return url.toString();\n};\n\n/**\n * Create URL for an original file on CDN\n *\n * @param {String} cdnUrl - URL to get base domain from, any pathname will be stripped\n * @param {String} uuid\n * @returns {String}\n */\nexport const createOriginalUrl = (cdnUrl, uuid) => {\n  let url = new URL(cdnUrl);\n  url.pathname = uuid + '/';\n  return url.toString();\n};\n","const DEFAULT_CDN_BASE = 'https://ucarecdn.com';\n\nexport const PROPS_MAP = Object.freeze({\n  'dev-mode': {},\n  pubkey: {},\n  uuid: {},\n  src: {},\n  // alt: {},\n  // 'placeholder-src': {}, // available via CSS\n  lazy: {\n    default: 1,\n  },\n  intersection: {},\n  breakpoints: {\n    // '200, 300, 400'\n  },\n  'cdn-cname': {\n    default: DEFAULT_CDN_BASE,\n  },\n  'proxy-cname': {},\n  'secure-delivery-proxy': {},\n  'hi-res-support': {\n    default: 1,\n  },\n  'ultra-res-support': {}, // ?\n  format: {\n    default: 'auto',\n  },\n  'cdn-operations': {},\n  progressive: {},\n  quality: {\n    default: 'smart',\n  },\n  'is-background-for': {},\n});\n","import { BaseComponent } from '@symbiotejs/symbiote';\nimport { applyTemplateData } from '../../utils/template-utils.js';\nimport { createCdnUrl, createCdnUrlModifiers, createOriginalUrl } from '../../utils/cdn-utils.js';\nimport { PROPS_MAP } from './props-map.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\nimport { uniqueArray } from '../../utils/uniqueArray.js';\n\nconst CSS_PREF = '--lr-img-';\nconst UNRESOLVED_ATTR = 'unresolved';\nconst HI_RES_K = 2;\nconst ULTRA_RES_K = 3;\nconst DEV_MODE =\n  !window.location.host.trim() || window.location.host.includes(':') || window.location.hostname.includes('localhost');\n\nconst CSS_PROPS = Object.create(null);\nfor (let prop in PROPS_MAP) {\n  CSS_PROPS[CSS_PREF + prop] = PROPS_MAP[prop]?.default || '';\n}\n\nexport class ImgBase extends BaseComponent {\n  cssInit$ = CSS_PROPS;\n\n  /**\n   * @param {String} key\n   * @returns {any}\n   */\n  $$(key) {\n    return this.$[CSS_PREF + key];\n  }\n\n  /** @param {Object<String, String | Number>} kvObj */\n  set$$(kvObj) {\n    for (let key in kvObj) {\n      this.$[CSS_PREF + key] = kvObj[key];\n    }\n  }\n\n  /**\n   * @param {String} key\n   * @param {(val: any) => void} kbFn\n   */\n  sub$$(key, kbFn) {\n    this.sub(CSS_PREF + key, (val) => {\n      // null comes from CSS context property\n      // empty string comes from attribute value\n      if (val === null || val === '') {\n        return;\n      }\n      kbFn(val);\n    });\n  }\n\n  /**\n   * @private\n   * @param {String} src\n   */\n  _fmtAbs(src) {\n    let isRel = !src.includes('//');\n    if (isRel && !DEV_MODE) {\n      src = new URL(src, document.baseURI).href;\n    }\n    return src;\n  }\n\n  /**\n   * Image operations\n   *\n   * @param {String} [size]\n   */\n  _getCdnModifiers(size = '') {\n    return createCdnUrlModifiers(\n      //\n      size && `resize/${size}`,\n      this.$$('cdn-operations') || '',\n      `format/${this.$$('format') || PROPS_MAP.format.default}`,\n      `quality/${this.$$('quality') || PROPS_MAP.quality.default}`\n    );\n  }\n\n  /**\n   * @private\n   * @param {String} size\n   * @returns {any}\n   */\n  _getUrlBase(size = '') {\n    if (this.$$('src').startsWith('data:') || this.$$('src').startsWith('blob:')) {\n      return this.$$('src');\n    }\n\n    // Localhost + relative image path (DO NOTHING):\n    if (DEV_MODE && this.$$('src') && !this.$$('src').includes('//')) {\n      return this._proxyUrl(this.$$('src'));\n    }\n\n    let cdnModifiers = this._getCdnModifiers(size);\n\n    if (this.$$('src').startsWith(this.$$('cdn-cname'))) {\n      return createCdnUrl(this.$$('src'), cdnModifiers);\n    }\n\n    // Alternative CDN name:\n    if (this.$$('cdn-cname') && this.$$('uuid')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          createOriginalUrl(this.$$('cdn-cname'), this.$$('uuid')),\n          cdnModifiers\n        )\n      );\n    }\n\n    // UUID only:\n    if (this.$$('uuid')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          createOriginalUrl(this.$$('cdn-cname'), this.$$('uuid')),\n          cdnModifiers\n        )\n      );\n    }\n\n    // Alternative proxy name:\n    if (this.$$('proxy-cname')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          this.$$('proxy-cname'),\n          cdnModifiers,\n          this._fmtAbs(this.$$('src'))\n        )\n      );\n    }\n\n    // Project pubkey only:\n    if (this.$$('pubkey')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          `https://${this.$$('pubkey')}.ucr.io/`,\n          cdnModifiers,\n          this._fmtAbs(this.$$('src'))\n        )\n      );\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} url\n   * @returns {String}\n   */\n  _proxyUrl(url) {\n    let previewProxy = this.$$('secure-delivery-proxy');\n    if (!previewProxy) {\n      return url;\n    }\n    return applyTemplateData(\n      this.$$('secure-delivery-proxy'),\n      { previewUrl: url },\n      { transform: (value) => window.encodeURIComponent(value) }\n    );\n  }\n\n  /**\n   * @param {HTMLElement} el\n   * @param {Number} [k]\n   * @param {Boolean} [wOnly]\n   */\n  _getElSize(el, k = 1, wOnly = true) {\n    let rect = el.getBoundingClientRect();\n    let w = k * Math.round(rect.width);\n    let h = wOnly ? '' : k * Math.round(rect.height);\n    if (w || h) {\n      return `${w ? w : ''}x${h ? h : ''}`;\n    } else {\n      return null;\n    }\n  }\n\n  /** @param {HTMLImageElement} img */\n  _setupEventProxy(img) {\n    /** @param {Event} e */\n    let proxifyEvent = (e) => {\n      e.stopPropagation();\n      let event = new Event(e.type, e);\n      this.dispatchEvent(event);\n    };\n    let EVENTS = ['load', 'error'];\n    for (let event of EVENTS) {\n      img.addEventListener(event, proxifyEvent);\n    }\n  }\n\n  /** @type {HTMLImageElement} */\n  get img() {\n    if (!this._img) {\n      /** @private */\n      this._img = new Image();\n      this._setupEventProxy(this.img);\n      this._img.setAttribute(UNRESOLVED_ATTR, '');\n      this.img.onload = () => {\n        this.img.removeAttribute(UNRESOLVED_ATTR);\n      };\n      this.initAttributes();\n      this.appendChild(this._img);\n    }\n    return this._img;\n  }\n\n  get bgSelector() {\n    return this.$$('is-background-for');\n  }\n\n  initAttributes() {\n    [...this.attributes].forEach((attr) => {\n      if (!PROPS_MAP[attr.name]) {\n        this.img.setAttribute(attr.name, attr.value);\n      }\n    });\n  }\n\n  get breakpoints() {\n    if (this.$$('breakpoints')) {\n      return uniqueArray(stringToArray(this.$$('breakpoints')).map((str) => Number(str)));\n    } else {\n      return null;\n    }\n  }\n\n  /** @param {HTMLElement} el */\n  renderBg(el) {\n    let imgSet = new Set();\n    if (this.breakpoints) {\n      this.breakpoints.forEach((bp) => {\n        imgSet.add(`url(\"${this._getUrlBase(bp + 'x')}\") ${bp}w`);\n        if (this.$$('hi-res-support')) {\n          imgSet.add(`url(\"${this._getUrlBase(bp * HI_RES_K + 'x')}\") ${bp * HI_RES_K}w`);\n        }\n        if (this.$$('ultra-res-support')) {\n          imgSet.add(`url(\"${this._getUrlBase(bp * ULTRA_RES_K + 'x')}\") ${bp * ULTRA_RES_K}w`);\n        }\n      });\n    } else {\n      imgSet.add(`url(\"${this._getUrlBase(this._getElSize(el))}\") 1x`);\n      if (this.$$('hi-res-support')) {\n        imgSet.add(`url(\"${this._getUrlBase(this._getElSize(el, HI_RES_K))}\") ${HI_RES_K}x`);\n      }\n      if (this.$$('ultra-res-support')) {\n        imgSet.add(`url(\"${this._getUrlBase(this._getElSize(el, ULTRA_RES_K))}\") ${ULTRA_RES_K}x`);\n      }\n    }\n    let iSet = `image-set(${[...imgSet].join(', ')})`;\n    el.style.setProperty('background-image', iSet);\n    el.style.setProperty('background-image', '-webkit-' + iSet);\n  }\n\n  getSrcset() {\n    let srcset = new Set();\n    if (this.breakpoints) {\n      this.breakpoints.forEach((bp) => {\n        srcset.add(this._getUrlBase(bp + 'x') + ` ${bp}w`);\n        if (this.$$('hi-res-support')) {\n          srcset.add(this._getUrlBase(bp * HI_RES_K + 'x') + ` ${bp * HI_RES_K}w`);\n        }\n        if (this.$$('ultra-res-support')) {\n          srcset.add(this._getUrlBase(bp * ULTRA_RES_K + 'x') + ` ${bp * ULTRA_RES_K}w`);\n        }\n      });\n    } else {\n      srcset.add(this._getUrlBase(this._getElSize(this.img)) + ' 1x');\n      if (this.$$('hi-res-support')) {\n        srcset.add(this._getUrlBase(this._getElSize(this.img, 2)) + ' 2x');\n      }\n      if (this.$$('ultra-res-support')) {\n        srcset.add(this._getUrlBase(this._getElSize(this.img, 3)) + ' 3x');\n      }\n    }\n    return [...srcset].join();\n  }\n\n  getSrc() {\n    return this._getUrlBase();\n  }\n\n  init() {\n    if (this.bgSelector) {\n      [...document.querySelectorAll(this.bgSelector)].forEach((el) => {\n        if (this.$$('intersection')) {\n          this.initIntersection(el, () => {\n            this.renderBg(el);\n          });\n        } else {\n          this.renderBg(el);\n        }\n      });\n    } else if (this.$$('intersection')) {\n      this.initIntersection(this.img, () => {\n        this.img.srcset = this.getSrcset();\n        this.img.src = this.getSrc();\n      });\n    } else {\n      this.img.srcset = this.getSrcset();\n      this.img.src = this.getSrc();\n    }\n  }\n\n  /**\n   * @param {HTMLElement} el\n   * @param {() => void} cbkFn\n   */\n  initIntersection(el, cbkFn) {\n    let opts = {\n      root: null,\n      rootMargin: '0px',\n    };\n    /** @private */\n    this._isnObserver = new IntersectionObserver((entries) => {\n      entries.forEach((ent) => {\n        if (ent.isIntersecting) {\n          cbkFn();\n          this._isnObserver.unobserve(el);\n        }\n      });\n    }, opts);\n    this._isnObserver.observe(el);\n    if (!this._observed) {\n      /** @private */\n      this._observed = new Set();\n    }\n    this._observed.add(el);\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    if (this._isnObserver) {\n      this._observed.forEach((el) => {\n        this._isnObserver.unobserve(el);\n      });\n      this._isnObserver = null;\n    }\n  }\n\n  static get observedAttributes() {\n    return Object.keys(PROPS_MAP);\n  }\n\n  attributeChangedCallback(name, oldVal, newVal) {\n    window.setTimeout(() => {\n      this.$[CSS_PREF + name] = newVal;\n    });\n  }\n}\n","/**\n * @template T\n * @param {T[]} arr\n * @returns {T[]}\n */\nexport const uniqueArray = (arr) => {\n  return [...new Set(arr)];\n};\n","// @ts-check\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\n\nexport class SimpleBtn extends UploaderBlock {\n  // @ts-ignore TODO: fix this\n  init$ = {\n    ...this.init$,\n    '*simpleButtonText': '',\n    onClick: () => {\n      this.initFlow();\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.subConfigValue('multiple', (val) => {\n      this.$['*simpleButtonText'] = val ? this.l10n('upload-files') : this.l10n('upload-file');\n    });\n  }\n}\n\nSimpleBtn.template = /* HTML */ `\n  <lr-drop-area>\n    <button type=\"button\" set=\"onclick: onClick\">\n      <lr-icon name=\"upload\"></lr-icon>\n      <span>{{*simpleButtonText}}</span>\n      <slot></slot>\n      <div class=\"visual-drop-area\"></div>\n    </button>\n  </lr-drop-area>\n`;\n","/**\n * @param {File} file\n * @returns {Promise<boolean>}\n */\nfunction checkIsDirectory(file) {\n  return new Promise((resolve) => {\n    if (typeof window.FileReader !== 'function') {\n      resolve(false);\n    }\n\n    try {\n      let reader = new FileReader();\n      reader.onerror = () => {\n        resolve(true);\n      };\n      let onLoad = (e) => {\n        if (e.type !== 'loadend') {\n          reader.abort();\n        }\n        resolve(false);\n      };\n      reader.onloadend = onLoad;\n      reader.onprogress = onLoad;\n\n      reader.readAsDataURL(file);\n    } catch (err) {\n      resolve(false);\n    }\n  });\n}\n\nfunction readEntryContentAsync(webkitEntry, dataTransferItemType) {\n  return new Promise((resolve) => {\n    let reading = 0;\n    let contents = [];\n\n    let readEntry = (entry) => {\n      if (!entry) {\n        console.warn('Unexpectedly received empty content entry', { scope: 'drag-and-drop' });\n        resolve(null);\n      }\n      if (entry.isFile) {\n        reading++;\n        entry.file((file) => {\n          reading--;\n          // webkitGetAsEntry don't provide type for HEIC images at least, so we use type value from dataTransferItem\n          const clonedFile = new File([file], file.name, { type: file.type || dataTransferItemType });\n          contents.push(clonedFile);\n\n          if (reading === 0) {\n            resolve(contents);\n          }\n        });\n      } else if (entry.isDirectory) {\n        readReaderContent(entry.createReader());\n      }\n    };\n\n    let readReaderContent = (reader) => {\n      reading++;\n\n      reader.readEntries((entries) => {\n        reading--;\n        for (let entry of entries) {\n          readEntry(entry);\n        }\n\n        if (reading === 0) {\n          resolve(contents);\n        }\n      });\n    };\n\n    readEntry(webkitEntry);\n  });\n}\n\n/**\n * Note: dataTransfer will be destroyed outside of the call stack. So, do not try to process it asynchronous.\n *\n * @param {DataTransfer} dataTransfer\n * @returns {Promise<(File | String)[]>}\n */\nexport function getDropItems(dataTransfer) {\n  let files = [];\n  let promises = [];\n  for (let i = 0; i < dataTransfer.items.length; i++) {\n    let item = dataTransfer.items[i];\n    if (!item) {\n      continue;\n    }\n    if (item.kind === 'file') {\n      const itemType = item.type;\n      if (typeof item.webkitGetAsEntry === 'function' || typeof (/** @type {any} */ (item).getAsEntry) === 'function') {\n        let entry =\n          typeof item.webkitGetAsEntry === 'function'\n            ? item.webkitGetAsEntry()\n            : /** @type {any} */ (item).getAsEntry();\n        promises.push(\n          readEntryContentAsync(entry, itemType).then((entryContent) => {\n            files.push(...entryContent);\n          })\n        );\n        continue;\n      }\n\n      let file = item.getAsFile();\n      promises.push(\n        checkIsDirectory(file).then((isDirectory) => {\n          if (isDirectory) {\n            // we can't get directory files, so we'll skip it\n          } else {\n            files.push(file);\n          }\n        })\n      );\n    } else if (item.kind === 'string' && item.type.match('^text/uri-list')) {\n      promises.push(\n        new Promise((resolve) => {\n          item.getAsString((value) => {\n            files.push(value);\n            resolve();\n          });\n        })\n      );\n    }\n  }\n\n  return Promise.all(promises).then(() => files);\n}\n","import { getDropItems } from './getDropItems.js';\n\n/** @enum {Number} */\nexport const DropzoneState = {\n  ACTIVE: 0,\n  INACTIVE: 1,\n  NEAR: 2,\n  OVER: 3,\n};\n\nlet RESET_EVENTS = ['focus'];\nlet NEAR_OFFSET = 100;\nlet nearnessRegistry = new Map();\n\n/**\n * @param {[x: number, y: number]} p\n * @param {{ x: number; y: number; width: number; height: number }} r\n * @returns {number}\n */\nfunction distance(p, r) {\n  let cx = Math.max(Math.min(p[0], r.x + r.width), r.x);\n  let cy = Math.max(Math.min(p[1], r.y + r.height), r.y);\n\n  return Math.sqrt((p[0] - cx) * (p[0] - cx) + (p[1] - cy) * (p[1] - cy));\n}\n\n/**\n * @param {Object} desc\n * @param {HTMLElement} desc.element\n * @param {Function} desc.onChange\n * @param {Function} desc.onItems\n * @param {() => Boolean} desc.shouldIgnore\n */\nexport function addDropzone(desc) {\n  let eventCounter = 0;\n\n  let body = document.body;\n  let switchHandlers = new Set();\n  let handleSwitch = (fn) => switchHandlers.add(fn);\n  let state = DropzoneState.INACTIVE;\n\n  let setState = (newState) => {\n    if (desc.shouldIgnore() && newState !== DropzoneState.INACTIVE) {\n      return;\n    }\n    if (state !== newState) {\n      switchHandlers.forEach((fn) => fn(newState));\n    }\n    state = newState;\n  };\n\n  let isDragging = () => eventCounter > 0;\n\n  handleSwitch((newState) => desc.onChange(newState));\n\n  let onResetEvent = () => {\n    eventCounter = 0;\n    setState(DropzoneState.INACTIVE);\n  };\n  let onDragEnter = () => {\n    eventCounter += 1;\n    if (state === DropzoneState.INACTIVE) {\n      setState(DropzoneState.ACTIVE);\n    }\n  };\n  let onDragLeave = () => {\n    eventCounter -= 1;\n    if (!isDragging()) {\n      setState(DropzoneState.INACTIVE);\n    }\n  };\n  let onDrop = (e) => {\n    e.preventDefault();\n    eventCounter = 0;\n    setState(DropzoneState.INACTIVE);\n  };\n\n  let onDragOver = (e) => {\n    if (!isDragging()) {\n      eventCounter += 1;\n    }\n    e.preventDefault();\n\n    /** @type {[Number, Number]} */\n    let dragPoint = [e.x, e.y];\n    let targetRect = desc.element.getBoundingClientRect();\n    let nearness = Math.floor(distance(dragPoint, targetRect));\n    let isNear = nearness < NEAR_OFFSET;\n    let isOver = e.composedPath().includes(desc.element);\n\n    nearnessRegistry.set(desc.element, nearness);\n    let isNearest = Math.min(...nearnessRegistry.values()) === nearness;\n\n    if (isOver && isNearest) {\n      setState(DropzoneState.OVER);\n    } else if (isNear && isNearest) {\n      setState(DropzoneState.NEAR);\n    } else {\n      setState(DropzoneState.ACTIVE);\n    }\n  };\n\n  let onElementDrop = async (e) => {\n    if (desc.shouldIgnore()) {\n      return;\n    }\n    e.preventDefault();\n    let items = await getDropItems(e.dataTransfer);\n    desc.onItems(items);\n    setState(DropzoneState.INACTIVE);\n  };\n\n  body.addEventListener('drop', onDrop);\n  body.addEventListener('dragleave', onDragLeave);\n  body.addEventListener('dragenter', onDragEnter);\n  body.addEventListener('dragover', onDragOver);\n  desc.element.addEventListener('drop', onElementDrop);\n  RESET_EVENTS.forEach((eventName) => {\n    window.addEventListener(eventName, onResetEvent);\n  });\n\n  return () => {\n    nearnessRegistry.delete(desc.element);\n    body.removeEventListener('drop', onDrop);\n    body.removeEventListener('dragleave', onDragLeave);\n    body.removeEventListener('dragenter', onDragEnter);\n    body.removeEventListener('dragover', onDragOver);\n    desc.element.removeEventListener('drop', onElementDrop);\n    RESET_EVENTS.forEach((eventName) => {\n      window.removeEventListener(eventName, onResetEvent);\n    });\n  };\n}\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { DropzoneState, addDropzone } from './addDropzone.js';\nimport { Modal } from '../Modal/Modal.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\nimport { UploadSource } from '../utils/UploadSource.js';\n\nexport class DropArea extends UploaderBlock {\n  init$ = {\n    ...this.init$,\n    state: DropzoneState.INACTIVE,\n    withIcon: false,\n    isClickable: false,\n    isFullscreen: false,\n    isEnabled: true,\n    isVisible: true,\n    text: this.l10n('drop-files-here'),\n    'lr-drop-area/targets': null,\n  };\n\n  isActive() {\n    if (!this.$.isEnabled) {\n      return false;\n    }\n    const bounds = this.getBoundingClientRect();\n    const hasSize = bounds.width > 0 && bounds.height > 0;\n    const isInViewport =\n      bounds.top >= 0 &&\n      bounds.left >= 0 &&\n      bounds.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n      bounds.right <= (window.innerWidth || document.documentElement.clientWidth);\n\n    const style = window.getComputedStyle(this);\n    const visible = style.visibility !== 'hidden' && style.display !== 'none';\n\n    return hasSize && visible && isInViewport;\n  }\n  initCallback() {\n    super.initCallback();\n\n    if (!this.$['lr-drop-area/targets']) {\n      this.$['lr-drop-area/targets'] = new Set();\n    }\n    this.$['lr-drop-area/targets'].add(this);\n\n    this.defineAccessor('disabled', (value) => {\n      this.set$({ isEnabled: !value });\n    });\n    this.defineAccessor('clickable', (value) => {\n      this.set$({ isClickable: typeof value === 'string' });\n    });\n    this.defineAccessor('with-icon', (value) => {\n      this.set$({ withIcon: typeof value === 'string' });\n    });\n    this.defineAccessor('fullscreen', (value) => {\n      this.set$({ isFullscreen: typeof value === 'string' });\n    });\n\n    this.defineAccessor('text', (value) => {\n      if (value) {\n        this.set$({ text: this.l10n(value) || value });\n      } else {\n        this.set$({ text: this.l10n('drop-files-here') });\n      }\n    });\n\n    /** @private */\n    this._destroyDropzone = addDropzone({\n      element: this,\n      shouldIgnore: () => this._shouldIgnore(),\n      onChange: (state) => {\n        this.$.state = state;\n      },\n      /** @param {(File | String)[]} items */\n      onItems: (items) => {\n        if (!items.length) {\n          return;\n        }\n\n        items.forEach((/** @type {File | String} */ item) => {\n          if (typeof item === 'string') {\n            this.addFileFromUrl(item, { source: UploadSource.DROP_AREA });\n            return;\n          }\n          this.addFileFromObject(item, { source: UploadSource.DROP_AREA });\n        });\n        if (this.uploadCollection.size) {\n          this.set$({\n            '*currentActivity': ActivityBlock.activities.UPLOAD_LIST,\n          });\n          this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n        }\n      },\n    });\n\n    let contentWrapperEl = this.ref['content-wrapper'];\n    if (contentWrapperEl) {\n      this._destroyContentWrapperDropzone = addDropzone({\n        element: contentWrapperEl,\n        onChange: (state) => {\n          const stateText = Object.entries(DropzoneState)\n            .find(([, value]) => value === state)?.[0]\n            .toLowerCase();\n          stateText && contentWrapperEl.setAttribute('drag-state', stateText);\n        },\n        onItems: () => {},\n        shouldIgnore: () => this._shouldIgnore(),\n      });\n    }\n\n    this.sub('state', (state) => {\n      const stateText = Object.entries(DropzoneState)\n        .find(([, value]) => value === state)?.[0]\n        .toLowerCase();\n      if (stateText) {\n        this.setAttribute('drag-state', stateText);\n      }\n    });\n\n    this.subConfigValue('sourceList', (value) => {\n      const list = stringToArray(value);\n      // Enable drop area if local files are allowed\n      this.$.isEnabled = list.includes(UploaderBlock.sourceTypes.LOCAL);\n      // Show drop area if it's enabled or default slot is overrided\n      this.$.isVisible = this.$.isEnabled || !this.querySelector('[data-default-slot]');\n    });\n\n    this.sub('isVisible', (value) => {\n      this.toggleAttribute('hidden', !value);\n    });\n\n    if (this.$.isClickable) {\n      // @private\n      this._onAreaClicked = () => {\n        this.openSystemDialog();\n      };\n      this.addEventListener('click', this._onAreaClicked);\n    }\n  }\n\n  /**\n   * Ignore drop events if there are other visible drop areas on the page\n   *\n   * @private\n   * @returns {Boolean}\n   */\n  _shouldIgnore() {\n    if (!this.$.isEnabled) {\n      return true;\n    }\n    if (!this._couldHandleFiles()) {\n      return true;\n    }\n    if (!this.$.isFullscreen) {\n      return false;\n    }\n    const otherTargets = [...this.$['lr-drop-area/targets']].filter((el) => el !== this);\n    const activeTargets = otherTargets.filter((/** @type {typeof this} */ el) => {\n      return el.isActive();\n    });\n    return activeTargets.length > 0;\n  }\n\n  /** @private */\n  _couldHandleFiles() {\n    let isMultiple = this.cfg.multiple;\n    let multipleMax = this.cfg.multipleMax;\n    let currentFilesCount = this.uploadCollection.size;\n\n    if (isMultiple && multipleMax && currentFilesCount >= multipleMax) {\n      return false;\n    }\n\n    if (!isMultiple && currentFilesCount > 0) {\n      return false;\n    }\n\n    return true;\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    this.$['lr-drop-area/targets']?.remove?.(this);\n\n    this._destroyDropzone?.();\n    this._destroyContentWrapperDropzone?.();\n    if (this._onAreaClicked) {\n      this.removeEventListener('click', this._onAreaClicked);\n    }\n  }\n}\n\nDropArea.template = /* HTML */ `\n  <slot>\n    <div data-default-slot hidden></div>\n    <div ref=\"content-wrapper\" class=\"content-wrapper\" set=\"@hidden: !isVisible\">\n      <div class=\"icon-container\" set=\"@hidden: !withIcon\">\n        <lr-icon name=\"default\"></lr-icon>\n        <lr-icon name=\"arrow-down\"></lr-icon>\n      </div>\n      <span class=\"text\">{{text}}</span>\n    </div>\n  </slot>\n`;\n\nDropArea.bindAttributes({\n  'with-icon': null,\n  clickable: null,\n  text: null,\n  fullscreen: null,\n  disabled: null,\n});\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nconst L10N_PREFIX = 'src-type-';\n\nexport class SourceBtn extends UploaderBlock {\n  /** @private */\n  _registeredTypes = {};\n\n  init$ = {\n    ...this.init$,\n    iconName: 'default',\n  };\n\n  initTypes() {\n    this.registerType({\n      type: UploaderBlock.sourceTypes.LOCAL,\n      onClick: () => {\n        this.openSystemDialog();\n      },\n    });\n    this.registerType({\n      type: UploaderBlock.sourceTypes.URL,\n      activity: ActivityBlock.activities.URL,\n      textKey: 'from-url',\n    });\n    this.registerType({\n      type: UploaderBlock.sourceTypes.CAMERA,\n      activity: ActivityBlock.activities.CAMERA,\n      onClick: () => {\n        let el = document.createElement('input');\n        var supportsCapture = el.capture !== undefined;\n        if (supportsCapture) {\n          this.openSystemDialog({ captureCamera: true });\n        }\n        return !supportsCapture;\n      },\n    });\n    this.registerType({\n      type: 'draw',\n      activity: ActivityBlock.activities.DRAW,\n      icon: 'edit-draw',\n    });\n\n    for (let externalSourceType of Object.values(UploaderBlock.extSrcList)) {\n      this.registerType({\n        type: externalSourceType,\n        activity: ActivityBlock.activities.EXTERNAL,\n        activityParams: {\n          externalSourceType: externalSourceType,\n        },\n      });\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.initTypes();\n\n    this.setAttribute('role', 'button');\n    this.defineAccessor('type', (val) => {\n      if (!val) {\n        return;\n      }\n      this.applyType(val);\n    });\n  }\n\n  registerType(typeConfig) {\n    this._registeredTypes[typeConfig.type] = typeConfig;\n  }\n\n  getType(type) {\n    return this._registeredTypes[type];\n  }\n\n  applyType(type) {\n    const configType = this._registeredTypes[type];\n    if (!configType) {\n      console.warn('Unsupported source type: ' + type);\n      return;\n    }\n    const { textKey = type, icon = type, activity, onClick, activityParams = {} } = configType;\n\n    this.applyL10nKey('src-type', `${L10N_PREFIX}${textKey}`);\n    this.$.iconName = icon;\n    this.onclick = (e) => {\n      const showActivity = onClick ? onClick(e) : !!activity;\n      showActivity &&\n        this.set$({\n          '*currentActivityParams': activityParams,\n          '*currentActivity': activity,\n        });\n    };\n  }\n}\nSourceBtn.template = /* HTML */ `\n  <lr-icon set=\"@name: iconName\"></lr-icon>\n  <div class=\"txt\" l10n=\"src-type\"></div>\n`;\nSourceBtn.bindAttributes({\n  type: null,\n});\n","/**\n * @param {String} svg\n * @returns {String}\n */\nfunction createSvgBlobUrl(svg) {\n  let blob = new Blob([svg], {\n    type: 'image/svg+xml',\n  });\n  return URL.createObjectURL(blob);\n}\n\n/**\n * @param {String} [color1]\n * @param {String} [color2]\n * @returns {String}\n */\nexport function checkerboardCssBg(color1 = '#fff', color2 = 'rgba(0, 0, 0, .1)') {\n  return createSvgBlobUrl(/*svg*/ `<svg height=\"20\" width=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n    <rect x=\"0\" y=\"0\" width=\"20\" height=\"20\" fill=\"${color1}\" />\n    <rect x=\"0\" y=\"0\" width=\"10\" height=\"10\" fill=\"${color2}\" />\n    <rect x=\"10\" y=\"10\" width=\"10\" height=\"10\" fill=\"${color2}\" />\n  </svg>`);\n}\n\n/**\n * @param {String} [color]\n * @returns {String}\n */\nexport function strokesCssBg(color = 'rgba(0, 0, 0, .1)') {\n  return createSvgBlobUrl(/*svg*/ `<svg height=\"10\" width=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n    <line x1=\"0\" y1=\"10\" x2=\"10\" y2=\"0\" stroke=\"${color}\" />\n  </svg>`);\n}\n\n/**\n * @param {String} [color]\n * @returns {String}\n */\nexport function fileCssBg(color = 'hsl(209, 21%, 65%)', width = 32, height = 32) {\n  return createSvgBlobUrl(/*svg*/ `\n  <svg width=\"${width}\" height=\"${height}\" viewBox=\"0 0 30 30\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path fill-rule=\"evenodd\" fill=\"${color}\" d=\"M9.68848 8.70068C9.68848 8.42454 9.91233 8.20068 10.1885 8.20068H15.0885C15.2211 8.20068 15.3483 8.25336 15.442 8.34713L20.342 13.2471C20.4358 13.3409 20.4885 13.4681 20.4885 13.6007V21.3007C20.4885 21.5768 20.2646 21.8007 19.9885 21.8007H10.1885C9.91233 21.8007 9.68848 21.5768 9.68848 21.3007V8.70068ZM10.6885 9.20068V20.8007H19.4885V14.1007L15.0885 14.1007C14.8123 14.1007 14.5885 13.8768 14.5885 13.6007L14.5885 9.20068H10.6885ZM15.5885 9.90779L18.7814 13.1007L15.5885 13.1007L15.5885 9.90779Z\"/>\n  </svg>\n  `);\n}\n","// @ts-check\nimport { UploadClientError, uploadFile } from '@uploadcare/upload-client';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { EVENT_TYPES, EventData, EventManager } from '../../abstract/EventManager.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { createCdnUrl, createCdnUrlModifiers, createOriginalUrl } from '../../utils/cdn-utils.js';\nimport { fileCssBg } from '../svg-backgrounds/svg-backgrounds.js';\nimport { debounce } from '../utils/debounce.js';\nimport { generateThumb } from '../utils/resizeImage.js';\n\nconst FileItemState = Object.freeze({\n  FINISHED: Symbol(0),\n  FAILED: Symbol(1),\n  UPLOADING: Symbol(2),\n  IDLE: Symbol(3),\n  LIMIT_OVERFLOW: Symbol(4),\n});\n\nexport class FileItem extends UploaderBlock {\n  pauseRender = true;\n\n  /** @private */\n  _entrySubs = new Set();\n  /**\n   * @private\n   * @type {any} TODO: Add types for upload entry\n   */\n  _entry = null;\n  /** @private */\n  _isIntersecting = false;\n  /** @private */\n  _debouncedGenerateThumb = debounce(this._generateThumbnail.bind(this), 100);\n  /** @private */\n  _debouncedCalculateState = debounce(this._calculateState.bind(this), 100); // TODO: better throttle\n\n  /** @private */\n  _renderedOnce = false;\n\n  // @ts-ignore TODO: fix this\n  init$ = {\n    ...this.init$,\n    uid: '',\n    itemName: '',\n    errorText: '',\n    thumbUrl: '',\n    progressValue: 0,\n    progressVisible: false,\n    progressUnknown: false,\n    badgeIcon: '',\n    isFinished: false,\n    isFailed: false,\n    isUploading: false,\n    isFocused: false,\n    isEditable: false,\n    isLimitOverflow: false,\n    state: FileItemState.IDLE,\n    '*uploadTrigger': null,\n\n    onEdit: () => {\n      this.set$({\n        '*focusedEntry': this._entry,\n      });\n      if (this.hasBlockInCtx((b) => b.activityType === ActivityBlock.activities.DETAILS)) {\n        this.$['*currentActivity'] = ActivityBlock.activities.DETAILS;\n      } else {\n        this.$['*currentActivity'] = ActivityBlock.activities.CLOUD_IMG_EDIT;\n      }\n    },\n    onRemove: () => {\n      let entryUuid = this._entry.getValue('uuid');\n      if (entryUuid) {\n        let data = this.getOutputData((dataItem) => {\n          return dataItem.getValue('uuid') === entryUuid;\n        });\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.REMOVE,\n            ctx: this.ctxName,\n            data,\n          })\n        );\n      }\n      this.uploadCollection.remove(this.$.uid);\n    },\n    onUpload: () => {\n      this.upload();\n    },\n  };\n\n  _reset() {\n    for (let sub of this._entrySubs) {\n      sub.remove();\n    }\n\n    this._debouncedGenerateThumb.cancel();\n    this._debouncedCalculateState.cancel();\n    this._entrySubs = new Set();\n    this._entry = null;\n  }\n\n  /**\n   * @private\n   * @param {IntersectionObserverEntry[]} entries\n   */\n  _observerCallback(entries) {\n    let [entry] = entries;\n    this._isIntersecting = entry.isIntersecting;\n\n    if (entry.isIntersecting && !this._renderedOnce) {\n      this.render();\n      this._renderedOnce = true;\n    }\n    if (entry.intersectionRatio === 0) {\n      this._debouncedGenerateThumb.cancel();\n    } else {\n      this._debouncedGenerateThumb();\n    }\n  }\n\n  /** @private */\n  _calculateState() {\n    if (!this._entry) {\n      return;\n    }\n    let entry = this._entry;\n    let state = FileItemState.IDLE;\n\n    if (entry.getValue('uploadError') || entry.getValue('validationErrorMsg')) {\n      state = FileItemState.FAILED;\n    } else if (entry.getValue('validationMultipleLimitMsg')) {\n      state = FileItemState.LIMIT_OVERFLOW;\n    } else if (entry.getValue('isUploading')) {\n      state = FileItemState.UPLOADING;\n    } else if (entry.getValue('fileInfo')) {\n      state = FileItemState.FINISHED;\n    }\n\n    this.$.state = state;\n  }\n\n  /** @private */\n  async _generateThumbnail() {\n    if (!this._entry) {\n      return;\n    }\n    let entry = this._entry;\n\n    if (entry.getValue('fileInfo') && entry.getValue('isImage')) {\n      let size = this.cfg.thumbSize;\n      let thumbUrl = this.proxyUrl(\n        createCdnUrl(\n          createOriginalUrl(this.cfg.cdnCname, this._entry.getValue('uuid')),\n          createCdnUrlModifiers(entry.getValue('cdnUrlModifiers'), `scale_crop/${size}x${size}/center`)\n        )\n      );\n      let currentThumbUrl = entry.getValue('thumbUrl');\n      if (currentThumbUrl !== thumbUrl) {\n        entry.setValue('thumbUrl', thumbUrl);\n        currentThumbUrl?.startsWith('blob:') && URL.revokeObjectURL(currentThumbUrl);\n      }\n      return;\n    }\n\n    if (entry.getValue('thumbUrl')) {\n      return;\n    }\n\n    if (entry.getValue('file')?.type.includes('image')) {\n      try {\n        let thumbUrl = await generateThumb(entry.getValue('file'), this.cfg.thumbSize);\n        entry.setValue('thumbUrl', thumbUrl);\n      } catch (err) {\n        let color = window.getComputedStyle(this).getPropertyValue('--clr-generic-file-icon');\n        entry.setValue('thumbUrl', fileCssBg(color));\n      }\n    } else {\n      let color = window.getComputedStyle(this).getPropertyValue('--clr-generic-file-icon');\n      entry.setValue('thumbUrl', fileCssBg(color));\n    }\n  }\n\n  /**\n   * @private\n   * @param {string} prop\n   * @param {(value: any) => void} handler\n   */\n  _subEntry(prop, handler) {\n    let sub = this._entry.subscribe(\n      prop,\n      /** @param {any} value */ (value) => {\n        if (this.isConnected) {\n          handler(value);\n        }\n      }\n    );\n    this._entrySubs.add(sub);\n  }\n\n  /**\n   * @private\n   * @param {String} id\n   */\n  _handleEntryId(id) {\n    this._reset();\n\n    /** @type {import('../../abstract/TypedData.js').TypedData} */\n    let entry = this.uploadCollection?.read(id);\n    this._entry = entry;\n\n    if (!entry) {\n      return;\n    }\n\n    this._subEntry('uploadProgress', (uploadProgress) => {\n      this.$.progressValue = uploadProgress;\n    });\n\n    this._subEntry('fileName', (name) => {\n      this.$.itemName = name || entry.getValue('externalUrl') || this.l10n('file-no-name');\n      this._debouncedCalculateState();\n    });\n\n    this._subEntry('externalUrl', (externalUrl) => {\n      this.$.itemName = entry.getValue('fileName') || externalUrl || this.l10n('file-no-name');\n    });\n\n    this._subEntry('uuid', (uuid) => {\n      this._debouncedCalculateState();\n      if (uuid && this._isIntersecting) {\n        this._debouncedGenerateThumb();\n      }\n    });\n\n    this._subEntry('cdnUrlModifiers', () => {\n      if (this._isIntersecting) {\n        this._debouncedGenerateThumb();\n      }\n    });\n\n    this._subEntry('thumbUrl', (thumbUrl) => {\n      this.$.thumbUrl = thumbUrl ? `url(${thumbUrl})` : '';\n    });\n\n    this._subEntry('validationMultipleLimitMsg', () => this._debouncedCalculateState());\n    this._subEntry('validationErrorMsg', () => this._debouncedCalculateState());\n    this._subEntry('uploadError', () => this._debouncedCalculateState());\n    this._subEntry('isUploading', () => this._debouncedCalculateState());\n    this._subEntry('fileSize', () => this._debouncedCalculateState());\n    this._subEntry('mimeType', () => this._debouncedCalculateState());\n    this._subEntry('isImage', () => this._debouncedCalculateState());\n\n    if (this._isIntersecting) {\n      this._debouncedGenerateThumb();\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('uid', (uid) => {\n      this._handleEntryId(uid);\n    });\n\n    this.sub('state', (state) => {\n      this._handleState(state);\n    });\n\n    this.subConfigValue('useCloudImageEditor', () => this._debouncedCalculateState());\n\n    this.onclick = () => {\n      FileItem.activeInstances.forEach((inst) => {\n        if (inst === this) {\n          inst.setAttribute('focused', '');\n        } else {\n          inst.removeAttribute('focused');\n        }\n      });\n    };\n\n    this.$['*uploadTrigger'] = null;\n\n    this.sub('*uploadTrigger', (val) => {\n      if (!val) {\n        return;\n      }\n      setTimeout(() => this.isConnected && this.upload());\n    });\n    FileItem.activeInstances.add(this);\n  }\n\n  /** @param {(typeof FileItemState)[keyof typeof FileItemState]} state */\n  _handleState(state) {\n    this.set$({\n      isFailed: state === FileItemState.FAILED,\n      isLimitOverflow: state === FileItemState.LIMIT_OVERFLOW,\n      isUploading: state === FileItemState.UPLOADING,\n      isFinished: state === FileItemState.FINISHED,\n      progressVisible: state === FileItemState.UPLOADING,\n      isEditable: this.cfg.useCloudImageEditor && state === FileItemState.FINISHED && this._entry?.getValue('isImage'),\n      errorText:\n        this._entry.getValue('uploadError')?.message ||\n        this._entry.getValue('validationErrorMsg') ||\n        this._entry.getValue('validationMultipleLimitMsg'),\n    });\n\n    if (state === FileItemState.FAILED || state === FileItemState.LIMIT_OVERFLOW) {\n      this.$.badgeIcon = 'badge-error';\n    } else if (state === FileItemState.FINISHED) {\n      this.$.badgeIcon = 'badge-success';\n    }\n\n    if (state === FileItemState.UPLOADING) {\n      this.$.isFocused = false;\n    } else {\n      this.$.progressValue = 0;\n    }\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    FileItem.activeInstances.delete(this);\n\n    this._reset();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    /** @private */\n    this._observer = new window.IntersectionObserver(this._observerCallback.bind(this), {\n      root: this.parentElement,\n      rootMargin: '50% 0px 50% 0px',\n      threshold: [0, 1],\n    });\n    this._observer.observe(this);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this._debouncedGenerateThumb.cancel();\n    this._observer?.disconnect();\n  }\n\n  async upload() {\n    let entry = this._entry;\n\n    if (!this.uploadCollection.read(entry.uid)) {\n      return;\n    }\n\n    if (\n      entry.getValue('fileInfo') ||\n      entry.getValue('isUploading') ||\n      entry.getValue('uploadError') ||\n      entry.getValue('validationErrorMsg') ||\n      entry.getValue('validationMultipleLimitMsg')\n    ) {\n      return;\n    }\n    const multipleMax = this.cfg.multiple ? this.cfg.multipleMax : 1;\n    if (multipleMax && this.uploadCollection.size > multipleMax) {\n      return;\n    }\n    let data = this.getOutputData((dataItem) => {\n      return !dataItem.getValue('fileInfo');\n    });\n\n    EventManager.emit(\n      new EventData({\n        type: EVENT_TYPES.UPLOAD_START,\n        ctx: this.ctxName,\n        data,\n      })\n    );\n\n    this._debouncedCalculateState();\n    entry.setValue('isUploading', true);\n    entry.setValue('uploadError', null);\n    entry.setValue('validationErrorMsg', null);\n    entry.setValue('validationMultipleLimitMsg', null);\n\n    if (!entry.getValue('file') && entry.getValue('externalUrl')) {\n      this.$.progressUnknown = true;\n    }\n    try {\n      let abortController = new AbortController();\n      entry.setValue('abortController', abortController);\n\n      const uploadTask = async () => {\n        const uploadClientOptions = await this.getUploadClientOptions();\n        return uploadFile(entry.getValue('file') || entry.getValue('externalUrl') || entry.getValue('uuid'), {\n          ...uploadClientOptions,\n          fileName: entry.getValue('fileName'),\n          source: entry.getValue('source'),\n          onProgress: (progress) => {\n            if (progress.isComputable) {\n              let percentage = progress.value * 100;\n              entry.setValue('uploadProgress', percentage);\n            }\n            this.$.progressUnknown = !progress.isComputable;\n          },\n          signal: abortController.signal,\n        });\n      };\n\n      let fileInfo = await this.$['*uploadQueue'].add(uploadTask);\n      entry.setMultipleValues({\n        fileInfo,\n        isUploading: false,\n        fileName: fileInfo.originalFilename,\n        fileSize: fileInfo.size,\n        isImage: fileInfo.isImage,\n        mimeType: fileInfo.contentInfo?.mime?.mime ?? fileInfo.mimeType,\n        uuid: fileInfo.uuid,\n        cdnUrl: fileInfo.cdnUrl,\n      });\n\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n    } catch (error) {\n      console.warn('Upload error', error);\n\n      entry.setMultipleValues({\n        abortController: null,\n        isUploading: false,\n        uploadProgress: 0,\n      });\n\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n\n      if (error instanceof UploadClientError) {\n        if (!error.isCancel) {\n          entry.setValue('uploadError', error);\n        }\n      } else {\n        entry.setValue('uploadError', new Error('Unexpected error'));\n      }\n    }\n  }\n}\n\nFileItem.template = /* HTML */ `\n  <div\n    class=\"inner\"\n    set=\"@finished: isFinished; @uploading: isUploading; @failed: isFailed; @limit-overflow: isLimitOverflow; @focused: isFocused\"\n  >\n    <div class=\"thumb\" set=\"style.backgroundImage: thumbUrl\">\n      <div class=\"badge\">\n        <lr-icon set=\"@name: badgeIcon\"></lr-icon>\n      </div>\n    </div>\n    <div class=\"file-name-wrapper\">\n      <span class=\"file-name\" set=\"@title: itemName\">{{itemName}}</span>\n      <span class=\"file-error\" set=\"@hidden: !errorText\">{{errorText}}</span>\n    </div>\n    <div class=\"file-actions\">\n      <button type=\"button\" class=\"edit-btn mini-btn\" set=\"onclick: onEdit; @hidden: !isEditable\">\n        <lr-icon name=\"edit-file\"></lr-icon>\n      </button>\n      <button type=\"button\" class=\"remove-btn mini-btn\" set=\"onclick: onRemove;\">\n        <lr-icon name=\"remove-file\"></lr-icon>\n      </button>\n      <button type=\"button\" class=\"upload-btn mini-btn\" set=\"onclick: onUpload;\">\n        <lr-icon name=\"upload\"></lr-icon>\n      </button>\n    </div>\n    <lr-progress-bar\n      class=\"progress-bar\"\n      set=\"value: progressValue; visible: progressVisible; unknown: progressUnknown\"\n    >\n    </lr-progress-bar>\n  </div>\n`;\nFileItem.activeInstances = new Set();\n","/**\n * @param {File} imgFile\n * @param {Number} [size]\n */\nexport function generateThumb(imgFile, size = 40) {\n  if (imgFile.type === 'image/svg+xml') {\n    return URL.createObjectURL(imgFile);\n  }\n  let canvas = document.createElement('canvas');\n  let ctx = canvas.getContext('2d');\n  let img = new Image();\n  let promise = new Promise((resolve, reject) => {\n    img.onload = () => {\n      let ratio = img.height / img.width;\n      if (ratio > 1) {\n        canvas.width = size;\n        canvas.height = size * ratio;\n      } else {\n        canvas.height = size;\n        canvas.width = size / ratio;\n      }\n      ctx.fillStyle = 'rgb(240, 240, 240)';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      canvas.toBlob((blob) => {\n        if (!blob) {\n          reject();\n          return;\n        }\n        let url = URL.createObjectURL(blob);\n        resolve(url);\n      });\n    };\n    img.onerror = (err) => {\n      reject(err);\n    };\n  });\n  img.src = URL.createObjectURL(imgFile);\n  return promise;\n}\n","import { Block } from '../../abstract/Block.js';\n\nexport class UiMessage {\n  caption = '';\n  text = '';\n  iconName = '';\n  isError = false;\n}\n\nexport class MessageBox extends Block {\n  init$ = {\n    ...this.init$,\n    iconName: 'info',\n    captionTxt: 'Message caption',\n    msgTxt: 'Message...',\n    '*message': null,\n    onClose: () => {\n      this.$['*message'] = null;\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.sub('*message', (/** @type {UiMessage} */ msg) => {\n      if (msg) {\n        this.setAttribute('active', '');\n        this.set$({\n          captionTxt: msg.caption || '',\n          msgTxt: msg.text || '',\n          iconName: msg.isError ? 'error' : 'info',\n        });\n        if (msg.isError) {\n          this.setAttribute('error', '');\n        } else {\n          this.removeAttribute('error');\n        }\n      } else {\n        this.removeAttribute('active');\n      }\n    });\n  }\n}\n\nMessageBox.template = /* HTML */ `\n  <div class=\"heading\">\n    <lr-icon set=\"@name: iconName\"></lr-icon>\n    <div class=\"caption\">{{captionTxt}}</div>\n    <button type=\"button\" set=\"onclick: onClose\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </div>\n  <div class=\"msg\">{{msgTxt}}</div>\n`;\n","// @ts-check\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UiMessage } from '../MessageBox/MessageBox.js';\nimport { EVENT_TYPES, EventData, EventManager } from '../../abstract/EventManager.js';\nimport { debounce } from '../utils/debounce.js';\n\n/**\n * @typedef {{\n *   total: number;\n *   succeed: number;\n *   uploading: number;\n *   failed: number;\n *   limitOverflow: number;\n * }} Summary\n */\n\nexport class UploadList extends UploaderBlock {\n  couldBeUploadCollectionOwner = true;\n  historyTracked = true;\n  activityType = ActivityBlock.activities.UPLOAD_LIST;\n\n  // @ts-ignore TODO: fix this\n  init$ = {\n    ...this.init$,\n    doneBtnVisible: false,\n    doneBtnEnabled: false,\n    uploadBtnVisible: false,\n    addMoreBtnVisible: false,\n    addMoreBtnEnabled: false,\n    headerText: '',\n\n    hasFiles: false,\n    onAdd: () => {\n      this.initFlow(true);\n    },\n    onUpload: () => {\n      this.uploadAll();\n      this._updateUploadsState();\n    },\n    onDone: () => {\n      this.doneFlow();\n    },\n    onCancel: () => {\n      let data = this.getOutputData((dataItem) => {\n        return !!dataItem.getValue('fileInfo');\n      });\n      EventManager.emit(\n        new EventData({\n          type: EVENT_TYPES.REMOVE,\n          ctx: this.ctxName,\n          data,\n        })\n      );\n      this.uploadCollection.clearAll();\n    },\n  };\n\n  _debouncedHandleCollectionUpdate = debounce(() => {\n    if (!this.isConnected) {\n      return;\n    }\n    this._updateUploadsState();\n    this._updateCountLimitMessage();\n  }, 0);\n\n  /**\n   * @private\n   * @returns {{ passed: Boolean; tooFew: Boolean; tooMany: Boolean; exact: Boolean; min: Number; max: Number }}\n   */\n  _validateFilesCount() {\n    let multiple = !!this.cfg.multiple;\n    let min = multiple ? this.cfg.multipleMin ?? 0 : 1;\n    let max = multiple ? this.cfg.multipleMax ?? 0 : 1;\n    let count = this.uploadCollection.size;\n\n    let tooFew = min ? count < min : false;\n    let tooMany = max ? count > max : false;\n    let passed = !tooFew && !tooMany;\n    let exact = max === count;\n\n    return {\n      passed,\n      tooFew,\n      tooMany,\n      min,\n      max,\n      exact,\n    };\n  }\n\n  /** @private */\n  _updateCountLimitMessage() {\n    let filesCount = this.uploadCollection.size;\n    let countValidationResult = this._validateFilesCount();\n    if (filesCount && !countValidationResult.passed) {\n      let msg = new UiMessage();\n      let textKey = countValidationResult.tooFew\n        ? 'files-count-limit-error-too-few'\n        : 'files-count-limit-error-too-many';\n      msg.caption = this.l10n('files-count-limit-error-title');\n      msg.text = this.l10n(textKey, {\n        min: countValidationResult.min,\n        max: countValidationResult.max,\n        total: filesCount,\n      });\n      msg.isError = true;\n      this.set$({\n        '*message': msg,\n      });\n    } else {\n      this.set$({\n        '*message': null,\n      });\n    }\n  }\n\n  /** @private */\n  _updateUploadsState() {\n    let itemIds = this.uploadCollection.items();\n    let filesCount = itemIds.length;\n    /** @type {Summary} */\n    let summary = {\n      total: filesCount,\n      succeed: 0,\n      uploading: 0,\n      failed: 0,\n      limitOverflow: 0,\n    };\n    for (let id of itemIds) {\n      let item = this.uploadCollection.read(id);\n      if (item.getValue('fileInfo') && !item.getValue('validationErrorMsg')) {\n        summary.succeed += 1;\n      }\n      if (item.getValue('isUploading')) {\n        summary.uploading += 1;\n      }\n      if (item.getValue('validationErrorMsg') || item.getValue('uploadError')) {\n        summary.failed += 1;\n      }\n      if (item.getValue('validationMultipleLimitMsg')) {\n        summary.limitOverflow += 1;\n      }\n    }\n    const { passed: fitCountRestrictions, tooMany, exact } = this._validateFilesCount();\n    const validationOk = summary.failed === 0 && summary.limitOverflow === 0;\n    let uploadBtnVisible = false;\n    let allDone = false;\n    let doneBtnEnabled = false;\n\n    const readyToUpload = summary.total - summary.succeed - summary.uploading - summary.failed;\n    if (readyToUpload > 0 && fitCountRestrictions) {\n      uploadBtnVisible = true;\n    } else {\n      allDone = true;\n      doneBtnEnabled = summary.total === summary.succeed && fitCountRestrictions && validationOk;\n    }\n\n    this.set$({\n      doneBtnVisible: allDone,\n      doneBtnEnabled: doneBtnEnabled,\n\n      uploadBtnVisible,\n\n      addMoreBtnEnabled: summary.total === 0 || (!tooMany && !exact),\n      addMoreBtnVisible: !exact || this.cfg.multiple,\n\n      headerText: this._getHeaderText(summary),\n    });\n  }\n\n  /**\n   * @private\n   * @param {Summary} summary\n   */\n  _getHeaderText(summary) {\n    /** @param {keyof Summary} status */\n    const localizedText = (status) => {\n      const count = summary[status];\n      return this.l10n(`header-${status}`, {\n        count: count,\n      });\n    };\n    if (summary.uploading > 0) {\n      return localizedText('uploading');\n    }\n    if (summary.failed > 0) {\n      return localizedText('failed');\n    }\n    if (summary.succeed > 0) {\n      return localizedText('succeed');\n    }\n\n    return localizedText('total');\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.registerActivity(this.activityType);\n\n    this.subConfigValue('multiple', this._debouncedHandleCollectionUpdate);\n    this.subConfigValue('multipleMin', this._debouncedHandleCollectionUpdate);\n    this.subConfigValue('multipleMax', this._debouncedHandleCollectionUpdate);\n\n    this.sub('*currentActivity', (currentActivity) => {\n      if (this.uploadCollection?.size === 0 && !this.cfg.showEmptyList && currentActivity === this.activityType) {\n        this.$['*currentActivity'] = this.initActivity;\n      }\n    });\n\n    // TODO: could be performance issue on many files\n    // there is no need to update buttons state on every progress tick\n    this.uploadCollection.observe(this._debouncedHandleCollectionUpdate);\n\n    this.sub('*uploadList', (list) => {\n      this._debouncedHandleCollectionUpdate();\n\n      this.set$({\n        hasFiles: list.length > 0,\n      });\n\n      if (list?.length === 0 && !this.cfg.showEmptyList) {\n        this.historyBack();\n      }\n\n      if (!this.cfg.confirmUpload) {\n        this.add$(\n          {\n            '*uploadTrigger': {},\n          },\n          true\n        );\n      }\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this.uploadCollection.unobserve(this._debouncedHandleCollectionUpdate);\n  }\n}\n\nUploadList.template = /* HTML */ `\n  <lr-activity-header>\n    <span class=\"header-text\">{{headerText}}</span>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n\n  <div class=\"no-files\" set=\"@hidden: hasFiles\">\n    <slot name=\"empty\"><span l10n=\"no-files\"></span></slot>\n  </div>\n\n  <div class=\"files\" repeat=\"*uploadList\" repeat-item-tag=\"lr-file-item\"></div>\n\n  <div class=\"toolbar\">\n    <button type=\"button\" class=\"cancel-btn secondary-btn\" set=\"onclick: onCancel;\" l10n=\"clear\"></button>\n    <div class=\"toolbar-spacer\"></div>\n    <button\n      type=\"button\"\n      class=\"add-more-btn secondary-btn\"\n      set=\"onclick: onAdd; @disabled: !addMoreBtnEnabled; @hidden: !addMoreBtnVisible\"\n    >\n      <lr-icon name=\"add\"></lr-icon><span l10n=\"add-more\"></span>\n    </button>\n    <button\n      type=\"button\"\n      class=\"upload-btn primary-btn\"\n      set=\"@hidden: !uploadBtnVisible; onclick: onUpload;\"\n      l10n=\"upload\"\n    ></button>\n    <button\n      type=\"button\"\n      class=\"done-btn primary-btn\"\n      set=\"@hidden: !doneBtnVisible; onclick: onDone;  @disabled: !doneBtnEnabled\"\n      l10n=\"done\"\n    ></button>\n  </div>\n\n  <lr-drop-area ghost></lr-drop-area>\n`;\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploadSource } from '../utils/UploadSource.js';\n\nexport class UrlSource extends UploaderBlock {\n  activityType = ActivityBlock.activities.URL;\n\n  init$ = {\n    ...this.init$,\n    importDisabled: true,\n    onUpload: (e) => {\n      e.preventDefault();\n\n      let url = this.ref.input['value'];\n      this.addFileFromUrl(url, { source: UploadSource.URL_TAB });\n      this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n    },\n    onCancel: () => {\n      this.historyBack();\n    },\n    onInput: (e) => {\n      let value = /** @type {HTMLInputElement} */ (e.target).value;\n      this.set$({ importDisabled: !value });\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType, {\n      onActivate: () => {\n        this.ref.input['value'] = '';\n        this.ref.input.focus();\n      },\n    });\n  }\n}\n\nUrlSource.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <div>\n      <lr-icon name=\"url\"></lr-icon>\n      <span l10n=\"caption-from-url\"></span>\n    </div>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <form class=\"content\">\n    <input placeholder=\"https://\" class=\"url-input\" type=\"text\" ref=\"input\" set=\"oninput: onInput\" />\n    <button\n      type=\"submit\"\n      class=\"url-upload-btn primary-btn\"\n      set=\"onclick: onUpload; @disabled: importDisabled\"\n    ></button>\n  </form>\n`;\n","export const canUsePermissionsApi = () => {\n  return typeof navigator.permissions !== 'undefined';\n};\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { canUsePermissionsApi } from '../utils/abilities.js';\nimport { debounce } from '../utils/debounce.js';\nimport { UploadSource } from '../utils/UploadSource.js';\n\nexport class CameraSource extends UploaderBlock {\n  activityType = ActivityBlock.activities.CAMERA;\n\n  /** @private */\n  _unsubPermissions = null;\n\n  init$ = {\n    ...this.init$,\n    video: null,\n    videoTransformCss: null,\n    shotBtnDisabled: true,\n    videoHidden: true,\n    messageHidden: true,\n    requestBtnHidden: canUsePermissionsApi(),\n    l10nMessage: null,\n    originalErrorMessage: null,\n    cameraSelectOptions: null,\n    cameraSelectHidden: true,\n\n    onCameraSelectChange: (e) => {\n      /** @type {String} */\n      this._selectedCameraId = e.target.value;\n      this._capture();\n    },\n    onCancel: () => {\n      this.historyBack();\n    },\n    onShot: () => {\n      this._shot();\n    },\n    onRequestPermissions: () => {\n      this._capture();\n    },\n  };\n\n  /** @private */\n  _onActivate = () => {\n    if (canUsePermissionsApi()) {\n      this._subscribePermissions();\n    }\n    this._capture();\n  };\n\n  /** @private */\n  _onDeactivate = () => {\n    if (this._unsubPermissions) {\n      this._unsubPermissions();\n    }\n\n    this._stopCapture();\n  };\n\n  /** @private */\n  _handlePermissionsChange = () => {\n    this._capture();\n  };\n\n  /**\n   * @private\n   * @param {'granted' | 'denied' | 'prompt'} state\n   */\n  _setPermissionsState = debounce((state) => {\n    this.$.originalErrorMessage = null;\n    this.classList.toggle('initialized', state === 'granted');\n\n    if (state === 'granted') {\n      this.set$({\n        videoHidden: false,\n        shotBtnDisabled: false,\n        messageHidden: true,\n      });\n    } else if (state === 'prompt') {\n      this.$.l10nMessage = this.l10n('camera-permissions-prompt');\n      this.set$({\n        videoHidden: true,\n        shotBtnDisabled: true,\n        messageHidden: false,\n      });\n      this._stopCapture();\n    } else {\n      this.$.l10nMessage = this.l10n('camera-permissions-denied');\n\n      this.set$({\n        videoHidden: true,\n        shotBtnDisabled: true,\n        messageHidden: false,\n      });\n      this._stopCapture();\n    }\n  }, 300);\n\n  /** @private */\n  async _subscribePermissions() {\n    try {\n      // @ts-ignore\n      let permissionsResponse = await navigator.permissions.query({ name: 'camera' });\n      permissionsResponse.addEventListener('change', this._handlePermissionsChange);\n    } catch (err) {\n      console.log('Failed to use permissions API. Fallback to manual request mode.', err);\n      this._capture();\n    }\n  }\n\n  /** @private */\n  async _capture() {\n    let constr = {\n      video: {\n        width: {\n          ideal: 1920,\n        },\n        height: {\n          ideal: 1080,\n        },\n        frameRate: {\n          ideal: 30,\n        },\n      },\n      audio: false,\n    };\n    if (this._selectedCameraId) {\n      constr.video.deviceId = {\n        exact: this._selectedCameraId,\n      };\n    }\n    /** @private */\n    this._canvas = document.createElement('canvas');\n    /** @private */\n    this._ctx = this._canvas.getContext('2d');\n\n    try {\n      this._setPermissionsState('prompt');\n      let stream = await navigator.mediaDevices.getUserMedia(constr);\n      stream.addEventListener('inactive', () => {\n        this._setPermissionsState('denied');\n      });\n      this.$.video = stream;\n      /** @private */\n      this._capturing = true;\n      this._setPermissionsState('granted');\n    } catch (err) {\n      this._setPermissionsState('denied');\n      this.$.originalErrorMessage = err.message;\n    }\n  }\n\n  /** @private */\n  _stopCapture() {\n    if (this._capturing) {\n      this.$.video?.getTracks()[0].stop();\n      this.$.video = null;\n      this._capturing = false;\n    }\n  }\n\n  /** @private */\n  _shot() {\n    this._canvas.height = this.ref.video['videoHeight'];\n    this._canvas.width = this.ref.video['videoWidth'];\n    // @ts-ignore\n    this._ctx.drawImage(this.ref.video, 0, 0);\n    let date = Date.now();\n    let name = `camera-${date}.png`;\n    this._canvas.toBlob((blob) => {\n      let file = new File([blob], name, {\n        lastModified: date,\n        type: 'image/png',\n      });\n      this.addFileFromObject(file, { source: UploadSource.CAMERA });\n      this.set$({\n        '*currentActivity': ActivityBlock.activities.UPLOAD_LIST,\n      });\n    });\n  }\n\n  async initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType, {\n      onActivate: this._onActivate,\n      onDeactivate: this._onDeactivate,\n    });\n\n    this.subConfigValue('cameraMirror', (val) => {\n      this.$.videoTransformCss = val ? 'scaleX(-1)' : null;\n    });\n\n    try {\n      let deviceList = await navigator.mediaDevices.enumerateDevices();\n      let cameraSelectOptions = deviceList\n        .filter((info) => {\n          return info.kind === 'videoinput';\n        })\n        .map((info, idx) => {\n          return {\n            text: info.label.trim() || `${this.l10n('caption-camera')} ${idx + 1}`,\n            value: info.deviceId,\n          };\n        });\n      if (cameraSelectOptions.length > 1) {\n        this.$.cameraSelectOptions = cameraSelectOptions;\n        this.$.cameraSelectHidden = false;\n      }\n    } catch (err) {\n      // mediaDevices isn't available for HTTP\n      // TODO: handle this case\n    }\n  }\n}\n\nCameraSource.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <div set=\"@hidden: !cameraSelectHidden\">\n      <lr-icon name=\"camera\"></lr-icon>\n      <span l10n=\"caption-camera\"></span>\n    </div>\n    <lr-select\n      class=\"camera-select\"\n      set=\"$.options: cameraSelectOptions; @hidden: cameraSelectHidden; onchange: onCameraSelectChange\"\n    >\n    </lr-select>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <video\n      autoplay\n      playsinline\n      set=\"srcObject: video; style.transform: videoTransformCss; @hidden: videoHidden\"\n      ref=\"video\"\n    ></video>\n    <div class=\"message-box\" set=\"@hidden: messageHidden\">\n      <span>{{l10nMessage}}</span>\n      <span>{{originalErrorMessage}}</span>\n      <button\n        type=\"button\"\n        set=\"onclick: onRequestPermissions; @hidden: requestBtnHidden\"\n        l10n=\"camera-permissions-request\"\n      ></button>\n    </div>\n    <button type=\"button\" class=\"shot-btn\" set=\"onclick: onShot; @disabled: shotBtnDisabled\">\n      <lr-icon name=\"camera\"></lr-icon>\n    </button>\n  </div>\n`;\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { createCdnUrl, createCdnUrlModifiers } from '../../utils/cdn-utils.js';\nimport { fileCssBg } from '../svg-backgrounds/svg-backgrounds.js';\nimport { fileIsImage } from '../../utils/fileTypes.js';\n\nexport class UploadDetails extends UploaderBlock {\n  activityType = ActivityBlock.activities.DETAILS;\n\n  pauseRender = true;\n\n  init$ = {\n    ...this.init$,\n    checkerboard: false,\n    fileSize: null,\n    fileName: '',\n    cdnUrl: '',\n    errorTxt: '',\n    cloudEditBtnHidden: true,\n    onNameInput: null,\n    onBack: () => {\n      this.historyBack();\n    },\n    onRemove: () => {\n      /** @type {File[]} */\n      this.uploadCollection.remove(this.entry.uid);\n      this.historyBack();\n    },\n    onCloudEdit: () => {\n      if (this.entry.getValue('uuid')) {\n        this.$['*currentActivity'] = ActivityBlock.activities.CLOUD_IMG_EDIT;\n      }\n    },\n  };\n\n  showNonImageThumb() {\n    let color = window.getComputedStyle(this).getPropertyValue('--clr-generic-file-icon');\n    let url = fileCssBg(color, 108, 108);\n    this.ref.filePreview.setImageUrl(url);\n    this.set$({\n      checkerboard: false,\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n    // Rendering is postponed for the CSS-context-properties usage in template:\n    this.render();\n    this.$.fileSize = this.l10n('file-size-unknown');\n    this.registerActivity(this.activityType, {\n      onDeactivate: () => {\n        this.ref.filePreview.clear();\n      },\n    });\n    /** @type {import('../FilePreview/FilePreview.js').FilePreview} */\n    this.sub('*focusedEntry', (/** @type {import('../../abstract/TypedData.js').TypedData} */ entry) => {\n      if (!entry) {\n        return;\n      }\n      if (this._entrySubs) {\n        this._entrySubs.forEach((sub) => {\n          this._entrySubs.delete(sub);\n          sub.remove();\n        });\n      } else {\n        /** @private */\n        this._entrySubs = new Set();\n      }\n      this.entry = entry;\n      /** @type {File} */\n      let file = entry.getValue('file');\n      if (file) {\n        /**\n         * @private\n         * @type {File}\n         */\n        this._file = file;\n        let isImage = fileIsImage(this._file);\n        if (isImage && !entry.getValue('cdnUrl')) {\n          this.ref.filePreview.setImageFile(this._file);\n          this.set$({\n            checkerboard: true,\n          });\n        }\n        if (!isImage) {\n          this.showNonImageThumb();\n        }\n      }\n      let tmpSub = (prop, callback) => {\n        this._entrySubs.add(this.entry.subscribe(prop, callback));\n      };\n      tmpSub('fileName', (name) => {\n        this.$.fileName = name;\n        this.$.onNameInput = () => {\n          let value = this.ref.file_name_input['value'];\n          Object.defineProperty(this._file, 'name', {\n            writable: true,\n            value: value,\n          });\n          this.entry.setValue('fileName', value);\n        };\n      });\n      tmpSub('fileSize', (size) => {\n        this.$.fileSize = Number.isFinite(size) ? this.fileSizeFmt(size) : this.l10n('file-size-unknown');\n      });\n      tmpSub('uploadError', (error) => {\n        this.$.errorTxt = error?.message;\n      });\n\n      tmpSub('externalUrl', (url) => {\n        if (!url) {\n          return;\n        }\n        if (!this.entry.getValue('uuid')) {\n          this.showNonImageThumb();\n        }\n      });\n      tmpSub('cdnUrl', (cdnUrl) => {\n        const canUseCloudEditor = this.cfg.useCloudImageEditor && cdnUrl && this.entry.getValue('isImage');\n        cdnUrl && this.ref.filePreview.clear();\n        this.set$({\n          cdnUrl,\n          cloudEditBtnHidden: !canUseCloudEditor,\n        });\n        if (cdnUrl && this.entry.getValue('isImage')) {\n          // TODO: need to resize image to fit the canvas size\n          let imageUrl = createCdnUrl(cdnUrl, createCdnUrlModifiers('format/auto', 'preview'));\n          this.ref.filePreview.setImageUrl(this.proxyUrl(imageUrl));\n        }\n      });\n    });\n  }\n}\n\nUploadDetails.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <span l10n=\"caption-edit-file\"></span>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <lr-tabs tab-list=\"tab-view, tab-details\">\n      <div tab-ctx=\"tab-details\" class=\"details\">\n        <div class=\"info-block\">\n          <div class=\"info-block_name\" l10n=\"file-name\"></div>\n          <input\n            name=\"name-input\"\n            ref=\"file_name_input\"\n            set=\"value: fileName; oninput: onNameInput; @disabled: !!cdnUrl\"\n            type=\"text\"\n          />\n        </div>\n\n        <div class=\"info-block\">\n          <div class=\"info-block_name\" l10n=\"file-size\"></div>\n          <div>{{fileSize}}</div>\n        </div>\n\n        <div class=\"info-block\">\n          <div class=\"info-block_name\" l10n=\"cdn-url\"></div>\n          <a class=\"cdn-link\" target=\"_blank\" set=\"@href: cdnUrl; @disabled: !cdnUrl\">{{cdnUrl}}</a>\n        </div>\n\n        <div>{{errorTxt}}</div>\n      </div>\n\n      <lr-file-preview tab-ctx=\"tab-view\" set=\"@checkerboard: checkerboard;\" ref=\"filePreview\"> </lr-file-preview>\n    </lr-tabs>\n\n    <div class=\"toolbar\" set=\"@edit-disabled: cloudEditBtnHidden\">\n      <button type=\"button\" class=\"edit-btn secondary-btn\" set=\"onclick: onCloudEdit; @hidden: cloudEditBtnHidden;\">\n        <lr-icon name=\"edit\"></lr-icon>\n        <span l10n=\"edit-image\"></span>\n      </button>\n      <button type=\"button\" class=\"remove-btn secondary-btn\" set=\"onclick: onRemove\">\n        <lr-icon name=\"remove\"></lr-icon>\n        <span l10n=\"remove-from-list\"></span>\n      </button>\n      <div></div>\n      <button type=\"button\" class=\"back-btn primary-btn\" set=\"onclick: onBack\">\n        <span l10n=\"ok\"></span>\n      </button>\n    </div>\n  </div>\n`;\n","import { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class UiConfirmation {\n  captionL10nStr = 'confirm-your-action';\n  messageL10Str = 'are-you-sure';\n  confirmL10nStr = 'yes';\n  denyL10nStr = 'no';\n  confirmAction() {\n    console.log('Confirmed');\n  }\n  denyAction() {\n    this['historyBack']();\n  }\n}\n\nexport class ConfirmationDialog extends ActivityBlock {\n  activityType = ActivityBlock.activities.CONFIRMATION;\n\n  /** @private */\n  _defaults = new UiConfirmation();\n\n  init$ = {\n    ...this.init$,\n    activityCaption: '',\n    messageTxt: '',\n    confirmBtnTxt: '',\n    denyBtnTxt: '',\n    '*confirmation': null,\n    onConfirm: this._defaults.confirmAction,\n    onDeny: this._defaults.denyAction.bind(this),\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.set$({\n      messageTxt: this.l10n(this._defaults.messageL10Str),\n      confirmBtnTxt: this.l10n(this._defaults.confirmL10nStr),\n      denyBtnTxt: this.l10n(this._defaults.denyL10nStr),\n    });\n    this.sub('*confirmation', (/** @type {UiConfirmation} */ cfn) => {\n      if (!cfn) {\n        return;\n      }\n      this.set$({\n        '*currentActivity': ActivityBlock.activities.CONFIRMATION,\n        activityCaption: this.l10n(cfn.captionL10nStr),\n        messageTxt: this.l10n(cfn.messageL10Str),\n        confirmBtnTxt: this.l10n(cfn.confirmL10nStr),\n        denyBtnTxt: this.l10n(cfn.denyL10nStr),\n        onDeny: () => {\n          cfn.denyAction();\n        },\n        onConfirm: () => {\n          cfn.confirmAction();\n        },\n      });\n    });\n  }\n}\n\nConfirmationDialog.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <span>{{activityCaption}}</span>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n\n  <div class=\"message\">{{messageTxt}}</div>\n  <div class=\"toolbar\">\n    <button type=\"button\" class=\"deny-btn secondary-btn\" set=\"onclick: onDeny\">{{denyBtnTxt}}</button>\n    <button type=\"button\" class=\"confirm-btn primary-btn\" set=\"onclick: onConfirm\">{{confirmBtnTxt}}</button>\n  </div>\n`;\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\n\nexport class ProgressBarCommon extends UploaderBlock {\n  init$ = {\n    ...this.init$,\n    visible: false,\n    unknown: false,\n    value: 0,\n\n    '*commonProgress': 0,\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.uploadCollection.observe(() => {\n      let anyUploading = this.uploadCollection.items().some((id) => {\n        let item = this.uploadCollection.read(id);\n        return item.getValue('isUploading');\n      });\n\n      this.$.visible = anyUploading;\n    });\n\n    this.sub('visible', (visible) => {\n      if (visible) {\n        this.setAttribute('active', '');\n      } else {\n        this.removeAttribute('active');\n      }\n    });\n\n    this.sub('*commonProgress', (progress) => {\n      this.$.value = progress;\n    });\n  }\n}\n\nProgressBarCommon.template = /* HTML */ `\n  <lr-progress-bar set=\"visible: visible; unknown: unknown; value: value\"></lr-progress-bar>\n`;\n","import { Block } from '../../abstract/Block.js';\n\nexport class ProgressBar extends Block {\n  /** @type {Number} */\n  _value = 0;\n  /** @type {Boolean} */\n  _unknownMode = false;\n\n  init$ = {\n    ...this.init$,\n    width: 0,\n    opacity: 0,\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.defineAccessor('value', (value) => {\n      if (value === undefined) {\n        return;\n      }\n      this._value = value;\n\n      if (!this._unknownMode) {\n        this.style.setProperty('--l-width', this._value.toString());\n      }\n    });\n    this.defineAccessor('visible', (visible) => {\n      this.ref.line.classList.toggle('progress--hidden', !visible);\n    });\n    this.defineAccessor('unknown', (unknown) => {\n      this._unknownMode = unknown;\n      this.ref.line.classList.toggle('progress--unknown', unknown);\n    });\n  }\n}\n\nProgressBar.template = /* HTML */ ` <div ref=\"line\" class=\"progress\"></div> `;\n","export const TRANSPARENT_PIXEL_SRC =\n  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n","import { Block } from '../../abstract/Block.js';\nimport { checkerboardCssBg } from '../svg-backgrounds/svg-backgrounds.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../utils/transparentPixelSrc.js';\n\nexport class FilePreview extends Block {\n  init$ = {\n    ...this.init$,\n    checkerboard: false,\n    src: TRANSPARENT_PIXEL_SRC,\n  };\n\n  constructor() {\n    super();\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.sub('checkerboard', () => {\n      this.style.backgroundImage = this.hasAttribute('checkerboard') ? `url(${checkerboardCssBg()})` : 'unset';\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    URL.revokeObjectURL(this._lastObjectUrl);\n  }\n\n  /** @param {HTMLImageElement} img */\n  setImage(img) {\n    this.$.src = img.src;\n  }\n\n  /** @param {File} imgFile */\n  setImageFile(imgFile) {\n    let url = URL.createObjectURL(imgFile);\n    this.$.src = url;\n    this._lastObjectUrl = url;\n  }\n\n  /** @param {String} url */\n  setImageUrl(url) {\n    this.$.src = url;\n  }\n\n  clear() {\n    URL.revokeObjectURL(this._lastObjectUrl);\n    this.$.src = TRANSPARENT_PIXEL_SRC;\n  }\n}\n\nFilePreview.template = /* HTML */ ` <lr-img class=\"img-view\" ref=\"img\" set=\"@src: src; style.aa: src;\" /> `;\n\nFilePreview.bindAttributes({\n  checkerboard: 'checkerboard',\n});\n","// @ts-check\nimport { Data } from '@symbiotejs/symbiote';\nimport { Block } from '../../../abstract/Block.js';\n\nconst CSS_CFG_CTX_NAME = '--cfg-ctx-name';\n\nexport class CloudImageEditorBase extends Block {\n  /**\n   * @private\n   * @returns {string}\n   */\n  get cfgCssCtxName() {\n    return this.getCssData(CSS_CFG_CTX_NAME, true);\n  }\n\n  /** @private */\n  get cfgCtxName() {\n    const ctxName = this.getAttribute('ctx-name')?.trim() || this.cfgCssCtxName || this.__cachedCfgCtxName;\n    /**\n     * Cache last ctx name to be able to access context when element becames disconnected\n     *\n     * @type {String}\n     */\n    this.__cachedCfgCtxName = ctxName;\n    return ctxName;\n  }\n\n  connectedCallback() {\n    if (!this.connectedOnce) {\n      const ctxName = this.getAttribute('ctx-name')?.trim();\n      if (ctxName) {\n        this.style.setProperty(CSS_CFG_CTX_NAME, `'${ctxName}'`);\n      }\n    }\n\n    super.connectedCallback();\n  }\n\n  /**\n   * Resolve cfg from context passed with ctx-name attribute\n   *\n   * @param {String} prop\n   * @returns {any}\n   * @protected\n   */\n  parseCfgProp(prop) {\n    const parsed = {\n      ...super.parseCfgProp(prop),\n      ctx: Data.getCtx(this.cfgCtxName),\n    };\n    return parsed;\n  }\n}\n","function normalize(...args) {\n  return args.reduce((result, arg) => {\n    if (typeof arg === 'string') {\n      result[arg] = true;\n      return result;\n    }\n\n    for (let token of Object.keys(arg)) {\n      result[token] = arg[token];\n    }\n\n    return result;\n  }, {});\n}\n\nexport function classNames(...args) {\n  let mapping = normalize(...args);\n  return Object.keys(mapping)\n    .reduce((result, token) => {\n      if (mapping[token]) {\n        result.push(token);\n      }\n\n      return result;\n    }, [])\n    .join(' ');\n}\n\nexport function applyClassNames(element, ...args) {\n  let mapping = normalize(...args);\n  for (let token of Object.keys(mapping)) {\n    element.classList.toggle(token, mapping[token]);\n  }\n}\n","/**\n * @param {function} callback\n * @param {Number} wait\n * @returns {function}\n */\nexport function debounce(callback, wait) {\n  let timer;\n  let debounced = (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => callback(...args), wait);\n  };\n  debounced.cancel = () => {\n    clearTimeout(timer);\n  };\n  return debounced;\n}\n","import { joinCdnOperations } from '../../../../utils/cdn-utils.js';\nimport { stringToArray } from '../../../../utils/stringToArray.js';\n\nexport const OPERATIONS_ZEROS = {\n  brightness: 0,\n  exposure: 0,\n  gamma: 100,\n  contrast: 0,\n  saturation: 0,\n  vibrance: 0,\n  warmth: 0,\n  enhance: 0,\n  filter: 0,\n  rotate: 0,\n};\n\n/**\n * @param {String} operation\n * @param {Number | String | object} options\n * @returns {String}\n */\nfunction transformationToStr(operation, options) {\n  if (typeof options === 'number') {\n    return OPERATIONS_ZEROS[operation] !== options ? `${operation}/${options}` : '';\n  }\n\n  if (typeof options === 'boolean') {\n    return options && OPERATIONS_ZEROS[operation] !== options ? `${operation}` : '';\n  }\n\n  if (operation === 'filter') {\n    if (!options || OPERATIONS_ZEROS[operation] === options.amount) {\n      return '';\n    }\n    let { name, amount } = options;\n    return `${operation}/${name}/${amount}`;\n  }\n\n  if (operation === 'crop') {\n    if (!options) {\n      return '';\n    }\n    let { dimensions, coords } = options;\n    return `${operation}/${dimensions.join('x')}/${coords.join(',')}`;\n  }\n\n  return '';\n}\n\n// TODO: refactor all the operations constants\nconst SUPPORTED_OPERATIONS_ORDERED = [\n  'enhance',\n  'brightness',\n  'exposure',\n  'gamma',\n  'contrast',\n  'saturation',\n  'vibrance',\n  'warmth',\n  'filter',\n  'mirror',\n  'flip',\n  'rotate',\n  'crop',\n];\n\n/**\n * @param {import('../types').Transformations} transformations\n * @returns {String}\n */\nexport function transformationsToOperations(transformations) {\n  return joinCdnOperations(\n    ...SUPPORTED_OPERATIONS_ORDERED.filter(\n      (operation) => typeof transformations[operation] !== 'undefined' && transformations[operation] !== null\n    )\n      .map((operation) => {\n        let options = transformations[operation];\n        return transformationToStr(operation, options);\n      })\n      .filter((str) => !!str)\n  );\n}\n\nexport const COMMON_OPERATIONS = joinCdnOperations('format/auto', 'progressive/yes');\n\nconst asNumber = ([value]) => (typeof value !== 'undefined' ? Number(value) : undefined);\nconst asBoolean = () => true;\nconst asFilter = ([name, amount]) => ({\n  name,\n  amount: typeof amount !== 'undefined' ? Number(amount) : 100,\n});\n\n// Docs: https://uploadcare.com/docs/transformations/image/resize-crop/#operation-crop\n// We don't support percentages and aligment presets,\n// Because it's unclear how to handle them in the Editor UI\n// TODO: add support for percentages and aligment presets\nconst asCrop = ([dimensions, coords]) => {\n  return { dimensions: stringToArray(dimensions, 'x').map(Number), coords: stringToArray(coords).map(Number) };\n};\n\nconst OPERATION_PROCESSORS = {\n  enhance: asNumber,\n  brightness: asNumber,\n  exposure: asNumber,\n  gamma: asNumber,\n  contrast: asNumber,\n  saturation: asNumber,\n  vibrance: asNumber,\n  warmth: asNumber,\n  filter: asFilter,\n  mirror: asBoolean,\n  flip: asBoolean,\n  rotate: asNumber,\n  crop: asCrop,\n};\n\n/**\n * @param {string[]} operations\n * @returns {import('../types.js').Transformations}\n */\nexport function operationsToTransformations(operations) {\n  /** @type {import('../types.js').Transformations} */\n  let transformations = {};\n  for (let operation of operations) {\n    let [name, ...args] = operation.split('/');\n    if (!SUPPORTED_OPERATIONS_ORDERED.includes(name)) {\n      continue;\n    }\n    const processor = OPERATION_PROCESSORS[name];\n    const value = processor(args);\n    transformations[name] = value;\n  }\n  return transformations;\n}\n","import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\nimport { transformationsToOperations } from './lib/transformationUtils.js';\n\n/** @param {import('./CloudImageEditorBlock.js').CloudImageEditorBlock} fnCtx */\nexport function initState(fnCtx) {\n  return {\n    '*originalUrl': null,\n    '*faderEl': null,\n    '*cropperEl': null,\n    '*imgEl': null,\n    '*imgContainerEl': null,\n    '*networkProblems': false,\n    '*imageSize': null,\n    /** @type {import('./types.js').Transformations} */\n    '*editorTransformations': {},\n\n    entry: null,\n    extension: null,\n    editorMode: false,\n    modalCaption: '',\n    isImage: false,\n    msg: '',\n    src: TRANSPARENT_PIXEL_SRC,\n    fileType: '',\n    showLoader: false,\n    uuid: null,\n    cdnUrl: null,\n\n    'presence.networkProblems': false,\n    'presence.modalCaption': true,\n    'presence.editorToolbar': false,\n    'presence.viewerToolbar': true,\n    // TODO: beware of wrong ctx in case of element re-creation:\n    '*on.retryNetwork': () => {\n      let images = fnCtx.querySelectorAll('img');\n      for (let img of images) {\n        let originalSrc = img.src;\n        img.src = TRANSPARENT_PIXEL_SRC;\n        img.src = originalSrc;\n      }\n      fnCtx.$['*networkProblems'] = false;\n    },\n    '*on.apply': (transformations) => {\n      if (!transformations) {\n        return;\n      }\n      let originalUrl = fnCtx.$['*originalUrl'];\n      let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations));\n      let cdnUrl = createCdnUrl(originalUrl, createCdnUrlModifiers(cdnUrlModifiers, 'preview'));\n\n      /** @type {import('./types.js').ApplyResult} */\n      let eventData = {\n        originalUrl,\n        cdnUrlModifiers,\n        cdnUrl,\n        transformations,\n      };\n      fnCtx.dispatchEvent(\n        new CustomEvent('apply', {\n          detail: eventData,\n          bubbles: true,\n          composed: true,\n        })\n      );\n      fnCtx.remove();\n    },\n    '*on.cancel': () => {\n      fnCtx.remove();\n\n      fnCtx.dispatchEvent(\n        new CustomEvent('cancel', {\n          bubbles: true,\n          composed: true,\n        })\n      );\n    },\n  };\n}\n","import { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\n\nexport const TEMPLATE = /* HTML */ `\n  <div class=\"wrapper wrapper_desktop\">\n    <lr-presence-toggle class=\"network_problems_splash\" set=\"visible: presence.networkProblems;\">\n      <div class=\"network_problems_content\">\n        <div class=\"network_problems_icon\">\n          <lr-icon size=\"20\" name=\"sad\"></lr-icon>\n        </div>\n        <div class=\"network_problems_text\">Network error</div>\n      </div>\n      <div class=\"network_problems_footer\">\n        <lr-btn-ui theme=\"primary\" text=\"Retry\" set=\"onclick: *on.retryNetwork\"></lr-btn-ui>\n      </div>\n    </lr-presence-toggle>\n    <div class=\"viewport\">\n      <div class=\"file_type_outer\">\n        <div class=\"file_type\">{{fileType}}</div>\n      </div>\n      <div class=\"image_container\" ref=\"img-container-el\">\n        <img src=\"${TRANSPARENT_PIXEL_SRC}\" class=\"image image_visible_from_editor\" ref=\"img-el\" />\n        <lr-editor-image-cropper ref=\"cropper-el\"></lr-editor-image-cropper>\n        <lr-editor-image-fader ref=\"fader-el\"></lr-editor-image-fader>\n      </div>\n      <div class=\"info_pan\">{{msg}}</div>\n    </div>\n    <div class=\"toolbar\">\n      <lr-line-loader-ui set=\"active: showLoader\"></lr-line-loader-ui>\n      <div class=\"toolbar_content toolbar_content__editor\">\n        <lr-editor-toolbar></lr-editor-toolbar>\n      </div>\n    </div>\n  </div>\n`;\n","import { OPERATIONS_ZEROS } from './lib/transformationUtils.js';\n\n/** @type {{ CROP: 'crop'; SLIDERS: 'sliders'; FILTERS: 'filters' }} */\nexport const TabId = {\n  CROP: 'crop',\n  SLIDERS: 'sliders',\n  FILTERS: 'filters',\n};\nexport const TABS = [TabId.CROP, TabId.SLIDERS, TabId.FILTERS];\n\nexport const ALL_COLOR_OPERATIONS = [\n  'brightness',\n  'exposure',\n  'gamma',\n  'contrast',\n  'saturation',\n  'vibrance',\n  'warmth',\n  'enhance',\n];\n\nexport const ALL_FILTERS = [\n  'adaris',\n  'briaril',\n  'calarel',\n  'carris',\n  'cynarel',\n  'cyren',\n  'elmet',\n  'elonni',\n  'enzana',\n  'erydark',\n  'fenralan',\n  'ferand',\n  'galen',\n  'gavin',\n  'gethriel',\n  'iorill',\n  'iothari',\n  'iselva',\n  'jadis',\n  'lavra',\n  'misiara',\n  'namala',\n  'nerion',\n  'nethari',\n  'pamaya',\n  'sarnar',\n  'sedis',\n  'sewen',\n  'sorahel',\n  'sorlen',\n  'tarian',\n  'thellassan',\n  'varriel',\n  'varven',\n  'vevera',\n  'virkas',\n  'yedis',\n  'yllara',\n  'zatvel',\n  'zevcen',\n];\n\nexport const ALL_CROP_OPERATIONS = ['rotate', 'mirror', 'flip'];\n\n/** KeypointsNumber is the number of keypoints loaded from each side of zero, not total number */\nexport const COLOR_OPERATIONS_CONFIG = {\n  brightness: {\n    zero: OPERATIONS_ZEROS.brightness,\n    range: [-100, 100],\n    keypointsNumber: 2,\n  },\n  exposure: {\n    zero: OPERATIONS_ZEROS.exposure,\n    range: [-500, 500],\n    keypointsNumber: 2,\n  },\n  gamma: {\n    zero: OPERATIONS_ZEROS.gamma,\n    range: [0, 1000],\n    keypointsNumber: 2,\n  },\n  contrast: {\n    zero: OPERATIONS_ZEROS.contrast,\n    range: [-100, 500],\n    keypointsNumber: 2,\n  },\n  saturation: {\n    zero: OPERATIONS_ZEROS.saturation,\n    range: [-100, 500],\n    keypointsNumber: 1,\n  },\n  vibrance: {\n    zero: OPERATIONS_ZEROS.vibrance,\n    range: [-100, 500],\n    keypointsNumber: 1,\n  },\n  warmth: {\n    zero: OPERATIONS_ZEROS.warmth,\n    range: [-100, 100],\n    keypointsNumber: 1,\n  },\n  enhance: {\n    zero: OPERATIONS_ZEROS.enhance,\n    range: [0, 100],\n    keypointsNumber: 1,\n  },\n  filter: {\n    zero: OPERATIONS_ZEROS.filter,\n    range: [0, 100],\n    keypointsNumber: 1,\n  },\n};\n","// @ts-check\nimport {\n  createCdnUrl,\n  createCdnUrlModifiers,\n  createOriginalUrl,\n  extractOperations,\n  extractUuid,\n} from '../../../utils/cdn-utils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\nimport { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { operationsToTransformations, transformationsToOperations } from './lib/transformationUtils.js';\nimport { initState } from './state.js';\nimport { TEMPLATE } from './template.js';\nimport { TabId } from './toolbar-constants.js';\n\nexport class CloudImageEditorBlock extends CloudImageEditorBase {\n  static className = 'cloud-image-editor';\n\n  // @ts-ignore TODO: fix this\n  init$ = {\n    ...this.init$,\n    // @ts-ignore TODO: fix this\n    ...initState(this),\n  };\n\n  /** Force cloud editor to always use own context */\n  get ctxName() {\n    return this.autoCtxName;\n  }\n\n  /** @private */\n  _debouncedShowLoader = debounce(this._showLoader.bind(this), 300);\n\n  /**\n   * @private\n   * @param {boolean} show\n   */\n  _showLoader(show) {\n    this.$.showLoader = show;\n  }\n\n  /**\n   * To proper work, we need non-zero size the element. So, we'll wait for it.\n   *\n   * @private\n   * @returns {Promise<void>}\n   */\n  _waitForSize() {\n    const TIMEOUT = 3000;\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        reject(new Error('[cloud-image-editor] timeout waiting for non-zero container size'));\n      }, TIMEOUT);\n      const resizeObserver = new ResizeObserver(([element]) => {\n        if (element.contentRect.width > 0 && element.contentRect.height > 0) {\n          resolve();\n          clearTimeout(timeoutId);\n          resizeObserver.disconnect();\n        }\n      });\n      resizeObserver.observe(this);\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['*faderEl'] = this.ref['fader-el'];\n    this.$['*cropperEl'] = this.ref['cropper-el'];\n    this.$['*imgContainerEl'] = this.ref['img-container-el'];\n\n    this.initEditor();\n  }\n\n  async initEditor() {\n    try {\n      await this._waitForSize();\n    } catch (err) {\n      if (this.isConnected) {\n        // @ts-ignore TODO: fix this\n        console.error(err.message);\n      }\n      return;\n    }\n\n    this.ref['img-el'].addEventListener('load', () => {\n      this._imgLoading = false;\n      this._debouncedShowLoader(false);\n\n      if (this.$.src !== TRANSPARENT_PIXEL_SRC) {\n        this.$['*networkProblems'] = false;\n      }\n    });\n\n    this.ref['img-el'].addEventListener('error', () => {\n      this._imgLoading = false;\n      this._debouncedShowLoader(false);\n\n      this.$['*networkProblems'] = true;\n    });\n\n    this.sub('src', (src) => {\n      let el = this.ref['img-el'];\n      if (el.src !== src) {\n        this._imgLoading = true;\n        el.src = src || TRANSPARENT_PIXEL_SRC;\n      }\n    });\n\n    this.sub('*tabId', (tabId) => {\n      this.ref['img-el'].className = classNames('image', {\n        image_hidden_to_cropper: tabId === TabId.CROP,\n        image_hidden_effects: tabId !== TabId.CROP,\n      });\n    });\n\n    if (this.$.cdnUrl) {\n      let uuid = extractUuid(this.$.cdnUrl);\n      this.$['*originalUrl'] = createOriginalUrl(this.$.cdnUrl, uuid);\n      let operations = extractOperations(this.$.cdnUrl);\n      let transformations = operationsToTransformations(operations);\n      this.$['*editorTransformations'] = transformations;\n    } else if (this.$.uuid) {\n      this.$['*originalUrl'] = createOriginalUrl(this.cfg.cdnCname, this.$.uuid);\n    } else {\n      throw new Error('No UUID nor CDN URL provided');\n    }\n\n    this.classList.add('editor_ON');\n\n    this.sub('*networkProblems', (networkProblems) => {\n      this.$['presence.networkProblems'] = networkProblems;\n      this.$['presence.modalCaption'] = !networkProblems;\n    });\n\n    this.sub(\n      '*editorTransformations',\n      (transformations) => {\n        let originalUrl = this.$['*originalUrl'];\n        let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations));\n        let cdnUrl = createCdnUrl(originalUrl, createCdnUrlModifiers(cdnUrlModifiers, 'preview'));\n\n        /** @type {import('./types.js').ApplyResult} */\n        let eventData = {\n          originalUrl,\n          cdnUrlModifiers,\n          cdnUrl,\n          transformations,\n        };\n        this.dispatchEvent(\n          new CustomEvent('change', {\n            detail: eventData,\n            bubbles: true,\n            composed: true,\n          })\n        );\n      },\n      false\n    );\n\n    try {\n      fetch(createCdnUrl(this.$['*originalUrl'], createCdnUrlModifiers('json')))\n        .then((response) => response.json())\n        .then((json) => {\n          const { width, height } = /** @type {{ width: number; height: number }} */ (json);\n          this.$['*imageSize'] = { width, height };\n        });\n    } catch (err) {\n      if (err) {\n        console.error('Failed to load image info', err);\n      }\n    }\n  }\n}\n\nCloudImageEditorBlock.template = TEMPLATE;\nCloudImageEditorBlock.bindAttributes({\n  uuid: 'uuid',\n  'cdn-url': 'cdnUrl',\n});\n","export const CROP_PADDING = 20;\nexport const THUMB_CORNER_SIZE = 24;\nexport const THUMB_SIDE_SIZE = 34;\nexport const THUMB_STROKE_WIDTH = 3;\nexport const THUMB_OFFSET = THUMB_STROKE_WIDTH / 2;\n\nexport const GUIDE_STROKE_WIDTH = 1;\nexport const GUIDE_THIRD = 100 / 3;\nexport const MIN_CROP_SIZE = THUMB_CORNER_SIZE * 2 + THUMB_SIDE_SIZE;\n","import { THUMB_CORNER_SIZE, THUMB_OFFSET, THUMB_SIDE_SIZE } from './cropper-constants.js';\n\n/**\n * @param {SVGElement} node\n * @param {{ [key: String]: String | Number }} attrs\n */\nexport function setSvgNodeAttrs(node, attrs) {\n  for (let p in attrs) node.setAttributeNS(null, p, attrs[p].toString());\n}\n\n/**\n * @param {String} name\n * @param {{ [key: String]: String | Number }} attrs\n * @returns {SVGElement}\n */\nexport function createSvgNode(name, attrs = {}) {\n  let node = document.createElementNS('http://www.w3.org/2000/svg', name);\n  setSvgNodeAttrs(node, attrs);\n  return node;\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {String} direction\n */\nexport function cornerPath(rect, direction) {\n  let { x, y, width, height } = rect;\n\n  let wMul = direction.includes('w') ? 0 : 1;\n  let hMul = direction.includes('n') ? 0 : 1;\n  let xSide = [-1, 1][wMul];\n  let ySide = [-1, 1][hMul];\n\n  let p1 = [\n    x + wMul * width + THUMB_OFFSET * xSide,\n    y + hMul * height + THUMB_OFFSET * ySide - THUMB_CORNER_SIZE * ySide,\n  ];\n  let p2 = [x + wMul * width + THUMB_OFFSET * xSide, y + hMul * height + THUMB_OFFSET * ySide];\n  let p3 = [\n    x + wMul * width - THUMB_CORNER_SIZE * xSide + THUMB_OFFSET * xSide,\n    y + hMul * height + THUMB_OFFSET * ySide,\n  ];\n\n  let path = `M ${p1[0]} ${p1[1]} L ${p2[0]} ${p2[1]} L ${p3[0]} ${p3[1]}`;\n  let center = p2;\n\n  return {\n    d: path,\n    center,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {String} direction\n */\nexport function sidePath(rect, direction) {\n  let { x, y, width, height } = rect;\n\n  let wMul = ['n', 's'].includes(direction) ? 0.5 : { w: 0, e: 1 }[direction];\n  let hMul = ['w', 'e'].includes(direction) ? 0.5 : { n: 0, s: 1 }[direction];\n  let xSide = [-1, 1][wMul];\n  let ySide = [-1, 1][hMul];\n\n  let p1, p2;\n  if (['n', 's'].includes(direction)) {\n    p1 = [x + wMul * width - THUMB_SIDE_SIZE / 2, y + hMul * height + THUMB_OFFSET * ySide];\n    p2 = [x + wMul * width + THUMB_SIDE_SIZE / 2, y + hMul * height + THUMB_OFFSET * ySide];\n  } else {\n    p1 = [x + wMul * width + THUMB_OFFSET * xSide, y + hMul * height - THUMB_SIDE_SIZE / 2];\n    p2 = [x + wMul * width + THUMB_OFFSET * xSide, y + hMul * height + THUMB_SIDE_SIZE / 2];\n  }\n  let path = `M ${p1[0]} ${p1[1]} L ${p2[0]} ${p2[1]}`;\n  let center = [p2[0] - (p2[0] - p1[0]) / 2, p2[1] - (p2[1] - p1[1]) / 2];\n\n  return { d: path, center };\n}\n\n/** @param {String} direction */\nexport function thumbCursor(direction) {\n  if (direction === '') {\n    return 'move';\n  }\n  if (['e', 'w'].includes(direction)) {\n    return 'ew-resize';\n  }\n  if (['n', 's'].includes(direction)) {\n    return 'ns-resize';\n  }\n  if (['nw', 'se'].includes(direction)) {\n    return 'nwse-resize';\n  }\n  return 'nesw-resize';\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} delta\n */\nexport function moveRect(rect, [dx, dy]) {\n  return {\n    ...rect,\n    x: rect.x + dx,\n    y: rect.y + dy,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect1\n * @param {import('./types.js').Rectangle} rect2\n */\nexport function constraintRect(rect1, rect2) {\n  let { x } = rect1;\n  let { y } = rect1;\n  if (rect1.x < rect2.x) {\n    x = rect2.x;\n  } else if (rect1.x + rect1.width > rect2.x + rect2.width) {\n    x = rect2.x + rect2.width - rect1.width;\n  }\n  if (rect1.y < rect2.y) {\n    y = rect2.y;\n  } else if (rect1.y + rect1.height > rect2.y + rect2.height) {\n    y = rect2.y + rect2.height - rect1.height;\n  }\n\n  return {\n    ...rect1,\n    x,\n    y,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} delta\n * @param {String} direction\n */\nexport function expandRect(rect, [dx, dy], direction) {\n  let { x, y, width, height } = rect;\n\n  if (direction.includes('n')) {\n    y += dy;\n    height -= dy;\n  }\n  if (direction.includes('s')) {\n    height += dy;\n  }\n  if (direction.includes('w')) {\n    x += dx;\n    width -= dx;\n  }\n  if (direction.includes('e')) {\n    width += dx;\n  }\n  return {\n    x,\n    y,\n    width,\n    height,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect1\n * @param {import('./types.js').Rectangle} rect2\n */\nexport function intersectionRect(rect1, rect2) {\n  let leftX = Math.max(rect1.x, rect2.x);\n  let rightX = Math.min(rect1.x + rect1.width, rect2.x + rect2.width);\n  let topY = Math.max(rect1.y, rect2.y);\n  let bottomY = Math.min(rect1.y + rect1.height, rect2.y + rect2.height);\n\n  return { x: leftX, y: topY, width: rightX - leftX, height: bottomY - topY };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} minSize\n * @param {String} direction\n */\nexport function minRectSize(rect, [minWidth, minHeight], direction) {\n  let { x, y, width, height } = rect;\n\n  if (direction.includes('n')) {\n    let prevHeight = height;\n    height = Math.max(minHeight, height);\n    y = y + prevHeight - height;\n  }\n  if (direction.includes('s')) {\n    height = Math.max(minHeight, height);\n  }\n  if (direction.includes('w')) {\n    let prevWidth = width;\n    width = Math.max(minWidth, width);\n    x = x + prevWidth - width;\n  }\n  if (direction.includes('e')) {\n    width = Math.max(minWidth, width);\n  }\n\n  return { x, y, width, height };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} point\n */\nexport function rectContainsPoint(rect, [x, y]) {\n  return rect.x <= x && x <= rect.x + rect.width && rect.y <= y && y <= rect.y + rect.height;\n}\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport {\n  constraintRect,\n  cornerPath,\n  createSvgNode,\n  expandRect,\n  intersectionRect,\n  minRectSize,\n  moveRect,\n  rectContainsPoint,\n  setSvgNodeAttrs,\n  sidePath,\n  thumbCursor,\n} from './crop-utils.js';\nimport {\n  GUIDE_STROKE_WIDTH,\n  GUIDE_THIRD,\n  MIN_CROP_SIZE,\n  THUMB_CORNER_SIZE,\n  THUMB_OFFSET,\n  THUMB_STROKE_WIDTH,\n} from './cropper-constants.js';\nimport { classNames } from './lib/classNames.js';\n\nexport class CropFrame extends CloudImageEditorBase {\n  init$ = {\n    ...this.init$,\n    dragging: false,\n  };\n\n  constructor() {\n    super();\n\n    /** @private */\n    this._handlePointerUp = this._handlePointerUp_.bind(this);\n\n    /** @private */\n    this._handlePointerMove = this._handlePointerMove_.bind(this);\n\n    /** @private */\n    this._handleSvgPointerMove = this._handleSvgPointerMove_.bind(this);\n  }\n\n  _shouldThumbBeDisabled(direction) {\n    let imageBox = this.$['*imageBox'];\n    if (!imageBox) {\n      return;\n    }\n\n    if (direction === '' && imageBox.height <= MIN_CROP_SIZE && imageBox.width <= MIN_CROP_SIZE) {\n      return true;\n    }\n\n    let tooHigh = imageBox.height <= MIN_CROP_SIZE && (direction.includes('n') || direction.includes('s'));\n    let tooWide = imageBox.width <= MIN_CROP_SIZE && (direction.includes('e') || direction.includes('w'));\n    return tooHigh || tooWide;\n  }\n\n  _createBackdrop() {\n    /** @type {import('./types.js').Rectangle} */\n    let cropBox = this.$['*cropBox'];\n    if (!cropBox) {\n      return;\n    }\n    let { x, y, width, height } = cropBox;\n    let svg = this.ref['svg-el'];\n\n    let mask = createSvgNode('mask', { id: 'backdrop-mask' });\n    let maskRectOuter = createSvgNode('rect', {\n      x: 0,\n      y: 0,\n      width: '100%',\n      height: '100%',\n      fill: 'white',\n    });\n    let maskRectInner = createSvgNode('rect', {\n      x,\n      y,\n      width,\n      height,\n      fill: 'black',\n    });\n    mask.appendChild(maskRectOuter);\n    mask.appendChild(maskRectInner);\n\n    let backdropRect = createSvgNode('rect', {\n      x: 0,\n      y: 0,\n      width: '100%',\n      height: '100%',\n      fill: 'var(--color-image-background)',\n      'fill-opacity': 0.85,\n      mask: 'url(#backdrop-mask)',\n    });\n    svg.appendChild(backdropRect);\n    svg.appendChild(mask);\n\n    this._backdropMask = mask;\n    this._backdropMaskInner = maskRectInner;\n  }\n\n  /** Super tricky workaround for the chromium bug See https://bugs.chromium.org/p/chromium/issues/detail?id=330815 */\n  _resizeBackdrop() {\n    if (!this._backdropMask) {\n      return;\n    }\n    this._backdropMask.style.display = 'none';\n    window.requestAnimationFrame(() => {\n      this._backdropMask.style.display = 'block';\n    });\n  }\n\n  _updateBackdrop() {\n    /** @type {import('./types.js').Rectangle} */\n    let cropBox = this.$['*cropBox'];\n    if (!cropBox) {\n      return;\n    }\n    let { x, y, width, height } = cropBox;\n\n    setSvgNodeAttrs(this._backdropMaskInner, { x, y, width, height });\n  }\n\n  _updateFrame() {\n    /** @type {import('./types.js').Rectangle} */\n    let cropBox = this.$['*cropBox'];\n    if (!cropBox) {\n      return;\n    }\n    for (let thumb of Object.values(this._frameThumbs)) {\n      let { direction, pathNode, interactionNode, groupNode } = thumb;\n      let isCenter = direction === '';\n      let isCorner = direction.length === 2;\n\n      if (isCenter) {\n        let { x, y, width, height } = cropBox;\n        let center = [x + width / 2, y + height / 2];\n        setSvgNodeAttrs(interactionNode, {\n          r: Math.min(width, height) / 3,\n          cx: center[0],\n          cy: center[1],\n        });\n      } else {\n        let { d, center } = isCorner ? cornerPath(cropBox, direction) : sidePath(cropBox, direction);\n        setSvgNodeAttrs(interactionNode, { cx: center[0], cy: center[1] });\n        setSvgNodeAttrs(pathNode, { d });\n      }\n\n      let disableThumb = this._shouldThumbBeDisabled(direction);\n      groupNode.setAttribute(\n        'class',\n        classNames('thumb', {\n          'thumb--hidden': disableThumb,\n          'thumb--visible': !disableThumb,\n        })\n      );\n    }\n\n    let frameGuides = this._frameGuides;\n    setSvgNodeAttrs(frameGuides, {\n      x: cropBox.x - GUIDE_STROKE_WIDTH * 0.5,\n      y: cropBox.y - GUIDE_STROKE_WIDTH * 0.5,\n      width: cropBox.width + GUIDE_STROKE_WIDTH,\n      height: cropBox.height + GUIDE_STROKE_WIDTH,\n    });\n  }\n\n  _createThumbs() {\n    let frameThumbs = {};\n\n    for (let i = 0; i < 3; i++) {\n      for (let j = 0; j < 3; j++) {\n        let direction = `${['n', '', 's'][i]}${['w', '', 'e'][j]}`;\n        let groupNode = createSvgNode('g');\n        groupNode.classList.add('thumb');\n        groupNode.setAttribute('with-effects', '');\n        let interactionNode = createSvgNode('circle', {\n          r: THUMB_CORNER_SIZE + THUMB_OFFSET,\n          fill: 'transparent',\n        });\n        let pathNode = createSvgNode('path', {\n          stroke: 'currentColor',\n          fill: 'none',\n          'stroke-width': THUMB_STROKE_WIDTH,\n        });\n        groupNode.appendChild(pathNode);\n        groupNode.appendChild(interactionNode);\n        frameThumbs[direction] = {\n          direction,\n          pathNode,\n          interactionNode,\n          groupNode,\n        };\n\n        interactionNode.addEventListener('pointerdown', this._handlePointerDown.bind(this, direction));\n      }\n    }\n\n    return frameThumbs;\n  }\n\n  _createGuides() {\n    let svg = createSvgNode('svg');\n\n    let rect = createSvgNode('rect', {\n      x: 0,\n      y: 0,\n      width: '100%',\n      height: '100%',\n      fill: 'none',\n      stroke: '#000000',\n      'stroke-width': GUIDE_STROKE_WIDTH,\n      'stroke-opacity': 0.5,\n    });\n    svg.appendChild(rect);\n\n    for (let i = 1; i <= 2; i++) {\n      let line = createSvgNode('line', {\n        x1: `${GUIDE_THIRD * i}%`,\n        y1: `0%`,\n        x2: `${GUIDE_THIRD * i}%`,\n        y2: `100%`,\n        stroke: '#000000',\n        'stroke-width': GUIDE_STROKE_WIDTH,\n        'stroke-opacity': 0.3,\n      });\n      svg.appendChild(line);\n    }\n\n    for (let i = 1; i <= 2; i++) {\n      let line = createSvgNode('line', {\n        x1: `0%`,\n        y1: `${GUIDE_THIRD * i}%`,\n        x2: `100%`,\n        y2: `${GUIDE_THIRD * i}%`,\n        stroke: '#000000',\n        'stroke-width': GUIDE_STROKE_WIDTH,\n        'stroke-opacity': 0.3,\n      });\n      svg.appendChild(line);\n    }\n\n    svg.classList.add('guides', 'guides--semi-hidden');\n\n    return svg;\n  }\n\n  _createFrame() {\n    let svg = this.ref['svg-el'];\n    let fr = document.createDocumentFragment();\n\n    let frameGuides = this._createGuides();\n    fr.appendChild(frameGuides);\n\n    let frameThumbs = this._createThumbs();\n    for (let { groupNode } of Object.values(frameThumbs)) {\n      fr.appendChild(groupNode);\n    }\n\n    svg.appendChild(fr);\n    this._frameThumbs = frameThumbs;\n    this._frameGuides = frameGuides;\n  }\n\n  _handlePointerDown(direction, e) {\n    let thumb = this._frameThumbs[direction];\n    if (this._shouldThumbBeDisabled(direction)) {\n      return;\n    }\n\n    let cropBox = this.$['*cropBox'];\n    let { x: svgX, y: svgY } = this.ref['svg-el'].getBoundingClientRect();\n    let x = e.x - svgX;\n    let y = e.y - svgY;\n\n    this.$.dragging = true;\n    this._draggingThumb = thumb;\n    this._dragStartPoint = [x, y];\n    /** @type {import('./types.js').Rectangle} */\n    this._dragStartCrop = { ...cropBox };\n  }\n\n  _handlePointerUp_(e) {\n    this._updateCursor();\n\n    if (!this.$.dragging) {\n      return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n\n    this.$.dragging = false;\n  }\n\n  _handlePointerMove_(e) {\n    if (!this.$.dragging) {\n      return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n\n    let svg = this.ref['svg-el'];\n    let { x: svgX, y: svgY } = svg.getBoundingClientRect();\n    let x = e.x - svgX;\n    let y = e.y - svgY;\n    let dx = x - this._dragStartPoint[0];\n    let dy = y - this._dragStartPoint[1];\n    let { direction } = this._draggingThumb;\n\n    /** @type {import('./types.js').Rectangle} */\n    let imageBox = this.$['*imageBox'];\n    let rect = this._dragStartCrop;\n\n    if (direction === '') {\n      rect = moveRect(rect, [dx, dy]);\n      rect = constraintRect(rect, imageBox);\n    } else {\n      rect = expandRect(rect, [dx, dy], direction);\n      rect = intersectionRect(rect, imageBox);\n    }\n    /** @type {[Number, Number]} */\n    let minCropRect = [Math.min(imageBox.width, MIN_CROP_SIZE), Math.min(imageBox.height, MIN_CROP_SIZE)];\n    rect = minRectSize(rect, minCropRect, direction);\n\n    if (!Object.values(rect).every((number) => Number.isFinite(number) && number >= 0)) {\n      console.error('CropFrame is trying to create invalid rectangle', {\n        payload: rect,\n      });\n      return;\n    }\n    this.$['*cropBox'] = rect;\n  }\n\n  _handleSvgPointerMove_(e) {\n    let hoverThumb = Object.values(this._frameThumbs).find((thumb) => {\n      if (this._shouldThumbBeDisabled(thumb.direction)) {\n        return false;\n      }\n      let node = thumb.groupNode;\n      let bounds = node.getBoundingClientRect();\n      let rect = {\n        x: bounds.x,\n        y: bounds.y,\n        width: bounds.width,\n        height: bounds.height,\n      };\n      let hover = rectContainsPoint(rect, [e.x, e.y]);\n      return hover;\n    });\n\n    this._hoverThumb = hoverThumb;\n    this._updateCursor();\n  }\n\n  _updateCursor() {\n    let hoverThumb = this._hoverThumb;\n    this.ref['svg-el'].style.cursor = hoverThumb ? thumbCursor(hoverThumb.direction) : 'initial';\n  }\n\n  _render() {\n    this._updateBackdrop();\n    this._updateFrame();\n  }\n\n  toggleThumbs(visible) {\n    Object.values(this._frameThumbs)\n      .map(({ groupNode }) => groupNode)\n      .forEach((groupNode) => {\n        groupNode.setAttribute(\n          'class',\n          classNames('thumb', {\n            'thumb--hidden': !visible,\n            'thumb--visible': visible,\n          })\n        );\n      });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this._createBackdrop();\n    this._createFrame();\n\n    this.sub('*imageBox', () => {\n      this._resizeBackdrop();\n      window.requestAnimationFrame(() => {\n        this._render();\n      });\n    });\n\n    this.sub('*cropBox', (cropBox) => {\n      if (!cropBox) {\n        return;\n      }\n      this._guidesHidden = cropBox.height <= MIN_CROP_SIZE || cropBox.width <= MIN_CROP_SIZE;\n      window.requestAnimationFrame(() => {\n        this._render();\n      });\n    });\n\n    this.sub('dragging', (dragging) => {\n      this._frameGuides.setAttribute(\n        'class',\n        classNames({\n          'guides--hidden': this._guidesHidden,\n          'guides--visible': !this._guidesHidden && dragging,\n          'guides--semi-hidden': !this._guidesHidden && !dragging,\n        })\n      );\n    });\n\n    this.ref['svg-el'].addEventListener('pointermove', this._handleSvgPointerMove, true);\n    document.addEventListener('pointermove', this._handlePointerMove, true);\n    document.addEventListener('pointerup', this._handlePointerUp, true);\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    document.removeEventListener('pointermove', this._handlePointerMove);\n    document.removeEventListener('pointerup', this._handlePointerUp);\n  }\n}\n\nCropFrame.template = /* HTML */ ` <svg class=\"svg\" ref=\"svg-el\" xmlns=\"http://www.w3.org/2000/svg\"></svg> `;\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport { classNames } from './lib/classNames.js';\n\nexport class EditorButtonControl extends CloudImageEditorBase {\n  init$ = {\n    ...this.init$,\n    active: false,\n    title: '',\n    icon: '',\n    'on.click': null,\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    this._titleEl = this.ref['title-el'];\n    this._iconEl = this.ref['icon-el'];\n\n    this.setAttribute('role', 'button');\n    if (this.tabIndex === -1) {\n      this.tabIndex = 0;\n    }\n\n    this.sub('title', (title) => {\n      let titleEl = this._titleEl;\n      if (titleEl) {\n        this._titleEl.style.display = title ? 'block' : 'none';\n      }\n    });\n\n    this.sub('active', (active) => {\n      this.className = classNames({\n        active: active,\n        not_active: !active,\n      });\n    });\n\n    this.sub('on.click', (onClick) => {\n      this.onclick = onClick;\n    });\n  }\n}\n\nEditorButtonControl.template = /* HTML */ `\n  <div class=\"before\"></div>\n  <lr-icon size=\"20\" set=\"@name: icon;\"></lr-icon>\n  <div class=\"title\" ref=\"title-el\">{{title}}</div>\n`;\n","import { EditorButtonControl } from './EditorButtonControl.js';\n\nfunction nextAngle(prev) {\n  let angle = prev + 90;\n  angle = angle >= 360 ? 0 : angle;\n  return angle;\n}\n\nfunction nextValue(operation, prev) {\n  if (operation === 'rotate') {\n    return nextAngle(prev);\n  }\n  if (['mirror', 'flip'].includes(operation)) {\n    return !prev;\n  }\n  return null;\n}\n\nexport class EditorCropButtonControl extends EditorButtonControl {\n  initCallback() {\n    super.initCallback();\n\n    this.defineAccessor('operation', (operation) => {\n      if (!operation) {\n        return;\n      }\n\n      /** @private */\n      this._operation = operation;\n      this.$['icon'] = operation;\n    });\n\n    this.$['on.click'] = (e) => {\n      let prev = this.$['*cropperEl'].getValue(this._operation);\n      let next = nextValue(this._operation, prev);\n      this.$['*cropperEl'].setValue(this._operation, next);\n    };\n  }\n}\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport { COLOR_OPERATIONS_CONFIG } from './toolbar-constants.js';\n\nconst ControlType = {\n  FILTER: 'filter',\n  COLOR_OPERATION: 'color_operation',\n};\n\nexport const FAKE_ORIGINAL_FILTER = 'original';\n\nexport class EditorSlider extends CloudImageEditorBase {\n  init$ = {\n    ...this.init$,\n    disabled: false,\n    min: 0,\n    max: 100,\n    value: 0,\n    defaultValue: 0,\n    zero: 0,\n    'on.input': (value) => {\n      this.$['*faderEl'].set(value);\n      this.$.value = value;\n    },\n  };\n\n  /**\n   * @param {String} operation\n   * @param {String} [filter]\n   */\n  setOperation(operation, filter) {\n    this._controlType = operation === 'filter' ? ControlType.FILTER : ControlType.COLOR_OPERATION;\n    this._operation = operation;\n    this._iconName = operation;\n    this._title = operation.toUpperCase();\n    this._filter = filter;\n\n    this._initializeValues();\n\n    this.$['*faderEl'].activate({\n      url: this.$['*originalUrl'],\n      operation: this._operation,\n      value: this._filter === FAKE_ORIGINAL_FILTER ? undefined : this.$.value,\n      filter: this._filter === FAKE_ORIGINAL_FILTER ? undefined : this._filter,\n      fromViewer: false,\n    });\n  }\n\n  /** @private */\n  _initializeValues() {\n    let { range, zero } = COLOR_OPERATIONS_CONFIG[this._operation];\n    let [min, max] = range;\n\n    this.$.min = min;\n    this.$.max = max;\n    this.$.zero = zero;\n\n    let transformation = this.$['*editorTransformations'][this._operation];\n    if (this._controlType === ControlType.FILTER) {\n      let value = max;\n      if (transformation) {\n        let { name, amount } = transformation;\n        value = name === this._filter ? amount : max;\n      }\n      this.$.value = value;\n      this.$.defaultValue = value;\n    }\n    if (this._controlType === ControlType.COLOR_OPERATION) {\n      let value = typeof transformation !== 'undefined' ? transformation : zero;\n      this.$.value = value;\n      this.$.defaultValue = value;\n    }\n  }\n\n  apply() {\n    let operationValue;\n    if (this._controlType === ControlType.FILTER) {\n      if (this._filter === FAKE_ORIGINAL_FILTER) {\n        operationValue = null;\n      } else {\n        operationValue = { name: this._filter, amount: this.$.value };\n      }\n    } else {\n      operationValue = this.$.value;\n    }\n\n    /** @type {import('./types.js').Transformations} */\n    let transformations = {\n      ...this.$['*editorTransformations'],\n      [this._operation]: operationValue,\n    };\n\n    this.$['*editorTransformations'] = transformations;\n  }\n\n  cancel() {\n    this.$['*faderEl'].deactivate({ hide: false });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('*originalUrl', (originalUrl) => {\n      this._originalUrl = originalUrl;\n    });\n\n    this.sub('value', (value) => {\n      let tooltip = `${this._filter || this._operation} ${value}`;\n      this.$['*operationTooltip'] = tooltip;\n    });\n  }\n}\n\nEditorSlider.template = /* HTML */ `\n  <lr-slider-ui\n    ref=\"slider-el\"\n    set=\"disabled: disabled; min: min; max: max; defaultValue: defaultValue; zero: zero; onInput: on.input;\"\n  ></lr-slider-ui>\n`;\n","import { TRANSPARENT_PIXEL_SRC } from '../../../../utils/transparentPixelSrc.js';\n\nexport function preloadImage(src) {\n  let image = new Image();\n\n  let promise = new Promise((resolve, reject) => {\n    image.src = src;\n    image.onload = resolve;\n    image.onerror = reject;\n  });\n\n  let cancel = () => {\n    if (image.naturalWidth === 0) {\n      image.src = TRANSPARENT_PIXEL_SRC;\n    }\n  };\n\n  return { promise, image, cancel };\n}\n\nexport function batchPreloadImages(list) {\n  let preloaders = [];\n\n  for (let src of list) {\n    let preload = preloadImage(src);\n    preloaders.push(preload);\n  }\n\n  let images = preloaders.map((preload) => preload.image);\n  let promise = Promise.allSettled(preloaders.map((preload) => preload.promise));\n  let cancel = () => {\n    preloaders.forEach((preload) => {\n      preload.cancel();\n    });\n  };\n\n  return { promise, images, cancel };\n}\n","import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { EditorButtonControl } from './EditorButtonControl.js';\nimport { FAKE_ORIGINAL_FILTER } from './EditorSlider.js';\nimport { COMMON_OPERATIONS, transformationsToOperations } from './lib/transformationUtils.js';\nimport { preloadImage } from './lib/preloadImage.js';\n\nexport class EditorFilterControl extends EditorButtonControl {\n  init$ = {\n    ...this.init$,\n    active: false,\n    title: '',\n    icon: '',\n    isOriginal: false,\n    iconSize: '20',\n    'on.click': null,\n  };\n\n  _previewSrc() {\n    let previewSize = parseInt(window.getComputedStyle(this).getPropertyValue('--l-base-min-width'), 10);\n    let dpr = window.devicePixelRatio;\n    let size = Math.ceil(dpr * previewSize);\n    let quality = dpr >= 2 ? 'lightest' : 'normal';\n    let filterValue = 100;\n\n    /** @type {import('./types.js').Transformations} */\n    let transformations = { ...this.$['*editorTransformations'] };\n    transformations[this._operation] =\n      this._filter !== FAKE_ORIGINAL_FILTER\n        ? {\n            name: this._filter,\n            amount: filterValue,\n          }\n        : undefined;\n\n    return createCdnUrl(\n      this._originalUrl,\n      createCdnUrlModifiers(\n        COMMON_OPERATIONS,\n        transformationsToOperations(transformations),\n        `quality/${quality}`,\n        `scale_crop/${size}x${size}/center`\n      )\n    );\n  }\n\n  /**\n   * @param {IntersectionObserverEntry[]} entries\n   * @param {IntersectionObserver} observer\n   */\n  _observerCallback(entries, observer) {\n    let intersectionEntry = entries[0];\n    if (intersectionEntry.isIntersecting) {\n      let src = this.proxyUrl(this._previewSrc());\n      let previewEl = this.ref['preview-el'];\n      let { promise, cancel } = preloadImage(src);\n      this._cancelPreload = cancel;\n      promise\n        .catch((err) => {\n          this.$['*networkProblems'] = true;\n          console.error('Failed to load image', { error: err });\n        })\n        .finally(() => {\n          previewEl.style.backgroundImage = `url(${src})`;\n          previewEl.setAttribute('loaded', '');\n\n          observer.unobserve(this);\n        });\n    } else {\n      this._cancelPreload && this._cancelPreload();\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['on.click'] = (e) => {\n      if (!this.$.active) {\n        this.$['*sliderEl'].setOperation(this._operation, this._filter);\n        this.$['*sliderEl'].apply();\n      } else if (!this.$.isOriginal) {\n        this.$['*sliderEl'].setOperation(this._operation, this._filter);\n        this.$['*showSlider'] = true;\n      }\n\n      this.$['*currentFilter'] = this._filter;\n    };\n\n    this.defineAccessor('filter', (filter) => {\n      this._operation = 'filter';\n      this._filter = filter;\n      this.$.isOriginal = filter === FAKE_ORIGINAL_FILTER;\n      this.$.icon = this.$.isOriginal ? 'original' : 'slider';\n    });\n\n    this._observer = new window.IntersectionObserver(this._observerCallback.bind(this), {\n      threshold: [0, 1],\n    });\n\n    let originalUrl = this.$['*originalUrl'];\n    this._originalUrl = originalUrl;\n\n    if (this.$.isOriginal) {\n      this.ref['icon-el'].classList.add('original-icon');\n    } else {\n      this._observer.observe(this);\n    }\n\n    this.sub('*currentFilter', (currentFilter) => {\n      this.$.active = currentFilter && currentFilter === this._filter;\n    });\n\n    this.sub('isOriginal', (isOriginal) => {\n      this.$.iconSize = isOriginal ? 40 : 20;\n    });\n\n    this.sub('active', (active) => {\n      if (this.$.isOriginal) {\n        return;\n      }\n      let iconEl = this.ref['icon-el'];\n      iconEl.style.opacity = active ? '1' : '0';\n\n      let previewEl = this.ref['preview-el'];\n      if (active) {\n        previewEl.style.opacity = '0';\n      } else if (previewEl.style.backgroundImage) {\n        previewEl.style.opacity = '1';\n      }\n    });\n\n    this.sub('*networkProblems', (networkProblems) => {\n      if (!networkProblems) {\n        let src = this.proxyUrl(this._previewSrc());\n        let previewEl = this.ref['preview-el'];\n        if (previewEl.style.backgroundImage) {\n          previewEl.style.backgroundImage = 'none';\n          previewEl.style.backgroundImage = `url(${src})`;\n        }\n      }\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this._observer?.disconnect();\n    this._cancelPreload && this._cancelPreload();\n  }\n}\n\nEditorFilterControl.template = /* HTML */ `\n  <div class=\"before\"></div>\n  <div class=\"preview\" ref=\"preview-el\"></div>\n  <lr-icon size=\"40\" ref=\"icon-el\" set=\"@name: icon; @size: iconSize;\"></lr-icon>\n`;\n","import { EditorButtonControl } from './EditorButtonControl.js';\nimport { COLOR_OPERATIONS_CONFIG } from './toolbar-constants.js';\n\nexport class EditorOperationControl extends EditorButtonControl {\n  /**\n   * @private\n   * @type {String}\n   */\n  _operation = '';\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['on.click'] = (e) => {\n      this.$['*sliderEl'].setOperation(this._operation);\n      this.$['*showSlider'] = true;\n      this.$['*currentOperation'] = this._operation;\n    };\n\n    this.defineAccessor('operation', (operation) => {\n      if (operation) {\n        this._operation = operation;\n        this.$['icon'] = operation;\n        this.$.title = this.l10n(operation);\n      }\n    });\n\n    this.sub('*editorTransformations', (editorTransformations) => {\n      if (!this._operation) {\n        return;\n      }\n\n      let { zero } = COLOR_OPERATIONS_CONFIG[this._operation];\n      let value = editorTransformations[this._operation];\n      let isActive = typeof value !== 'undefined' ? value !== zero : false;\n      this.$.active = isActive;\n    });\n  }\n}\n","import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { COMMON_OPERATIONS, transformationsToOperations } from './lib/transformationUtils.js';\n\nexport function viewerImageSrc(originalUrl, width, transformations) {\n  const MAX_CDN_DIMENSION = 3000;\n  let dpr = window.devicePixelRatio;\n  let size = Math.min(Math.ceil(width * dpr), MAX_CDN_DIMENSION);\n  let quality = dpr >= 2 ? 'lightest' : 'normal';\n\n  return createCdnUrl(\n    originalUrl,\n    createCdnUrlModifiers(\n      COMMON_OPERATIONS,\n      transformationsToOperations(transformations),\n      `quality/${quality}`,\n      `stretch/off/-/resize/${size}x`\n    )\n  );\n}\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport { constraintRect, minRectSize } from './crop-utils.js';\nimport { CROP_PADDING, MIN_CROP_SIZE } from './cropper-constants.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { pick } from './lib/pick.js';\nimport { preloadImage } from './lib/preloadImage.js';\nimport { viewerImageSrc } from './util.js';\n\n/**\n * @typedef {Object} Operations\n * @property {boolean} flip\n * @property {boolean} mirror\n * @property {Number} rotate\n */\n\n/**\n * @param {Number} value\n * @param {Number} min\n * @param {Number} max\n * @returns {Number}\n */\nfunction clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n/**\n * @param {import('./types.js').ImageSize} imageSize\n * @param {Number} angle\n * @returns {import('./types.js').ImageSize}\n */\nfunction rotateSize({ width, height }, angle) {\n  let swap = (angle / 90) % 2 !== 0;\n  return { width: swap ? height : width, height: swap ? width : height };\n}\n\n/**\n * @param {import('./types.js').Transformations['crop']} crop\n * @returns {boolean}\n */\nfunction validateCrop(crop) {\n  if (!crop) {\n    return true;\n  }\n  /** @type {((arg: typeof crop) => boolean)[]} */\n  let shouldMatch = [\n    ({ dimensions, coords }) =>\n      [...dimensions, ...coords].every((number) => Number.isInteger(number) && Number.isFinite(number)),\n    ({ dimensions, coords }) => dimensions.every((d) => d > 0) && coords.every((c) => c >= 0),\n  ];\n  return shouldMatch.every((matcher) => matcher(crop));\n}\n\nexport class EditorImageCropper extends CloudImageEditorBase {\n  init$ = {\n    ...this.init$,\n    image: null,\n    '*padding': CROP_PADDING,\n    /** @type {Operations} */\n    '*operations': {\n      rotate: 0,\n      mirror: false,\n      flip: false,\n    },\n    /** @type {import('./types.js').Rectangle} */\n    '*imageBox': {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0,\n    },\n    /** @type {import('./types.js').Rectangle} */\n    '*cropBox': {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0,\n    },\n  };\n\n  constructor() {\n    super();\n\n    /** @private */\n    this._commitDebounced = debounce(this._commit.bind(this), 300);\n\n    /** @private */\n    this._handleResizeDebounced = debounce(this._handleResize.bind(this), 10);\n  }\n\n  /** @private */\n  _handleResize() {\n    if (!this.isConnected) {\n      return;\n    }\n    this.deactivate();\n    this.activate(this._imageSize, { fromViewer: false });\n  }\n\n  /** @private */\n  _syncTransformations() {\n    let transformations = this.$['*editorTransformations'];\n    let pickedTransformations = pick(transformations, Object.keys(this.$['*operations']));\n    let operations = { ...this.$['*operations'], ...pickedTransformations };\n    this.$['*operations'] = operations;\n  }\n\n  /** @private */\n  _initCanvas() {\n    /** @type {HTMLCanvasElement} */\n    let canvas = this.ref['canvas-el'];\n    let ctx = canvas.getContext('2d');\n\n    let width = this.offsetWidth;\n    let height = this.offsetHeight;\n    let dpr = window.devicePixelRatio;\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    canvas.width = width * dpr;\n    canvas.height = height * dpr;\n    ctx.scale(dpr, dpr);\n\n    this._canvas = canvas;\n    this._ctx = ctx;\n  }\n\n  /** @private */\n  _alignImage() {\n    if (!this._isActive || !this.$.image) {\n      return;\n    }\n\n    let image = this.$.image;\n    let padding = this.$['*padding'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n\n    let bounds = { width: this.offsetWidth, height: this.offsetHeight };\n    let naturalSize = rotateSize({ width: image.naturalWidth, height: image.naturalHeight }, rotate);\n\n    if (naturalSize.width > bounds.width - padding * 2 || naturalSize.height > bounds.height - padding * 2) {\n      let imageAspectRatio = naturalSize.width / naturalSize.height;\n      let viewportAspectRatio = bounds.width / bounds.height;\n\n      if (imageAspectRatio > viewportAspectRatio) {\n        let width = bounds.width - padding * 2;\n        let height = width / imageAspectRatio;\n        let x = 0 + padding;\n        let y = padding + (bounds.height - padding * 2) / 2 - height / 2;\n        this.$['*imageBox'] = { x, y, width, height };\n      } else {\n        let height = bounds.height - padding * 2;\n        let width = height * imageAspectRatio;\n        let x = padding + (bounds.width - padding * 2) / 2 - width / 2;\n        let y = 0 + padding;\n        this.$['*imageBox'] = { x, y, width, height };\n      }\n    } else {\n      let { width, height } = naturalSize;\n      let x = padding + (bounds.width - padding * 2) / 2 - width / 2;\n      let y = padding + (bounds.height - padding * 2) / 2 - height / 2;\n      this.$['*imageBox'] = { x, y, width, height };\n    }\n  }\n\n  /** @private */\n  _alignCrop() {\n    let cropBox = this.$['*cropBox'];\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n    let transformation = this.$['*editorTransformations']['crop'];\n\n    if (transformation) {\n      let {\n        dimensions: [width, height],\n        coords: [x, y],\n      } = transformation;\n      let { width: previewWidth, x: previewX, y: previewY } = this.$['*imageBox'];\n      let { width: sourceWidth } = rotateSize(this._imageSize, rotate);\n      let ratio = previewWidth / sourceWidth;\n      cropBox = {\n        x: previewX + x * ratio,\n        y: previewY + y * ratio,\n        width: width * ratio,\n        height: height * ratio,\n      };\n    } else {\n      cropBox = {\n        x: imageBox.x,\n        y: imageBox.y,\n        width: imageBox.width,\n        height: imageBox.height,\n      };\n    }\n    /** @type {[Number, Number]} */\n    let minCropRect = [Math.min(imageBox.width, MIN_CROP_SIZE), Math.min(imageBox.height, MIN_CROP_SIZE)];\n    cropBox = minRectSize(cropBox, minCropRect, 'se');\n    cropBox = constraintRect(cropBox, imageBox);\n\n    this.$['*cropBox'] = cropBox;\n  }\n\n  /** @private */\n  _drawImage() {\n    let image = this.$.image;\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { mirror, flip, rotate } = operations;\n    let ctx = this._ctx;\n    let rotated = rotateSize({ width: imageBox.width, height: imageBox.height }, rotate);\n    ctx.save();\n    ctx.translate(imageBox.x + imageBox.width / 2, imageBox.y + imageBox.height / 2);\n    ctx.rotate((rotate * Math.PI * -1) / 180);\n    ctx.scale(mirror ? -1 : 1, flip ? -1 : 1);\n    ctx.drawImage(image, -rotated.width / 2, -rotated.height / 2, rotated.width, rotated.height);\n    ctx.restore();\n  }\n\n  /** @private */\n  _draw() {\n    if (!this._isActive || !this.$.image) {\n      return;\n    }\n    let canvas = this._canvas;\n    let ctx = this._ctx;\n\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    this._drawImage();\n  }\n\n  /** @private */\n  _animateIn({ fromViewer }) {\n    if (this.$.image) {\n      this.ref['frame-el'].toggleThumbs(true);\n      this._transitionToImage();\n      setTimeout(() => {\n        this.className = classNames({\n          active_from_viewer: fromViewer,\n          active_from_editor: !fromViewer,\n          inactive_to_editor: false,\n        });\n      });\n    }\n  }\n\n  /**\n   * @private\n   * @returns {import('./types.js').Transformations['crop']['dimensions']}\n   */\n  _calculateDimensions() {\n    let cropBox = this.$['*cropBox'];\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n    let { width: previewWidth, height: previewHeight } = imageBox;\n    let { width: sourceWidth, height: sourceHeight } = rotateSize(this._imageSize, rotate);\n    let { width: cropWidth, height: cropHeight } = cropBox;\n    let ratioW = previewWidth / sourceWidth;\n    let ratioH = previewHeight / sourceHeight;\n\n    /** @type {[Number, Number]} */\n    let dimensions = [\n      clamp(Math.round(cropWidth / ratioW), 1, sourceWidth),\n      clamp(Math.round(cropHeight / ratioH), 1, sourceHeight),\n    ];\n\n    return dimensions;\n  }\n\n  /**\n   * @private\n   * @returns {import('./types.js').Transformations['crop']}\n   */\n  _calculateCrop() {\n    let cropBox = this.$['*cropBox'];\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n    let { width: previewWidth, height: previewHeight, x: previewX, y: previewY } = imageBox;\n    let { width: sourceWidth, height: sourceHeight } = rotateSize(this._imageSize, rotate);\n    let { x: cropX, y: cropY } = cropBox;\n    let ratioW = previewWidth / sourceWidth;\n    let ratioH = previewHeight / sourceHeight;\n\n    let dimensions = this._calculateDimensions();\n    let crop = {\n      dimensions,\n      coords: /** @type {[Number, Number]} */ ([\n        clamp(Math.round((cropX - previewX) / ratioW), 0, sourceWidth - dimensions[0]),\n        clamp(Math.round((cropY - previewY) / ratioH), 0, sourceHeight - dimensions[1]),\n      ]),\n    };\n    if (!validateCrop(crop)) {\n      console.error('Cropper is trying to create invalid crop object', {\n        payload: crop,\n      });\n      return undefined;\n    }\n    if (dimensions[0] === sourceWidth && dimensions[1] === sourceHeight) {\n      return undefined;\n    }\n\n    return crop;\n  }\n\n  /** @private */\n  _commit() {\n    if (!this.isConnected) {\n      return;\n    }\n    let operations = this.$['*operations'];\n    let { rotate, mirror, flip } = operations;\n    let crop = this._calculateCrop();\n    /** @type {import('./types.js').Transformations} */\n    let editorTransformations = this.$['*editorTransformations'];\n    let transformations = {\n      ...editorTransformations,\n      crop,\n      rotate,\n      mirror,\n      flip,\n    };\n\n    this.$['*editorTransformations'] = transformations;\n  }\n\n  /**\n   * @param {String} operation\n   * @param {Number} value\n   * @returns {void}\n   */\n  setValue(operation, value) {\n    console.log(`Apply cropper operation [${operation}=${value}]`);\n    this.$['*operations'] = {\n      ...this.$['*operations'],\n      [operation]: value,\n    };\n\n    if (!this._isActive) {\n      return;\n    }\n\n    this._alignImage();\n    this._alignCrop();\n    this._draw();\n  }\n\n  /**\n   * @param {keyof Operations} operation\n   * @returns {Number | boolean}\n   */\n  getValue(operation) {\n    return this.$['*operations'][operation];\n  }\n\n  /**\n   * @param {import('./types.js').ImageSize} imageSize\n   * @param {{ fromViewer?: boolean }} options\n   */\n  async activate(imageSize, { fromViewer }) {\n    if (this._isActive) {\n      return;\n    }\n    this._isActive = true;\n    this._imageSize = imageSize;\n    this.removeEventListener('transitionend', this._reset);\n    this._initCanvas();\n\n    try {\n      this.$.image = await this._waitForImage(this.$['*originalUrl'], this.$['*editorTransformations']);\n      this._syncTransformations();\n      this._alignImage();\n      this._alignCrop();\n      this._draw();\n      this._animateIn({ fromViewer });\n    } catch (err) {\n      console.error('Failed to activate cropper', { error: err });\n    }\n  }\n  deactivate() {\n    if (!this._isActive) {\n      return;\n    }\n    this._commit();\n    this._isActive = false;\n\n    this._transitionToCrop();\n\n    this.className = classNames({\n      active_from_viewer: false,\n      active_from_editor: false,\n      inactive_to_editor: true,\n    });\n\n    this.ref['frame-el'].toggleThumbs(false);\n    this.addEventListener('transitionend', this._reset, { once: true });\n  }\n\n  /** @private */\n  _transitionToCrop() {\n    let dimensions = this._calculateDimensions();\n    let scaleX = Math.min(this.offsetWidth, dimensions[0]) / this.$['*cropBox'].width;\n    let scaleY = Math.min(this.offsetHeight, dimensions[1]) / this.$['*cropBox'].height;\n    let scale = Math.min(scaleX, scaleY);\n    let cropCenterX = this.$['*cropBox'].x + this.$['*cropBox'].width / 2;\n    let cropCenterY = this.$['*cropBox'].y + this.$['*cropBox'].height / 2;\n\n    this.style.transform = `scale(${scale}) translate(${(this.offsetWidth / 2 - cropCenterX) / scale}px, ${\n      (this.offsetHeight / 2 - cropCenterY) / scale\n    }px)`;\n    this.style.transformOrigin = `${cropCenterX}px ${cropCenterY}px`;\n  }\n\n  /** @private */\n  _transitionToImage() {\n    let cropCenterX = this.$['*cropBox'].x + this.$['*cropBox'].width / 2;\n    let cropCenterY = this.$['*cropBox'].y + this.$['*cropBox'].height / 2;\n\n    this.style.transform = `scale(1)`;\n    this.style.transformOrigin = `${cropCenterX}px ${cropCenterY}px`;\n  }\n\n  /** @private */\n  _reset() {\n    if (this._isActive) {\n      return;\n    }\n    this.$.image = null;\n  }\n\n  /**\n   * @private\n   * @param {String} originalUrl\n   * @param {import('./types.js').Transformations} transformations\n   * @returns {Promise<HTMLImageElement>}\n   */\n  _waitForImage(originalUrl, transformations) {\n    let width = this.offsetWidth;\n    transformations = {\n      ...transformations,\n      crop: undefined,\n      rotate: undefined,\n      flip: undefined,\n      mirror: undefined,\n    };\n    let src = this.proxyUrl(viewerImageSrc(originalUrl, width, transformations));\n    let { promise, cancel, image } = preloadImage(src);\n\n    let stop = this._handleImageLoading(src);\n    image.addEventListener('load', stop, { once: true });\n    image.addEventListener('error', stop, { once: true });\n    this._cancelPreload && this._cancelPreload();\n    this._cancelPreload = cancel;\n\n    return promise\n      .then(() => image)\n      .catch((err) => {\n        console.error('Failed to load image', { error: err });\n        this.$['*networkProblems'] = true;\n        return Promise.resolve(image);\n      });\n  }\n\n  /**\n   * @private\n   * @param {String} src\n   * @returns {() => void} Destructor\n   */\n  _handleImageLoading(src) {\n    let operation = 'crop';\n    let loadingOperations = this.$['*loadingOperations'];\n    if (!loadingOperations.get(operation)) {\n      loadingOperations.set(operation, new Map());\n    }\n\n    if (!loadingOperations.get(operation).get(src)) {\n      loadingOperations.set(operation, loadingOperations.get(operation).set(src, true));\n      this.$['*loadingOperations'] = loadingOperations;\n    }\n\n    return () => {\n      if (loadingOperations?.get(operation)?.has(src)) {\n        loadingOperations.get(operation).delete(src);\n        this.$['*loadingOperations'] = loadingOperations;\n      }\n    };\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this._observer = new ResizeObserver(([entry]) => {\n      const nonZeroSize = entry.contentRect.width > 0 && entry.contentRect.height > 0;\n      if (nonZeroSize && this._isActive && this.$.image) {\n        this._handleResizeDebounced();\n      }\n    });\n    this._observer.observe(this);\n\n    this.sub('*imageBox', () => {\n      this._draw();\n    });\n\n    this.sub('*cropBox', (cropBox) => {\n      if (this.$.image) {\n        this._commitDebounced();\n      }\n    });\n\n    setTimeout(() => {\n      this.sub('*networkProblems', (networkProblems) => {\n        if (!networkProblems) {\n          this._isActive && this.activate(this._imageSize, { fromViewer: false });\n        }\n      });\n    }, 0);\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this._observer?.disconnect();\n  }\n}\n\nEditorImageCropper.template = /* HTML */ `\n  <canvas class=\"canvas\" ref=\"canvas-el\"></canvas>\n  <lr-crop-frame ref=\"frame-el\"></lr-crop-frame>\n`;\n","/**\n * @param {{}} obj\n * @param {String[]} keys\n * @returns {{}}\n */\nexport function pick(obj, keys) {\n  let result = {};\n  for (let key of keys) {\n    let value = obj[key];\n    if (obj.hasOwnProperty(key) || value !== undefined) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n","/**\n * @param {Number} a Start of sample (int)\n * @param {Number} b End of sample (int)\n * @param {Number} n Number of elements (int)\n * @returns {Number[]}\n */\nexport function linspace(a, b, n) {\n  let ret = Array(n);\n  n--;\n  for (let i = n; i >= 0; i--) {\n    ret[i] = Math.ceil((i * b + (n - i) * a) / n);\n  }\n  return ret;\n}\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { linspace } from './lib/linspace.js';\nimport { batchPreloadImages } from './lib/preloadImage.js';\nimport { COLOR_OPERATIONS_CONFIG } from './toolbar-constants.js';\nimport { viewerImageSrc } from './util.js';\n\n/**\n * @param {Number[]} numbers\n * @returns {[Number, Number][]}\n */\nfunction splitBySections(numbers) {\n  return numbers.reduce(\n    (acc, point, idx) => (idx < numbers.length - 1 ? [...acc, [point, numbers[idx + 1]]] : acc),\n    []\n  );\n}\n\n/**\n * @param {Number[]} keypoints\n * @param {Number} value\n * @param {Number} zero\n */\nfunction calculateOpacities(keypoints, value, zero) {\n  let section = splitBySections(keypoints).find(([left, right]) => left <= value && value <= right);\n  return keypoints.map((point) => {\n    let distance = Math.abs(section[0] - section[1]);\n    let relation = Math.abs(value - section[0]) / distance;\n\n    if (section[0] === point) {\n      return value > zero ? 1 : 1 - relation;\n    }\n    if (section[1] === point) {\n      return value >= zero ? relation : 1;\n    }\n    return 0;\n  });\n}\n\n/**\n * @param {Number[]} keypoints\n * @param {Number} zero\n */\nfunction calculateZIndices(keypoints, zero) {\n  return keypoints.map((point, idx) => (point < zero ? keypoints.length - idx : idx));\n}\n\n/**\n * @param {String} operation\n * @param {Number} value\n * @returns {Number[]}\n */\nfunction keypointsRange(operation, value) {\n  let n = COLOR_OPERATIONS_CONFIG[operation].keypointsNumber;\n  let { range, zero } = COLOR_OPERATIONS_CONFIG[operation];\n\n  return [...new Set([...linspace(range[0], zero, n + 1), ...linspace(zero, range[1], n + 1), zero, value])].sort(\n    (a, b) => a - b\n  );\n}\n\n/**\n * @typedef {Object} Keypoint\n * @property {String} src\n * @property {Number} opacity\n * @property {Number} zIndex\n * @property {HTMLImageElement} image\n * @property {Number} value\n */\n\nexport class EditorImageFader extends CloudImageEditorBase {\n  constructor() {\n    super();\n\n    /**\n     * @private\n     * @type {Boolean}\n     */\n    this._isActive = false;\n\n    /**\n     * @private\n     * @type {Boolean}\n     */\n    this._hidden = true;\n\n    /** @private */\n    this._addKeypointDebounced = debounce(this._addKeypoint.bind(this), 600);\n\n    this.classList.add('inactive_to_cropper');\n  }\n\n  /**\n   * @private\n   * @param {String} src\n   * @returns {() => void} Destructor\n   */\n  _handleImageLoading(src) {\n    let operation = this._operation;\n\n    let loadingOperations = this.$['*loadingOperations'];\n    if (!loadingOperations.get(operation)) {\n      loadingOperations.set(operation, new Map());\n    }\n\n    if (!loadingOperations.get(operation).get(src)) {\n      loadingOperations.set(operation, loadingOperations.get(operation).set(src, true));\n      this.$['*loadingOperations'] = loadingOperations;\n    }\n\n    return () => {\n      if (loadingOperations?.get(operation)?.has(src)) {\n        loadingOperations.get(operation).delete(src);\n        this.$['*loadingOperations'] = loadingOperations;\n      }\n    };\n  }\n\n  /** @private */\n  _flush() {\n    window.cancelAnimationFrame(this._raf);\n    this._raf = window.requestAnimationFrame(() => {\n      for (let kp of this._keypoints) {\n        let { image } = kp;\n        if (image) {\n          image.style.opacity = kp.opacity.toString();\n          image.style.zIndex = kp.zIndex.toString();\n        }\n      }\n    });\n  }\n\n  /**\n   * @private\n   * @param {Object} options\n   * @param {String} [options.url]\n   * @param {String} [options.filter]\n   * @param {String} [options.operation]\n   * @param {Number} [options.value]\n   * @returns {String}\n   */\n  _imageSrc({ url = this._url, filter = this._filter, operation, value } = {}) {\n    let transformations = { ...this._transformations };\n\n    if (operation) {\n      transformations[operation] = filter ? { name: filter, amount: value } : value;\n    }\n\n    // do not use getBoundingClientRect because scale transform affects it\n    let width = this.offsetWidth;\n    return this.proxyUrl(viewerImageSrc(url, width, transformations));\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   * @param {Number} value\n   * @returns {Keypoint}\n   */\n  _constructKeypoint(operation, value) {\n    let src = this._imageSrc({ operation, value });\n    return {\n      src,\n      image: null,\n      opacity: 0,\n      zIndex: 0,\n      value,\n    };\n  }\n\n  /**\n   * Check if current operation and filter equals passed ones\n   *\n   * @private\n   * @param {String} operation\n   * @param {String} [filter]\n   * @returns {Boolean}\n   */\n  _isSame(operation, filter) {\n    return this._operation === operation && this._filter === filter;\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   * @param {String | null} filter\n   * @param {Number} value\n   */\n  _addKeypoint(operation, filter, value) {\n    let shouldSkip = () =>\n      !this._isSame(operation, filter) || this._value !== value || !!this._keypoints.find((kp) => kp.value === value);\n\n    if (shouldSkip()) {\n      return;\n    }\n    let keypoint = this._constructKeypoint(operation, value);\n    let image = new Image();\n    image.src = keypoint.src;\n    let stop = this._handleImageLoading(keypoint.src);\n    image.addEventListener('load', stop, { once: true });\n    image.addEventListener('error', stop, { once: true });\n    keypoint.image = image;\n    image.classList.add('fader-image');\n\n    image.addEventListener(\n      'load',\n      () => {\n        if (shouldSkip()) {\n          return;\n        }\n        let keypoints = this._keypoints;\n        let idx = keypoints.findIndex((kp) => kp.value > value);\n        let insertBeforeNode = idx < keypoints.length ? keypoints[idx].image : null;\n        if (!this._container || (insertBeforeNode && !this._container.contains(insertBeforeNode))) {\n          return;\n        }\n        keypoints.splice(idx, 0, keypoint);\n        this._container.insertBefore(image, insertBeforeNode);\n        this._update(operation, value);\n      },\n      { once: true }\n    );\n\n    image.addEventListener(\n      'error',\n      () => {\n        this.$['*networkProblems'] = true;\n      },\n      { once: true }\n    );\n  }\n\n  /** @param {String | Number} value */\n  set(value) {\n    value = typeof value === 'string' ? parseInt(value, 10) : value;\n    this._update(this._operation, value);\n    this._addKeypointDebounced(this._operation, this._filter, value);\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   * @param {Number} value\n   */\n  _update(operation, value) {\n    this._operation = operation;\n    this._value = value;\n\n    let { zero } = COLOR_OPERATIONS_CONFIG[operation];\n\n    let keypointValues = this._keypoints.map((kp) => kp.value);\n    let opacities = calculateOpacities(keypointValues, value, zero);\n    let zIndices = calculateZIndices(keypointValues, zero);\n\n    for (let [idx, kp] of Object.entries(this._keypoints)) {\n      kp.opacity = opacities[idx];\n      kp.zIndex = zIndices[idx];\n    }\n\n    this._flush();\n  }\n\n  /** @private */\n  _createPreviewImage() {\n    let image = new Image();\n    image.classList.add('fader-image', 'fader-image--preview');\n    image.style.opacity = '0';\n    return image;\n  }\n\n  /** @private */\n  async _initNodes() {\n    let fr = document.createDocumentFragment();\n    this._previewImage = this._previewImage || this._createPreviewImage();\n    !this.contains(this._previewImage) && fr.appendChild(this._previewImage);\n\n    let container = document.createElement('div');\n    fr.appendChild(container);\n\n    let srcList = this._keypoints.map((kp) => kp.src);\n\n    let { images, promise, cancel } = batchPreloadImages(srcList);\n    images.forEach((node) => {\n      let stop = this._handleImageLoading(node.src);\n      node.addEventListener('load', stop);\n      node.addEventListener('error', stop);\n    });\n    this._cancelLastImages = () => {\n      cancel();\n      this._cancelLastImages = undefined;\n    };\n    let operation = this._operation;\n    let filter = this._filter;\n    await promise;\n    if (this._isActive && this._isSame(operation, filter)) {\n      this._container && this._container.remove();\n      this._container = container;\n      this._keypoints.forEach((kp, idx) => {\n        let kpImage = images[idx];\n        kpImage.classList.add('fader-image');\n        kp.image = kpImage;\n        this._container.appendChild(kpImage);\n      });\n      this.appendChild(fr);\n      this._flush();\n    }\n  }\n\n  /** @param {import('./types.js').Transformations} transformations */\n  setTransformations(transformations) {\n    this._transformations = transformations;\n    if (this._previewImage) {\n      let src = this._imageSrc();\n      let stop = this._handleImageLoading(src);\n      this._previewImage.src = src;\n      this._previewImage.addEventListener('load', stop, { once: true });\n      this._previewImage.addEventListener('error', stop, { once: true });\n      this._previewImage.style.opacity = '1';\n\n      this._previewImage.addEventListener(\n        'error',\n        () => {\n          this.$['*networkProblems'] = true;\n        },\n        { once: true }\n      );\n    }\n  }\n\n  /**\n   * @param {object} options\n   * @param {String} options.url\n   * @param {String} options.operation\n   * @param {Number} options.value\n   * @param {String} [options.filter]\n   */\n  preload({ url, filter, operation, value }) {\n    this._cancelBatchPreload && this._cancelBatchPreload();\n\n    let keypoints = keypointsRange(operation, value);\n    let srcList = keypoints.map((kp) => this._imageSrc({ url, filter, operation, value: kp }));\n    let { cancel } = batchPreloadImages(srcList);\n\n    this._cancelBatchPreload = cancel;\n  }\n\n  /** @private */\n  _setOriginalSrc(src) {\n    let image = this._previewImage || this._createPreviewImage();\n    !this.contains(image) && this.appendChild(image);\n    this._previewImage = image;\n\n    if (image.src === src) {\n      image.style.opacity = '1';\n      image.style.transform = 'scale(1)';\n      this.className = classNames({\n        active_from_viewer: this._fromViewer,\n        active_from_cropper: !this._fromViewer,\n        inactive_to_cropper: false,\n      });\n      return;\n    }\n    image.style.opacity = '0';\n    let stop = this._handleImageLoading(src);\n    image.addEventListener('error', stop, { once: true });\n    image.src = src;\n    image.addEventListener(\n      'load',\n      () => {\n        stop();\n        if (image) {\n          image.style.opacity = '1';\n          image.style.transform = 'scale(1)';\n          this.className = classNames({\n            active_from_viewer: this._fromViewer,\n            active_from_cropper: !this._fromViewer,\n            inactive_to_cropper: false,\n          });\n        }\n      },\n      { once: true }\n    );\n    image.addEventListener(\n      'error',\n      () => {\n        this.$['*networkProblems'] = true;\n      },\n      { once: true }\n    );\n  }\n\n  /**\n   * @param {object} options\n   * @param {String} options.url\n   * @param {String} [options.operation]\n   * @param {Number} [options.value]\n   * @param {String} [options.filter]\n   * @param {Boolean} [options.fromViewer]\n   */\n  activate({ url, operation, value, filter, fromViewer }) {\n    this._isActive = true;\n    this._hidden = false;\n    this._url = url;\n    this._operation = operation || 'initial';\n    this._value = value;\n    this._filter = filter;\n    this._fromViewer = fromViewer;\n\n    let isOriginal = typeof value !== 'number' && !filter;\n    if (isOriginal) {\n      let src = this._imageSrc({ operation, value });\n      this._setOriginalSrc(src);\n      this._container && this._container.remove();\n      return;\n    }\n    this._keypoints = keypointsRange(operation, value).map((keyValue) => this._constructKeypoint(operation, keyValue));\n\n    this._update(operation, value);\n    this._initNodes();\n  }\n\n  /** @param {{ hide?: Boolean }} options */\n  deactivate({ hide = true } = {}) {\n    this._isActive = false;\n\n    this._cancelLastImages && this._cancelLastImages();\n    this._cancelBatchPreload && this._cancelBatchPreload();\n\n    if (hide && !this._hidden) {\n      this._hidden = true;\n      if (this._previewImage) {\n        this._previewImage.style.transform = 'scale(1)';\n      }\n      this.className = classNames({\n        active_from_viewer: false,\n        active_from_cropper: false,\n        inactive_to_cropper: true,\n      });\n      this.addEventListener(\n        'transitionend',\n        () => {\n          this._container && this._container.remove();\n        },\n        { once: true }\n      );\n    } else {\n      this._container && this._container.remove();\n    }\n  }\n}\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\n\nconst X_THRESHOLD = 1;\n\nexport class EditorScroller extends CloudImageEditorBase {\n  initCallback() {\n    super.initCallback();\n\n    this.addEventListener('wheel', (e) => {\n      e.preventDefault();\n      let { deltaY, deltaX } = e;\n      if (Math.abs(deltaX) > X_THRESHOLD) {\n        this.scrollLeft += deltaX;\n      } else {\n        this.scrollLeft += deltaY;\n      }\n    });\n  }\n}\n\nEditorScroller.template = /* HTML */ ` <slot></slot> `;\n","import { CloudImageEditorBase } from './CloudImageEditorBase.js';\nimport { EditorCropButtonControl } from './EditorCropButtonControl.js';\nimport { EditorFilterControl } from './EditorFilterControl.js';\nimport { EditorOperationControl } from './EditorOperationControl.js';\nimport { FAKE_ORIGINAL_FILTER } from './EditorSlider.js';\nimport { debounce } from './lib/debounce.js';\nimport { batchPreloadImages } from './lib/preloadImage.js';\nimport {\n  ALL_COLOR_OPERATIONS,\n  ALL_CROP_OPERATIONS,\n  ALL_FILTERS,\n  COLOR_OPERATIONS_CONFIG,\n  TabId,\n  TABS,\n} from './toolbar-constants.js';\nimport { viewerImageSrc } from './util.js';\n\n/** @param {String} id */\nfunction renderTabToggle(id) {\n  return /* HTML */ `\n    <lr-btn-ui\n      theme=\"boring\"\n      ref=\"tab-toggle-${id}\"\n      data-id=\"${id}\"\n      icon=\"${id}\"\n      tabindex=\"0\"\n      set=\"onclick: on.clickTab;\"\n    >\n    </lr-btn-ui>\n  `;\n}\n\n/** @param {String} id */\nfunction renderTabContent(id) {\n  return /* HTML */ `\n    <lr-presence-toggle class=\"tab-content\" set=\"visible: presence.tabContent.${id}; styles: presence.tabContentStyles\">\n      <lr-editor-scroller hidden-scrollbar>\n        <div class=\"controls-list_align\">\n          <div class=\"controls-list_inner\" ref=\"controls-list-${id}\"></div>\n        </div>\n      </lr-editor-scroller>\n    </lr-presence-toggle>\n  `;\n}\n\nexport class EditorToolbar extends CloudImageEditorBase {\n  constructor() {\n    super();\n\n    this.init$ = {\n      ...this.init$,\n      '*sliderEl': null,\n      /** @type {import('./types.js').LoadingOperations} */\n      '*loadingOperations': new Map(),\n      '*showSlider': false,\n      '*currentFilter': FAKE_ORIGINAL_FILTER,\n      '*currentOperation': null,\n      '*tabId': TabId.CROP,\n      showLoader: false,\n      filters: ALL_FILTERS,\n      colorOperations: ALL_COLOR_OPERATIONS,\n      cropOperations: ALL_CROP_OPERATIONS,\n      '*operationTooltip': null,\n\n      'l10n.cancel': this.l10n('cancel'),\n      'l10n.apply': this.l10n('apply'),\n\n      'presence.mainToolbar': true,\n      'presence.subToolbar': false,\n      'presence.tabContent.crop': false,\n      'presence.tabContent.sliders': false,\n      'presence.tabContent.filters': false,\n      'presence.subTopToolbarStyles': {\n        hidden: 'sub-toolbar--top-hidden',\n        visible: 'sub-toolbar--visible',\n      },\n      'presence.subBottomToolbarStyles': {\n        hidden: 'sub-toolbar--bottom-hidden',\n        visible: 'sub-toolbar--visible',\n      },\n      'presence.tabContentStyles': {\n        hidden: 'tab-content--hidden',\n        visible: 'tab-content--visible',\n      },\n      'on.cancel': (e) => {\n        this._cancelPreload && this._cancelPreload();\n        this.$['*on.cancel']();\n      },\n      'on.apply': (e) => {\n        this.$['*on.apply'](this.$['*editorTransformations']);\n      },\n      'on.applySlider': (e) => {\n        this.ref['slider-el'].apply();\n        this._onSliderClose();\n      },\n      'on.cancelSlider': (e) => {\n        this.ref['slider-el'].cancel();\n        this._onSliderClose();\n      },\n      'on.clickTab': (e) => {\n        let id = e.currentTarget.getAttribute('data-id');\n        this._activateTab(id, { fromViewer: false });\n      },\n    };\n\n    /** @private */\n\n    this._debouncedShowLoader = debounce(this._showLoader.bind(this), 500);\n  }\n\n  /** @private */\n  _onSliderClose() {\n    this.$['*showSlider'] = false;\n    if (this.$['*tabId'] === TabId.SLIDERS) {\n      this.ref['tooltip-el'].classList.toggle('info-tooltip_visible', false);\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createOperationControl(operation) {\n    let el = EditorOperationControl.is && new EditorOperationControl();\n    el['operation'] = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} filter\n   */\n  _createFilterControl(filter) {\n    let el = EditorFilterControl.is && new EditorFilterControl();\n    el['filter'] = filter;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createToggleControl(operation) {\n    let el = EditorCropButtonControl.is && new EditorCropButtonControl();\n    el['operation'] = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _renderControlsList(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    let fr = document.createDocumentFragment();\n\n    if (tabId === TabId.CROP) {\n      this.$.cropOperations.forEach((operation) => {\n        let el = this._createToggleControl(operation);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.FILTERS) {\n      [FAKE_ORIGINAL_FILTER, ...this.$.filters].forEach((filterId) => {\n        let el = this._createFilterControl(filterId);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.SLIDERS) {\n      this.$.colorOperations.forEach((operation) => {\n        let el = this._createOperationControl(operation);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    }\n\n    fr.childNodes.forEach((/** @type {HTMLElement} */ el, idx) => {\n      if (idx === fr.childNodes.length - 1) {\n        el.classList.add('controls-list_last-item');\n      }\n    });\n\n    listEl.innerHTML = '';\n    listEl.appendChild(fr);\n  }\n\n  /**\n   * @private\n   * @param {String} id\n   * @param {{ fromViewer?: Boolean }} options\n   */\n  _activateTab(id, { fromViewer }) {\n    this.$['*tabId'] = id;\n\n    if (id === TabId.CROP) {\n      this.$['*faderEl'].deactivate();\n      this.$['*cropperEl'].activate(this.$['*imageSize'], { fromViewer });\n    } else {\n      this.$['*faderEl'].activate({ url: this.$['*originalUrl'], fromViewer });\n      this.$['*cropperEl'].deactivate();\n    }\n\n    for (let tabId of TABS) {\n      let isCurrentTab = tabId === id;\n\n      let tabToggleEl = this.ref[`tab-toggle-${tabId}`];\n      tabToggleEl.active = isCurrentTab;\n\n      if (isCurrentTab) {\n        this._renderControlsList(id);\n        this._syncTabIndicator();\n      } else {\n        this._unmountTabControls(tabId);\n      }\n      this.$[`presence.tabContent.${tabId}`] = isCurrentTab;\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _unmountTabControls(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    if (listEl) {\n      listEl.innerHTML = '';\n    }\n  }\n\n  /** @private */\n  _syncTabIndicator() {\n    let tabToggleEl = this.ref[`tab-toggle-${this.$['*tabId']}`];\n    let indicatorEl = this.ref['tabs-indicator'];\n    indicatorEl.style.transform = `translateX(${tabToggleEl.offsetLeft}px)`;\n  }\n\n  /** @private */\n  _preloadEditedImage() {\n    if (this.$['*imgContainerEl'] && this.$['*originalUrl']) {\n      let width = this.$['*imgContainerEl'].offsetWidth;\n      let src = this.proxyUrl(viewerImageSrc(this.$['*originalUrl'], width, this.$['*editorTransformations']));\n      this._cancelPreload && this._cancelPreload();\n      let { cancel } = batchPreloadImages([src]);\n      this._cancelPreload = () => {\n        cancel();\n        this._cancelPreload = undefined;\n      };\n    }\n  }\n\n  /** @private */\n  _showLoader(show) {\n    this.$.showLoader = show;\n  }\n\n  _updateInfoTooltip = debounce(() => {\n    let transformations = this.$['*editorTransformations'];\n    let text = '';\n    let visible = false;\n\n    if (this.$['*tabId'] === TabId.FILTERS) {\n      visible = true;\n      if (this.$['*currentFilter'] && transformations?.filter?.name === this.$['*currentFilter']) {\n        let value = transformations?.filter?.amount || 100;\n        text = this.l10n(this.$['*currentFilter']) + ' ' + value;\n      } else {\n        text = this.l10n(FAKE_ORIGINAL_FILTER);\n      }\n    } else if (this.$['*tabId'] === TabId.SLIDERS && this.$['*currentOperation']) {\n      visible = true;\n      let value =\n        transformations?.[this.$['*currentOperation']] || COLOR_OPERATIONS_CONFIG[this.$['*currentOperation']].zero;\n      text = this.$['*currentOperation'] + ' ' + value;\n    }\n    if (visible) {\n      this.$['*operationTooltip'] = text;\n    }\n    this.ref['tooltip-el'].classList.toggle('info-tooltip_visible', visible);\n  }, 0);\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['*sliderEl'] = this.ref['slider-el'];\n\n    this.sub('*imageSize', (imageSize) => {\n      if (imageSize) {\n        setTimeout(() => {\n          this._activateTab(this.$['*tabId'], { fromViewer: true });\n        }, 0);\n      }\n    });\n\n    this.sub('*editorTransformations', (editorTransformations) => {\n      let appliedFilter = editorTransformations?.filter?.name;\n      if (this.$['*currentFilter'] !== appliedFilter) {\n        this.$['*currentFilter'] = appliedFilter;\n      }\n    });\n\n    this.sub('*currentFilter', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*currentOperation', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*tabId', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*originalUrl', (originalUrl) => {\n      this.$['*faderEl'] && this.$['*faderEl'].deactivate();\n    });\n\n    this.sub('*editorTransformations', (transformations) => {\n      this._preloadEditedImage();\n      if (this.$['*faderEl']) {\n        this.$['*faderEl'].setTransformations(transformations);\n      }\n    });\n\n    this.sub('*loadingOperations', (/** @type {import('./types.js').LoadingOperations} */ loadingOperations) => {\n      let anyLoading = false;\n      for (let [, mapping] of loadingOperations.entries()) {\n        if (anyLoading) {\n          break;\n        }\n        for (let [, loading] of mapping.entries()) {\n          if (loading) {\n            anyLoading = true;\n            break;\n          }\n        }\n      }\n      this._debouncedShowLoader(anyLoading);\n    });\n\n    this.sub('*showSlider', (showSlider) => {\n      this.$['presence.subToolbar'] = showSlider;\n      this.$['presence.mainToolbar'] = !showSlider;\n    });\n\n    this._updateInfoTooltip();\n  }\n}\n\nEditorToolbar.template = /* HTML */ `\n  <lr-line-loader-ui set=\"active: showLoader\"></lr-line-loader-ui>\n  <div class=\"info-tooltip_container\">\n    <div class=\"info-tooltip_wrapper\">\n      <div ref=\"tooltip-el\" class=\"info-tooltip info-tooltip_hidden\">{{*operationTooltip}}</div>\n    </div>\n  </div>\n  <div class=\"toolbar-container\">\n    <lr-presence-toggle class=\"sub-toolbar\" set=\"visible: presence.mainToolbar; styles: presence.subTopToolbarStyles\">\n      <div class=\"tab-content-row\">${TABS.map(renderTabContent).join('')}</div>\n      <div class=\"controls-row\">\n        <lr-btn-ui theme=\"boring\" icon=\"closeMax\" set=\"onclick: on.cancel\"> </lr-btn-ui>\n        <div class=\"tab-toggles\">\n          <div ref=\"tabs-indicator\" class=\"tab-toggles_indicator\"></div>\n          ${TABS.map(renderTabToggle).join('')}\n        </div>\n        <lr-btn-ui theme=\"primary\" icon=\"done\" set=\"onclick: on.apply\"> </lr-btn-ui>\n      </div>\n    </lr-presence-toggle>\n    <lr-presence-toggle class=\"sub-toolbar\" set=\"visible: presence.subToolbar; styles: presence.subBottomToolbarStyles\">\n      <div class=\"slider\">\n        <lr-editor-slider ref=\"slider-el\"></lr-editor-slider>\n      </div>\n      <div class=\"controls-row\">\n        <lr-btn-ui theme=\"boring\" set=\"@text: l10n.cancel; onclick: on.cancelSlider;\"> </lr-btn-ui>\n        <lr-btn-ui theme=\"primary\" set=\"@text: l10n.apply; onclick: on.applySlider;\"> </lr-btn-ui>\n      </div>\n    </lr-presence-toggle>\n  </div>\n`;\n","import { Block } from '../../../../../abstract/Block.js';\nimport { classNames } from '../../lib/classNames.js';\n\nexport class LrBtnUi extends Block {\n  constructor() {\n    super();\n\n    this._iconReversed = false;\n    this._iconSingle = false;\n    this._iconHidden = false;\n\n    this.init$ = {\n      ...this.init$,\n      text: '',\n      icon: '',\n      iconCss: this._iconCss(),\n      theme: null,\n    };\n\n    this.defineAccessor('active', (active) => {\n      if (active) {\n        this.setAttribute('active', '');\n      } else {\n        this.removeAttribute('active');\n      }\n    });\n  }\n\n  _iconCss() {\n    return classNames('icon', {\n      icon_left: !this._iconReversed,\n      icon_right: this._iconReversed,\n      icon_hidden: this._iconHidden,\n      icon_single: this._iconSingle,\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('icon', (iconName) => {\n      this._iconSingle = !this.$.text;\n      this._iconHidden = !iconName;\n      this.$.iconCss = this._iconCss();\n    });\n\n    this.sub('theme', (theme) => {\n      if (theme !== 'custom') {\n        this.className = theme;\n      }\n    });\n\n    this.sub('text', (txt) => {\n      this._iconSingle = false;\n    });\n\n    this.setAttribute('role', 'button');\n    if (this.tabIndex === -1) {\n      this.tabIndex = 0;\n    }\n    if (!this.hasAttribute('theme')) {\n      this.setAttribute('theme', 'default');\n    }\n  }\n\n  set reverse(val) {\n    if (this.hasAttribute('reverse')) {\n      this.style.flexDirection = 'row-reverse';\n      this._iconReversed = true;\n    } else {\n      this._iconReversed = false;\n      this.style.flexDirection = null;\n    }\n  }\n}\nLrBtnUi.bindAttributes({ text: 'text', icon: 'icon', reverse: 'reverse', theme: 'theme' });\n\nLrBtnUi.template = /* HTML */ `\n  <lr-icon size=\"20\" set=\"className: iconCss; @name: icon;\"></lr-icon>\n  <div class=\"text\">{{text}}</div>\n`;\n","import { Block } from '../../../../../abstract/Block.js';\n\nexport class LineLoaderUi extends Block {\n  constructor() {\n    super();\n\n    this._active = false;\n\n    this._handleTransitionEndRight = () => {\n      let lineEl = this.ref['line-el'];\n      lineEl.style.transition = `initial`;\n      lineEl.style.opacity = '0';\n      lineEl.style.transform = `translateX(-101%)`;\n      this._active && this._start();\n    };\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.defineAccessor('active', (active) => {\n      if (typeof active === 'boolean') {\n        if (active) {\n          this._start();\n        } else {\n          this._stop();\n        }\n      }\n    });\n  }\n\n  _start() {\n    this._active = true;\n    let { width } = this.getBoundingClientRect();\n    let lineEl = this.ref['line-el'];\n    lineEl.style.transition = `transform 1s`;\n    lineEl.style.opacity = '1';\n    lineEl.style.transform = `translateX(${width}px)`;\n    lineEl.addEventListener('transitionend', this._handleTransitionEndRight, {\n      once: true,\n    });\n  }\n\n  _stop() {\n    this._active = false;\n  }\n}\n\nLineLoaderUi.template = /* HTML */ `\n  <div class=\"inner\">\n    <div class=\"line\" ref=\"line-el\"></div>\n  </div>\n`;\n","import { applyClassNames } from '../../lib/classNames.js';\nimport { Block } from '../../../../../abstract/Block.js';\n\n/**\n * @typedef {Object} Style\n * @property {String} [transition]\n * @property {String} [visible]\n * @property {String} [hidden]\n */\n\n/** @type {Style} */\nconst DEFAULT_STYLE = {\n  transition: 'transition',\n  visible: 'visible',\n  hidden: 'hidden',\n};\n\nexport class PresenceToggle extends Block {\n  constructor() {\n    super();\n\n    this._visible = false;\n    this._visibleStyle = DEFAULT_STYLE.visible;\n    this._hiddenStyle = DEFAULT_STYLE.hidden;\n    this._externalTransitions = false;\n\n    this.defineAccessor('styles', (styles) => {\n      if (!styles) {\n        return;\n      }\n      this._externalTransitions = true;\n      this._visibleStyle = styles.visible;\n      this._hiddenStyle = styles.hidden;\n    });\n\n    this.defineAccessor('visible', (visible) => {\n      if (typeof visible !== 'boolean') {\n        return;\n      }\n\n      this._visible = visible;\n      this._handleVisible();\n    });\n  }\n\n  _handleVisible() {\n    this.style.visibility = this._visible ? 'inherit' : 'hidden';\n    applyClassNames(this, {\n      [DEFAULT_STYLE.transition]: !this._externalTransitions,\n      [this._visibleStyle]: this._visible,\n      [this._hiddenStyle]: !this._visible,\n    });\n    this.setAttribute('aria-hidden', this._visible ? 'false' : 'true');\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.setAttribute('hidden', '');\n\n    if (!this._externalTransitions) {\n      this.classList.add(DEFAULT_STYLE.transition);\n    }\n\n    this._handleVisible();\n    setTimeout(() => this.removeAttribute('hidden'), 0);\n  }\n}\nPresenceToggle.template = /* HTML */ ` <slot></slot> `;\n","import { Block } from '../../../../../abstract/Block.js';\n\nexport class SliderUi extends Block {\n  init$ = {\n    ...this.init$,\n    disabled: false,\n    min: 0,\n    max: 100,\n    onInput: null,\n    onChange: null,\n    defaultValue: null,\n    'on.sliderInput': () => {\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this._updateValue(value);\n      this.$.onInput && this.$.onInput(value);\n    },\n    'on.sliderChange': () => {\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this.$.onChange && this.$.onChange(value);\n    },\n  };\n\n  constructor() {\n    super();\n    this.setAttribute('with-effects', '');\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.defineAccessor('disabled', (disabled) => {\n      this.$.disabled = disabled;\n    });\n\n    this.defineAccessor('min', (min) => {\n      this.$.min = min;\n    });\n\n    this.defineAccessor('max', (max) => {\n      this.$.max = max;\n    });\n\n    this.defineAccessor('defaultValue', (defaultValue) => {\n      this.$.defaultValue = defaultValue;\n      this.ref['input-el'].value = defaultValue;\n      this._updateValue(defaultValue);\n    });\n\n    this.defineAccessor('zero', (zero) => {\n      this._zero = zero;\n    });\n\n    this.defineAccessor('onInput', (onInput) => {\n      if (!onInput) return;\n      this.$.onInput = onInput;\n    });\n\n    this.defineAccessor('onChange', (onChange) => {\n      if (!onChange) return;\n      this.$.onChange = onChange;\n    });\n\n    this._updateSteps();\n\n    this._observer = new ResizeObserver(() => {\n      this._updateSteps();\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this._updateValue(value);\n    });\n    this._observer.observe(this);\n\n    this._thumbSize = parseInt(window.getComputedStyle(this).getPropertyValue('--l-thumb-size'), 10);\n\n    setTimeout(() => {\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this._updateValue(value);\n    }, 0);\n\n    this.sub('disabled', (disabled) => {\n      let el = this.ref['input-el'];\n      if (disabled) {\n        el.setAttribute('disabled', 'disabled');\n      } else {\n        el.removeAttribute('disabled');\n      }\n    });\n\n    let inputEl = this.ref['input-el'];\n    inputEl.addEventListener('focus', () => {\n      this.style.setProperty('--color-effect', 'var(--hover-color-rgb)');\n    });\n    inputEl.addEventListener('blur', () => {\n      this.style.setProperty('--color-effect', 'var(--idle-color-rgb)');\n    });\n  }\n\n  _updateValue(value) {\n    this._updateZeroDot(value);\n\n    let { width } = this.getBoundingClientRect();\n    let slope = 100 / (this.$.max - this.$.min);\n    let mappedValue = slope * (value - this.$.min);\n    let offset = (mappedValue * (width - this._thumbSize)) / 100;\n\n    window.requestAnimationFrame(() => {\n      this.ref['thumb-el'].style.transform = `translateX(${offset}px)`;\n    });\n  }\n\n  _updateZeroDot(value) {\n    if (!this._zeroDotEl) {\n      return;\n    }\n    if (value === this._zero) {\n      this._zeroDotEl.style.opacity = '0';\n    } else {\n      this._zeroDotEl.style.opacity = '0.2';\n    }\n    let { width } = this.getBoundingClientRect();\n    let slope = 100 / (this.$.max - this.$.min);\n    let mappedValue = slope * (this._zero - this.$.min);\n    let offset = (mappedValue * (width - this._thumbSize)) / 100;\n    window.requestAnimationFrame(() => {\n      this._zeroDotEl.style.transform = `translateX(${offset}px)`;\n    });\n  }\n\n  _updateSteps() {\n    const STEP_GAP = 15;\n\n    let stepsEl = this.ref['steps-el'];\n    let { width } = stepsEl.getBoundingClientRect();\n    let half = Math.ceil(width / 2);\n    let count = Math.ceil(half / STEP_GAP) - 2;\n\n    if (this._stepsCount === count) {\n      return;\n    }\n\n    let fr = document.createDocumentFragment();\n    let minorStepEl = document.createElement('div');\n    let borderStepEl = document.createElement('div');\n    minorStepEl.className = 'minor-step';\n    borderStepEl.className = 'border-step';\n    fr.appendChild(borderStepEl);\n    for (let i = 0; i < count; i++) {\n      fr.appendChild(minorStepEl.cloneNode());\n    }\n    fr.appendChild(borderStepEl.cloneNode());\n    for (let i = 0; i < count; i++) {\n      fr.appendChild(minorStepEl.cloneNode());\n    }\n    fr.appendChild(borderStepEl.cloneNode());\n\n    let zeroDotEl = document.createElement('div');\n    zeroDotEl.className = 'zero-dot';\n    fr.appendChild(zeroDotEl);\n    this._zeroDotEl = zeroDotEl;\n\n    stepsEl.innerHTML = '';\n    stepsEl.appendChild(fr);\n    this._stepsCount = count;\n  }\n\n  destroyCallback() {\n    this._observer?.disconnect();\n  }\n}\nSliderUi.template = /* HTML */ `\n  <div class=\"steps\" ref=\"steps-el\"></div>\n  <div ref=\"thumb-el\" class=\"thumb\"></div>\n  <input\n    class=\"input\"\n    type=\"range\"\n    ref=\"input-el\"\n    tabindex=\"0\"\n    set=\"oninput: on.sliderInput; onchange: on.sliderChange; @min: min; @max: max; @value: defaultValue;\"\n  />\n`;\n","/**\n * @param {string} str\n * @returns {string}\n */\nconst escapeRegExp = function (str) {\n  return str.replace(/[\\\\-\\\\[]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n};\n\n/**\n * @param {string} str\n * @param {string} flags\n * @returns {RegExp}\n */\nexport const wildcardRegexp = function (str, flags = 'i') {\n  const parts = str.split('*').map(escapeRegExp);\n  return new RegExp('^' + parts.join('.+') + '$', flags);\n};\n","let styleToCss = (style) => {\n  let css = Object.keys(style).reduce((acc, selector) => {\n    let propertiesObj = style[selector];\n    let propertiesStr = Object.keys(propertiesObj).reduce((acc, prop) => {\n      let value = propertiesObj[prop];\n      return acc + `${prop}: ${value};`;\n    }, '');\n    return acc + `${selector}{${propertiesStr}}`;\n  }, '');\n  return css;\n};\n\nexport function buildStyles({ textColor, backgroundColor, linkColor, linkColorHover, shadeColor }) {\n  let border = `solid 1px ${shadeColor}`;\n\n  // TODO: we need to update source source styles, add css custom properties to control theme\n  return styleToCss({\n    body: {\n      color: textColor,\n      'background-color': backgroundColor,\n    },\n    '.side-bar': {\n      background: 'inherit',\n      'border-right': border,\n    },\n    '.main-content': {\n      background: 'inherit',\n    },\n    '.main-content-header': {\n      background: 'inherit',\n    },\n    '.main-content-footer': {\n      background: 'inherit',\n    },\n    '.list-table-row': {\n      color: 'inherit',\n    },\n    '.list-table-row:hover': {\n      background: shadeColor,\n    },\n    '.list-table-row .list-table-cell-a, .list-table-row .list-table-cell-b': {\n      'border-top': border,\n    },\n    '.list-table-body .list-items': {\n      'border-bottom': border,\n    },\n    '.bread-crumbs a': {\n      color: linkColor,\n    },\n    '.bread-crumbs a:hover': {\n      color: linkColorHover,\n    },\n    '.main-content.loading': {\n      background: `${backgroundColor} url(/static/images/loading_spinner.gif) center no-repeat`,\n      'background-size': '25px 25px',\n    },\n    '.list-icons-item': {\n      'background-color': shadeColor,\n    },\n    '.source-gdrive .side-bar-menu a, .source-gphotos .side-bar-menu a': {\n      color: linkColor,\n    },\n    '.source-gdrive .side-bar-menu a, .source-gphotos .side-bar-menu a:hover': {\n      color: linkColorHover,\n    },\n    '.side-bar-menu a': {\n      color: linkColor,\n    },\n    '.side-bar-menu a:hover': {\n      color: linkColorHover,\n    },\n    '.source-gdrive .side-bar-menu .current, .source-gdrive .side-bar-menu a:hover, .source-gphotos .side-bar-menu .current, .source-gphotos .side-bar-menu a:hover':\n      {\n        color: linkColorHover,\n      },\n    '.source-vk .side-bar-menu a': {\n      color: linkColor,\n    },\n    '.source-vk .side-bar-menu a:hover': {\n      color: linkColorHover,\n      background: 'none',\n    },\n  });\n}\n","let cbMapping = {};\n\nwindow.addEventListener('message', (e) => {\n  let message;\n  try {\n    message = JSON.parse(e.data);\n  } catch (err) {\n    return;\n  }\n\n  if (message?.type in cbMapping) {\n    let cbList = cbMapping[message.type];\n    for (let [sender, callback] of cbList) {\n      if (e.source === sender) {\n        callback(message);\n      }\n    }\n  }\n});\n\nconst registerMessage = function (type, sender, callback) {\n  if (!(type in cbMapping)) {\n    cbMapping[type] = [];\n  }\n\n  cbMapping[type].push([sender, callback]);\n};\n\nconst unregisterMessage = function (type, sender) {\n  if (type in cbMapping) {\n    cbMapping[type] = cbMapping[type].filter((item) => item[0] !== sender);\n  }\n};\n\nexport { registerMessage, unregisterMessage };\n","// @ts-check\n\nimport { create } from '@symbiotejs/symbiote';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\nimport { wildcardRegexp } from '../../utils/wildcardRegexp.js';\nimport { buildStyles } from './buildStyles.js';\nimport { registerMessage, unregisterMessage } from './messages.js';\nimport { queryString } from './query-string.js';\n\n/** @typedef {{ externalSourceType: string }} ActivityParams */\n\n/**\n * @typedef {{\n *   type: 'file-selected';\n *   obj_type: 'selected_file';\n *   filename: string;\n *   url: string;\n *   alternatives?: Record<string, string>;\n * }} SelectedFileMessage\n */\n\n/**\n * @typedef {{\n *   type: 'embed-css';\n *   style: string;\n * }} EmbedCssMessage\n */\n\n/** @typedef {SelectedFileMessage | EmbedCssMessage} Message */\n\nexport class ExternalSource extends UploaderBlock {\n  activityType = ActivityBlock.activities.EXTERNAL;\n\n  // @ts-ignore TODO: fix this\n  init$ = {\n    ...this.init$,\n    activityIcon: '',\n    activityCaption: '',\n    counter: 0,\n    onDone: () => {\n      this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n    },\n    onCancel: () => {\n      this.historyBack();\n    },\n  };\n\n  /**\n   * @private\n   * @type {HTMLIFrameElement | null}\n   */\n  _iframe = null;\n\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType, {\n      onActivate: () => {\n        let { externalSourceType } = /** @type {ActivityParams} */ (this.activityParams);\n\n        this.set$({\n          activityCaption: `${externalSourceType?.[0].toUpperCase()}${externalSourceType?.slice(1)}`,\n          activityIcon: externalSourceType,\n        });\n\n        this.$.counter = 0;\n        this.mountIframe();\n      },\n    });\n    this.sub('*currentActivity', (val) => {\n      if (val !== this.activityType) {\n        this.unmountIframe();\n      }\n    });\n  }\n\n  /**\n   * @private\n   * @param {Message} message\n   */\n  sendMessage(message) {\n    this._iframe?.contentWindow?.postMessage(JSON.stringify(message), '*');\n  }\n\n  /**\n   * @private\n   * @param {SelectedFileMessage} message\n   */\n  async handleFileSelected(message) {\n    console.log(message);\n    this.$.counter = this.$.counter + 1;\n\n    const url = (() => {\n      if (message.alternatives) {\n        const preferredTypes = stringToArray(this.cfg.externalSourcesPreferredTypes);\n        for (const preferredType of preferredTypes) {\n          const regexp = wildcardRegexp(preferredType);\n          for (const [type, typeUrl] of Object.entries(message.alternatives)) {\n            if (regexp.test(type)) {\n              return typeUrl;\n            }\n          }\n        }\n      }\n      return message.url;\n    })();\n\n    let { filename } = message;\n    let { externalSourceType } = this.activityParams;\n    this.addFileFromUrl(url, { fileName: filename, source: externalSourceType });\n  }\n\n  /** @private */\n  handleIframeLoad() {\n    this.applyStyles();\n  }\n\n  /** @private */\n  _inheritedUpdateCssData = this.updateCssData;\n  updateCssData = () => {\n    if (this.isActivityActive) {\n      this._inheritedUpdateCssData();\n      this.applyStyles();\n    }\n  };\n\n  /**\n   * @private\n   * @param {string} propName\n   */\n  getCssValue(propName) {\n    let style = window.getComputedStyle(this);\n    return style.getPropertyValue(propName).trim();\n  }\n\n  /** @private */\n  applyStyles() {\n    let colors = {\n      backgroundColor: this.getCssValue('--clr-background-light'),\n      textColor: this.getCssValue('--clr-txt'),\n      shadeColor: this.getCssValue('--clr-shade-lv1'),\n      linkColor: '#157cfc',\n      linkColorHover: '#3891ff',\n    };\n\n    this.sendMessage({\n      type: 'embed-css',\n      style: buildStyles(colors),\n    });\n  }\n\n  /** @private */\n  remoteUrl() {\n    let pubkey = this.cfg.pubkey;\n    let imagesOnly = false.toString();\n    let { externalSourceType } = this.activityParams;\n    let params = {\n      lang: this.getCssData('--l10n-locale-name')?.split('-')?.[0] || 'en',\n      public_key: pubkey,\n      images_only: imagesOnly,\n      pass_window_open: false,\n      session_key: this.cfg.remoteTabSessionKey,\n    };\n    let url = new URL(this.cfg.socialBaseUrl);\n    url.pathname = `/window3/${externalSourceType}`;\n    url.search = queryString(params);\n    return url.toString();\n  }\n\n  /** @private */\n  mountIframe() {\n    /** @type {HTMLIFrameElement} */\n    // @ts-ignore\n    let iframe = create({\n      tag: 'iframe',\n      attributes: {\n        src: this.remoteUrl(),\n        marginheight: 0,\n        marginwidth: 0,\n        frameborder: 0,\n        allowTransparency: true,\n      },\n    });\n    iframe.addEventListener('load', this.handleIframeLoad.bind(this));\n\n    this.ref.iframeWrapper.innerHTML = '';\n    this.ref.iframeWrapper.appendChild(iframe);\n\n    registerMessage('file-selected', iframe.contentWindow, this.handleFileSelected.bind(this));\n\n    this._iframe = iframe;\n  }\n\n  /** @private */\n  unmountIframe() {\n    this._iframe && unregisterMessage('file-selected', this._iframe.contentWindow);\n    this.ref.iframeWrapper.innerHTML = '';\n    this._iframe = null;\n  }\n}\n\nExternalSource.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <div>\n      <lr-icon set=\"@name: activityIcon\"></lr-icon>\n      <span>{{activityCaption}}</span>\n    </div>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <div ref=\"iframeWrapper\" class=\"iframe-wrapper\"></div>\n    <div class=\"toolbar\">\n      <button type=\"button\" class=\"cancel-btn secondary-btn\" set=\"onclick: onCancel\" l10n=\"cancel\"></button>\n      <div></div>\n      <div class=\"selected-counter\"><span l10n=\"selected-count\"></span>{{counter}}</div>\n      <button type=\"button\" class=\"done-btn primary-btn\" set=\"onclick: onDone; @disabled: !counter\">\n        <lr-icon name=\"check\"></lr-icon>\n      </button>\n    </div>\n  </div>\n`;\n","/**\n * @param {{ [key: string]: string | number | boolean | null | undefined }} params\n * @returns {string}\n */\nexport function queryString(params) {\n  let list = [];\n  for (let [key, value] of Object.entries(params)) {\n    if (value === undefined || value === null || (typeof value === 'string' && value.length === 0)) {\n      continue;\n    }\n    list.push(`${key}=${encodeURIComponent(value)}`);\n  }\n  return list.join('&');\n}\n","import { Block } from '../../abstract/Block.js';\nimport { create } from '@symbiotejs/symbiote';\nimport { stringToArray } from '../../utils/stringToArray.js';\n\nexport class Tabs extends Block {\n  /** @param {String} tabL10nStr */\n  setCurrentTab(tabL10nStr) {\n    if (!tabL10nStr) {\n      return;\n    }\n    let ctxList = [...this.ref.context.querySelectorAll('[tab-ctx]')];\n    ctxList.forEach((ctxEl) => {\n      if (ctxEl.getAttribute('tab-ctx') === tabL10nStr) {\n        ctxEl.removeAttribute('hidden');\n      } else {\n        ctxEl.setAttribute('hidden', '');\n      }\n    });\n    for (let lStr in this._tabMap) {\n      if (lStr === tabL10nStr) {\n        this._tabMap[lStr].setAttribute('current', '');\n      } else {\n        this._tabMap[lStr].removeAttribute('current');\n      }\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    /**\n     * @private\n     * @type {Object<string, HTMLElement>}\n     */\n    this._tabMap = {};\n    this.defineAccessor('tab-list', (/** @type {String} */ val) => {\n      if (!val) {\n        return;\n      }\n      let tabList = stringToArray(val);\n      tabList.forEach((tabL10nStr) => {\n        let tabEl = create({\n          tag: 'div',\n          attributes: {\n            class: 'tab',\n          },\n          properties: {\n            onclick: () => {\n              this.setCurrentTab(tabL10nStr);\n            },\n          },\n        });\n        tabEl.textContent = this.l10n(tabL10nStr);\n        this.ref.row.appendChild(tabEl);\n        this._tabMap[tabL10nStr] = tabEl;\n      });\n    });\n\n    this.defineAccessor('default', (val) => {\n      this.setCurrentTab(val);\n    });\n\n    if (!this.hasAttribute('default')) {\n      this.setCurrentTab(Object.keys(this._tabMap)[0]);\n    }\n  }\n}\n\nTabs.bindAttributes({\n  'tab-list': null,\n  default: null,\n});\n\nTabs.template = /* HTML */ `\n  <div ref=\"row\" class=\"tabs-row\"></div>\n  <div ref=\"context\" class=\"tabs-context\">\n    <slot></slot>\n  </div>\n`;\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { uploadFileGroup } from '@uploadcare/upload-client';\n\n/** @typedef {import('@uploadcare/upload-client').UploadcareFile[]} FileList} */\n\nexport class DataOutput extends UploaderBlock {\n  processInnerHtml = true;\n\n  init$ = {\n    ...this.init$,\n    output: null,\n    filesData: null,\n  };\n\n  get dict() {\n    return DataOutput.dict;\n  }\n\n  get validationInput() {\n    return this._validationInputElement;\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    if (this.hasAttribute(this.dict.FORM_INPUT_ATTR)) {\n      this._dynamicInputsContainer = document.createElement('div');\n      this.appendChild(this._dynamicInputsContainer);\n\n      if (this.hasAttribute(this.dict.INPUT_REQUIRED)) {\n        let input = document.createElement('input');\n        input.type = 'text';\n        input.name = '__UPLOADCARE_VALIDATION_INPUT__';\n        input.required = true;\n        this.appendChild(input);\n        this._validationInputElement = input;\n      }\n    }\n\n    this.sub(\n      'output',\n      (data) => {\n        if (!data) {\n          return;\n        }\n        if (this.hasAttribute(this.dict.FIRE_EVENT_ATTR)) {\n          this.dispatchEvent(\n            new CustomEvent(this.dict.EVENT_NAME, {\n              bubbles: true,\n              composed: true,\n              detail: {\n                timestamp: Date.now(),\n                ctxName: this.ctxName,\n                data,\n              },\n            })\n          );\n        }\n\n        if (this.hasAttribute(this.dict.FORM_INPUT_ATTR)) {\n          this._dynamicInputsContainer.innerHTML = '';\n          let values = data.groupData ? [data.groupData.cdnUrl] : data.map((file) => file.cdnUrl);\n          for (let value of values) {\n            let input = document.createElement('input');\n            input.type = 'hidden';\n            input.name = this.getAttribute(this.dict.INPUT_NAME_ATTR) || this.ctxName;\n            input.value = value;\n            this._dynamicInputsContainer.appendChild(input);\n          }\n          if (this.hasAttribute(this.dict.INPUT_REQUIRED)) {\n            this._validationInputElement.value = values.length ? '__VALUE__' : '';\n          }\n        }\n\n        if (this.hasAttribute(this.dict.CONSOLE_ATTR)) {\n          console.log(data);\n        }\n      },\n      false\n    );\n\n    this.sub(\n      this.dict.SRC_CTX_KEY,\n      async (/** @type {FileList} */ data) => {\n        if (!data) {\n          this.$.output = null;\n          this.$.filesData = null;\n          return;\n        }\n        this.$.filesData = data;\n        if (this.cfg.groupOutput || this.hasAttribute(this.dict.GROUP_ATTR)) {\n          let uuidList = data.map((fileDesc) => {\n            return fileDesc.uuid;\n          });\n          const uploadClientOptions = await this.getUploadClientOptions();\n          let resp = await uploadFileGroup(uuidList, {\n            ...uploadClientOptions,\n          });\n          this.$.output = {\n            groupData: resp,\n            files: data,\n          };\n        } else {\n          this.$.output = data;\n        }\n      },\n      false\n    );\n  }\n}\n\nDataOutput.dict = Object.freeze({\n  SRC_CTX_KEY: '*outputData',\n  EVENT_NAME: 'lr-data-output',\n  FIRE_EVENT_ATTR: 'use-event',\n  CONSOLE_ATTR: 'use-console',\n  GROUP_ATTR: 'use-group',\n  FORM_INPUT_ATTR: 'use-input',\n  INPUT_NAME_ATTR: 'input-name',\n  INPUT_REQUIRED: 'input-required',\n});\n","import { Block } from '../../abstract/Block.js';\n\nexport class Select extends Block {\n  init$ = {\n    ...this.init$,\n    currentText: '',\n    options: [],\n    selectHtml: '',\n    onSelect: (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.value = this.ref.select.value;\n      this.$.currentText =\n        this.$.options.find((opt) => {\n          return opt.value == this.value;\n        })?.text || '';\n      this.dispatchEvent(new Event('change'));\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('options', (/** @type {{ text: String; value: String }[]} */ options) => {\n      this.$.currentText = options?.[0]?.text || '';\n      let html = '';\n      options?.forEach((opt) => {\n        html += /* HTML */ `<option value=\"${opt.value}\">${opt.text}</option>`;\n      });\n      this.$.selectHtml = html;\n    });\n  }\n}\n\nSelect.template = /* HTML */ `\n  <button>\n    {{currentText}}\n    <lr-icon name=\"select\"></lr-icon>\n    <select ref=\"select\" set=\"innerHTML: selectHtml; onchange: onSelect\"></select>\n  </button>\n`;\n","import { Block } from '../../abstract/Block.js';\n\n/** @enum {String} */\nconst ICO_MAP = {\n  PLAY: 'play',\n  PAUSE: 'pause',\n  FS_ON: 'fullscreen-on',\n  FS_OFF: 'fullscreen-off',\n  VOL_ON: 'unmute',\n  VOL_OFF: 'mute',\n  CAP_ON: 'captions',\n  CAP_OFF: 'captions-off',\n};\n\n// TODO: refactor and move fullscreen adapter to utils:\nconst FSAPI = {\n  requestFullscreen: (el) => {\n    if (el.requestFullscreen) {\n      el.requestFullscreen();\n    } else if (el.webkitRequestFullscreen) {\n      el.webkitRequestFullscreen();\n    }\n  },\n  exitFullscreen: () => {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document['webkitExitFullscreen']) {\n      document['webkitExitFullscreen']();\n    }\n  },\n};\n\nexport class Video extends Block {\n  togglePlay() {\n    if (this._video.paused || this._video.ended) {\n      this._video.play();\n    } else {\n      this._video.pause();\n    }\n  }\n\n  toggleFullscreen() {\n    if ((document.fullscreenElement || document['webkitFullscreenElement']) === this) {\n      FSAPI.exitFullscreen();\n    } else {\n      FSAPI.requestFullscreen(this);\n    }\n  }\n\n  toggleCaptions() {\n    if (this.$.capIcon === ICO_MAP.CAP_OFF) {\n      this.$.capIcon = ICO_MAP.CAP_ON;\n      this._video.textTracks[0].mode = 'showing';\n      window.localStorage.setItem(Video.is + ':captions', '1');\n    } else {\n      this.$.capIcon = ICO_MAP.CAP_OFF;\n      this._video.textTracks[0].mode = 'hidden';\n      window.localStorage.removeItem(Video.is + ':captions');\n    }\n  }\n\n  toggleSound() {\n    if (this.$.volIcon === ICO_MAP.VOL_ON) {\n      this.$.volIcon = ICO_MAP.VOL_OFF;\n      this.$.volumeDisabled = true;\n      this._video.muted = true;\n    } else {\n      this.$.volIcon = ICO_MAP.VOL_ON;\n      this.$.volumeDisabled = false;\n      this._video.muted = false;\n    }\n  }\n\n  setVolume(val) {\n    window.localStorage.setItem(Video.is + ':volume', val);\n    let volume = val ? val / 100 : 0;\n    this._video.volume = volume;\n  }\n\n  /** @type {HTMLElement} */\n  get progress() {\n    return this.ref.progress;\n  }\n\n  init$ = {\n    ...this.init$,\n    src: '',\n    ppIcon: ICO_MAP.PLAY,\n    fsIcon: ICO_MAP.FS_ON,\n    volIcon: ICO_MAP.VOL_ON,\n    capIcon: ICO_MAP.CAP_OFF,\n    totalTime: '00:00',\n    currentTime: '00:00',\n    progressCssWidth: '0',\n    hasSubtitles: false,\n    volumeDisabled: false,\n    volumeValue: 0,\n    onPP: () => {\n      this.togglePlay();\n    },\n    onFs: () => {\n      this.toggleFullscreen();\n    },\n    onCap: () => {\n      this.toggleCaptions();\n    },\n    onMute: () => {\n      this.toggleSound();\n    },\n    onVolChange: (e) => {\n      // TODO: cast range.value instead of range.$.value\n      let val = parseFloat(e.currentTarget.$.value);\n      this.setVolume(val);\n    },\n    progressClicked: (e) => {\n      let progressRect = this.progress.getBoundingClientRect();\n      this._video.currentTime = this._video.duration * (e.offsetX / progressRect.width);\n    },\n  };\n\n  /**\n   * @private\n   * @param {String} input\n   */\n  _getUrl(input) {\n    return input.includes('/') ? input : `https://ucarecdn.com/${input}/`;\n  }\n\n  /**\n   * @private\n   * @param {Object<string, any>} desc\n   */\n  _desc2attrs(desc) {\n    let attrs = [];\n    for (let attr in desc) {\n      let val = attr === 'src' ? this._getUrl(desc[attr]) : desc[attr];\n      attrs.push(`${attr}=\"${val}\"`);\n    }\n    return attrs.join(' ');\n  }\n\n  /**\n   * @private\n   * @param {Number} seconds\n   */\n  _timeFmt(seconds) {\n    // TODO: add hours\n    let date = new Date(Math.round(seconds) * 1000);\n    return [date.getMinutes(), date.getSeconds()]\n      .map((n) => {\n        return n < 10 ? '0' + n : n;\n      })\n      .join(':');\n  }\n\n  /** @private */\n  _initTracks() {\n    [...this._video.textTracks].forEach((track) => {\n      track.mode = 'hidden';\n    });\n    if (window.localStorage.getItem(Video.is + ':captions')) {\n      this.toggleCaptions();\n    }\n  }\n\n  /** @private */\n  _castAttributes() {\n    let toCast = ['autoplay', 'loop', 'muted'];\n    [...this.attributes].forEach((attr) => {\n      if (toCast.includes(attr.name)) {\n        this._video.setAttribute(attr.name, attr.value);\n      }\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n    /**\n     * @private\n     * @type {HTMLVideoElement}\n     */\n    this._video = this.ref.video;\n\n    this._castAttributes();\n\n    this._video.addEventListener('play', () => {\n      this.$.ppIcon = ICO_MAP.PAUSE;\n      this.setAttribute('playback', '');\n    });\n\n    this._video.addEventListener('pause', () => {\n      this.$.ppIcon = ICO_MAP.PLAY;\n      this.removeAttribute('playback');\n    });\n\n    this.addEventListener('fullscreenchange', (e) => {\n      console.log(e);\n      if (document.fullscreenElement === this) {\n        this.$.fsIcon = ICO_MAP.FS_OFF;\n      } else {\n        this.$.fsIcon = ICO_MAP.FS_ON;\n      }\n    });\n\n    this.sub('src', (src) => {\n      if (!src) {\n        return;\n      }\n      let url = this._getUrl(src);\n      this._video.src = url;\n    });\n\n    this.sub('video', async (descPath) => {\n      if (!descPath) {\n        return;\n      }\n      let desc = await (await window.fetch(this._getUrl(descPath))).json();\n\n      if (desc.poster) {\n        this._video.poster = this._getUrl(desc.poster);\n      }\n\n      let html = '';\n      desc?.sources.forEach((srcDesc) => {\n        html += /* HTML */ `<source ${this._desc2attrs(srcDesc)} />`;\n      });\n\n      if (desc.tracks) {\n        desc.tracks.forEach((trackDesc) => {\n          html += /* HTML */ `<track ${this._desc2attrs(trackDesc)} />`;\n        });\n        this.$.hasSubtitles = true;\n      }\n\n      this._video.innerHTML += html;\n\n      this._initTracks();\n      console.log(desc);\n    });\n\n    this._video.addEventListener('loadedmetadata', (e) => {\n      this.$.currentTime = this._timeFmt(this._video.currentTime);\n      this.$.totalTime = this._timeFmt(this._video.duration);\n    });\n\n    this._video.addEventListener('timeupdate', (e) => {\n      let perc = Math.round(100 * (this._video.currentTime / this._video.duration));\n      this.$.progressCssWidth = perc + '%';\n      this.$.currentTime = this._timeFmt(this._video.currentTime);\n    });\n\n    let volume = window.localStorage.getItem(Video.is + ':volume');\n    if (volume) {\n      let vol = parseFloat(volume);\n      this.setVolume(vol);\n      this.$.volumeValue = vol;\n    }\n  }\n}\n\nVideo.template = /* HTML */ `\n  <div class=\"video-wrapper\">\n    <video ref=\"video\" preload=\"metadata\" crossorigin=\"anonymous\"></video>\n  </div>\n\n  <div class=\"toolbar\">\n    <div class=\"progress\" ref=\"progress\" set -onclick=\"progressClicked\">\n      <div class=\"bar\" set -style.width=\"progressCssWidth\"></div>\n    </div>\n\n    <div class=\"tb-block\">\n      <button set -onclick=\"onPP\">\n        <lr-icon set -@name=\"ppIcon\"></lr-icon>\n      </button>\n      <div class=\"timer\">{{currentTime}} / {{totalTime}}</div>\n    </div>\n\n    <div class=\"tb-block\">\n      <button set -onclick=\"onCap\" -@hidden=\"!hasSubtitles\">\n        <lr-icon set -@name=\"capIcon\"></lr-icon>\n      </button>\n\n      <button set -onclick=\"onMute\">\n        <lr-icon set -@name=\"volIcon\"></lr-icon>\n      </button>\n\n      <lr-range type=\"range\" set -onchange=\"onVolChange\" -@disabled=\"volumeDisabled\" -value=\"volumeValue\"> </lr-range>\n\n      <button set -onclick=\"onFs\">\n        <lr-icon set -@name=\"fsIcon\"></lr-icon>\n      </button>\n    </div>\n  </div>\n`;\n\nVideo.bindAttributes({\n  video: 'video',\n  src: 'src',\n});\n","// @ts-check\nimport { Block } from '../../abstract/Block.js';\n\nconst CSS_ATTRIBUTE = 'css-src';\n\n/**\n * @template T\n * @typedef {new (...args: any[]) => T} GConstructor\n */\n\n/**\n * @template {GConstructor<import('../../abstract/Block.js').Block>} T\n * @param {T} Base\n * @returns {{\n *   new (...args: ConstructorParameters<T>): InstanceType<T> & {\n *     shadowReadyCallback(): void;\n *   };\n * } & Omit<T, 'new'>}\n */\nexport function shadowed(Base) {\n  // @ts-ignore\n  return class extends Base {\n    renderShadow = true;\n    pauseRender = true;\n\n    shadowReadyCallback() {}\n\n    initCallback() {\n      super.initCallback();\n      this.setAttribute('hidden', '');\n\n      // async wait for attributes to be set, needed for Angular because it sets attributes after constructor\n      setTimeout(() => {\n        let href = this.getAttribute(CSS_ATTRIBUTE);\n        if (href) {\n          this.attachShadow({\n            mode: 'open',\n          });\n          let link = document.createElement('link');\n          link.rel = 'stylesheet';\n          link.type = 'text/css';\n          link.href = href;\n          link.onload = () => {\n            // CSS modules can be not loaded at this moment\n            // TODO: investigate better solution\n            window.requestAnimationFrame(() => {\n              this.render();\n              window.setTimeout(() => {\n                this.removeAttribute('hidden');\n                this.shadowReadyCallback();\n              });\n            });\n          };\n          // @ts-ignore TODO: fix this\n          this.shadowRoot.prepend(link);\n        } else {\n          console.error(\n            'Attribute `css-src` is required and it is not set. See migration guide: https://uploadcare.com/docs/file-uploader/migration-to-0.25.0/'\n          );\n        }\n      });\n    }\n  };\n}\n\nexport class ShadowWrapper extends shadowed(Block) {}\n","import { ShadowWrapper } from '../blocks/ShadowWrapper/ShadowWrapper.js';\nimport { uploaderBlockCtx } from './CTX.js';\n\nexport class SolutionBlock extends ShadowWrapper {\n  init$ = uploaderBlockCtx(this);\n  _template = null;\n\n  static set template(value) {\n    this._template = value + /** HTML */ `<slot></slot>`;\n  }\n\n  static get template() {\n    return this._template;\n  }\n}\n","import { SolutionBlock } from '../../../abstract/SolutionBlock.js';\n\nexport class FileUploaderRegular extends SolutionBlock {}\n\nFileUploaderRegular.template = /* HTML */ `\n  <lr-simple-btn></lr-simple-btn>\n\n  <lr-modal strokes block-body-scrolling>\n    <lr-start-from>\n      <lr-drop-area with-icon clickable></lr-drop-area>\n      <lr-source-list wrap></lr-source-list>\n      <lr-copyright></lr-copyright>\n    </lr-start-from>\n    <lr-upload-list></lr-upload-list>\n    <lr-camera-source></lr-camera-source>\n    <lr-url-source></lr-url-source>\n    <lr-external-source></lr-external-source>\n    <lr-cloud-image-editor-activity></lr-cloud-image-editor-activity>\n  </lr-modal>\n\n  <lr-message-box></lr-message-box>\n  <lr-progress-bar-common></lr-progress-bar-common>\n`;\n","import { SolutionBlock } from '../../../abstract/SolutionBlock.js';\nimport { ActivityBlock } from '../../../abstract/ActivityBlock.js';\nimport { sharedConfigKey } from '../../../abstract/sharedConfigKey.js';\n\nexport class FileUploaderMinimal extends SolutionBlock {\n  pauseRender = true;\n\n  shadowReadyCallback() {\n    /** @type {import('../../../abstract/UploaderBlock.js').UploaderBlock} */\n    const uBlock = this.ref.uBlock;\n    this.sub('*currentActivity', (val) => {\n      if (!val) {\n        this.$['*currentActivity'] = uBlock.initActivity || ActivityBlock.activities.START_FROM;\n      }\n    });\n\n    this.sub('*uploadList', (list) => {\n      if (list?.length > 0) {\n        this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n      } else {\n        this.$['*currentActivity'] = uBlock.initActivity || ActivityBlock.activities.START_FROM;\n      }\n    });\n\n    this.sub(sharedConfigKey('sourceList'), (sourceList) => {\n      if (sourceList !== 'local') {\n        this.$[sharedConfigKey('sourceList')] = 'local';\n      }\n    });\n\n    this.sub(sharedConfigKey('confirmUpload'), (confirmUpload) => {\n      if (confirmUpload !== false) {\n        this.$[sharedConfigKey('confirmUpload')] = false;\n      }\n    });\n  }\n}\n\nFileUploaderMinimal.template = /* HTML */ `\n  <lr-start-from>\n    <lr-drop-area clickable l10n=\"choose-file\"></lr-drop-area>\n    <lr-copyright></lr-copyright>\n  </lr-start-from>\n  <lr-upload-list ref=\"uBlock\"></lr-upload-list>\n  <lr-message-box></lr-message-box>\n`;\n","import { SolutionBlock } from '../../../abstract/SolutionBlock.js';\nimport { ActivityBlock } from '../../../abstract/ActivityBlock.js';\n\nexport class FileUploaderInline extends SolutionBlock {\n  shadowReadyCallback() {\n    /** @type {import('../../../abstract/UploaderBlock.js').UploaderBlock} */\n    const uBlock = this.ref.uBlock;\n    this.sub('*currentActivity', (val) => {\n      if (!val) {\n        this.$['*currentActivity'] = uBlock.initActivity || ActivityBlock.activities.START_FROM;\n      }\n    });\n\n    this.sub('*uploadList', (list) => {\n      if (\n        (list?.length > 0 && this.$['*currentActivity'] === uBlock.initActivity) ||\n        ActivityBlock.activities.START_FROM\n      ) {\n        this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n      }\n    });\n  }\n}\n\nFileUploaderInline.template = /* HTML */ ` <lr-start-from>\n    <lr-drop-area with-icon clickable></lr-drop-area>\n    <lr-source-list wrap></lr-source-list>\n    <lr-copyright></lr-copyright>\n  </lr-start-from>\n  <lr-upload-list ref=\"uBlock\"></lr-upload-list>\n  <lr-camera-source></lr-camera-source>\n  <lr-url-source></lr-url-source>\n  <lr-external-source></lr-external-source>\n  <lr-message-box></lr-message-box>\n  <lr-progress-bar></lr-progress-bar>\n  <lr-cloud-image-editor-activity></lr-cloud-image-editor-activity>`;\n","// @ts-check\nimport { CloudImageEditorBlock } from '../../blocks/CloudImageEditor/src/CloudImageEditorBlock.js';\nimport { shadowed } from '../../blocks/ShadowWrapper/ShadowWrapper.js';\nexport class CloudImageEditor extends shadowed(CloudImageEditorBlock) {\n  shadowReadyCallback() {\n    /** @private */\n    this.__shadowReady = true;\n\n    this.$['*faderEl'] = this.ref['fader-el'];\n    this.$['*cropperEl'] = this.ref['cropper-el'];\n    this.$['*imgContainerEl'] = this.ref['img-container-el'];\n\n    this.initEditor();\n  }\n\n  async initEditor() {\n    if (this.__shadowReady) {\n      await super.initEditor();\n    }\n  }\n}\n","/** @param {Object<string, any>} blockExports */\nexport function registerBlocks(blockExports) {\n  for (let blockName in blockExports) {\n    let tagName = [...blockName].reduce((name, char) => {\n      if (char.toUpperCase() === char) {\n        char = '-' + char.toLowerCase();\n      }\n      return (name += char);\n    }, '');\n    if (tagName.startsWith('-')) {\n      tagName = tagName.replace('-', '');\n    }\n    if (!tagName.startsWith('lr-')) {\n      tagName = 'lr-' + tagName;\n    }\n    if (blockExports[blockName].reg) {\n      blockExports[blockName].reg(tagName);\n    }\n  }\n}\n","import { registerBlocks } from './registerBlocks.js';\n\nexport const LR_WINDOW_KEY = 'LR';\n\n/**\n * @param {String} url Blocks pack url\n * @param {Boolean} [register] Register connected package, if it not registered yet\n * @returns {Promise<import('../index.js')>}\n */\nexport async function connectBlocksFrom(url, register = false) {\n  return new Promise((resolve, reject) => {\n    if (typeof document !== 'object') {\n      resolve(null);\n      return;\n    }\n    if (typeof window === 'object' && window[LR_WINDOW_KEY]) {\n      resolve(window[LR_WINDOW_KEY]);\n      return;\n    }\n    let script = document.createElement('script');\n    script.async = true;\n    script.src = url;\n    script.onerror = () => {\n      reject();\n    };\n    script.onload = () => {\n      /** @type {import('../index.js')} */\n      let blocks = window[LR_WINDOW_KEY];\n      register && registerBlocks(blocks);\n      resolve(blocks);\n    };\n    document.head.appendChild(script);\n  });\n}\n","import { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class ActivityHeader extends ActivityBlock {}\n","import { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { CloudImageEditorBlock } from '../CloudImageEditor/index.js';\n\nexport class CloudImageEditorActivity extends UploaderBlock {\n  activityType = ActivityBlock.activities.CLOUD_IMG_EDIT;\n\n  init$ = {\n    ...this.init$,\n    cdnUrl: null,\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    this.registerActivity(this.activityType, {\n      onActivate: () => this.mountEditor(),\n      onDeactivate: () => this.unmountEditor(),\n    });\n\n    this.sub('*focusedEntry', (/** @type {import('../../abstract/TypedData.js').TypedData} */ entry) => {\n      if (!entry) {\n        return;\n      }\n      this.entry = entry;\n\n      this.entry.subscribe('cdnUrl', (cdnUrl) => {\n        if (cdnUrl) {\n          this.$.cdnUrl = cdnUrl;\n        }\n      });\n    });\n  }\n\n  /** @param {CustomEvent<import('./src/types.js').ApplyResult>} e */\n  handleApply(e) {\n    let result = e.detail;\n    this.entry.setMultipleValues({\n      cdnUrl: result.cdnUrl,\n      cdnUrlModifiers: result.cdnUrlModifiers,\n    });\n    this.historyBack();\n  }\n\n  handleCancel() {\n    this.historyBack();\n  }\n\n  mountEditor() {\n    let instance = new CloudImageEditorBlock();\n    let cdnUrl = this.$.cdnUrl;\n    instance.setAttribute('ctx-name', this.ctxName);\n    instance.setAttribute('cdn-url', cdnUrl);\n\n    instance.addEventListener('apply', (result) => this.handleApply(result));\n    instance.addEventListener('cancel', () => this.handleCancel());\n\n    this.innerHTML = '';\n    this.appendChild(instance);\n  }\n\n  unmountEditor() {\n    this.innerHTML = '';\n  }\n}\n","import { Block } from '../../abstract/Block.js';\n\nexport class Copyright extends Block {\n  initCallback() {\n    super.initCallback();\n\n    this.subConfigValue(\n      'removeCopyright',\n      /** @param {number} value */\n      (value) => {\n        this.toggleAttribute('hidden', !!value);\n      }\n    );\n  }\n\n  static template = /* HTML */ `\n    <a\n      href=\"https://uploadcare.com/?utm_source=copyright&utm_medium=referral&utm_campaign=v4\"\n      target=\"_blank noopener\"\n      class=\"credits\"\n      >Powered by Uploadcare</a\n    >\n  `;\n}\n","import { ImgBase } from './ImgBase.js';\n\nexport class Img extends ImgBase {\n  initCallback() {\n    super.initCallback();\n\n    this.sub$$('src', () => {\n      this.init();\n    });\n\n    this.sub$$('uuid', () => {\n      this.init();\n    });\n\n    this.sub$$('lazy', (val) => {\n      if (!this.$$('is-background-for')) {\n        this.img.loading = val ? 'lazy' : 'eager';\n      }\n    });\n  }\n}\n","import { Block } from '../../abstract/Block.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\n\nexport class SourceList extends Block {\n  initCallback() {\n    super.initCallback();\n    this.subConfigValue('sourceList', (/** @type {String} */ val) => {\n      let list = stringToArray(val);\n      let html = '';\n      list.forEach((srcName) => {\n        html += /* HTML */ `<lr-source-btn type=\"${srcName}\"></lr-source-btn>`;\n      });\n      if (this.cfg.sourceListWrap) {\n        this.innerHTML = html;\n      } else {\n        this.outerHTML = html;\n      }\n    });\n  }\n}\n","import { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class StartFrom extends ActivityBlock {\n  historyTracked = true;\n  activityType = 'start-from';\n\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType);\n  }\n}\n","import { UploaderBlock } from '../../abstract/UploaderBlock.js';\n\nexport class UploadCtxProvider extends UploaderBlock {}\n","<script>\n  import * as LR from \"@uploadcare/blocks\";\n  import { PACKAGE_VERSION } from \"@uploadcare/blocks\";\n\n  LR.registerBlocks(LR);\n\n  let files = [];\n  function handleUploaderEvent(e) {\n    const { data } = e.detail;\n    files = data;\n  }\n</script>\n\n<div class=\"wrapper\">\n  <lr-config\n    ctx-name=\"my-uploader\"\n    pubkey=\"demopublickey\"\n    multiple=\"true\"\n    multipleMax=\"10\"\n    confirmUpload=\"true\"\n    sourceList=\"local, url, camera, dropbox, gdrive\"\n  />\n  <lr-file-uploader-regular\n    ctx-name=\"my-uploader\"\n    css-src=\"https://unpkg.com/@uploadcare/blocks@{PACKAGE_VERSION}/web/lr-file-uploader-regular.min.css\"\n  />\n  <lr-data-output\n    ctx-name=\"my-uploader\"\n    use-event\n    hidden\n    class=\"uploader-cfg\"\n    on:lr-data-output={handleUploaderEvent}\n  />\n  <div class=\"output\">\n    {#each files as file}\n      <img\n        src=\"https://ucarecdn.com/{file.uuid}/{file.cdnUrlModifiers ||\n          ''}-/preview/-/scale_crop/400x400/\"\n        width=\"200\"\n        alt=\"Uploadcare uploaded file\"\n      />\n    {/each}\n  </div>\n</div>\n\n<style>\n  .wrapper {\n    display: flex;\n    flex-direction: column;\n    grid-gap: 32px;\n    padding: 32px;\n  }\n  .output {\n    display: grid;\n    grid-gap: 8px;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    width: 100%;\n    max-width: 1000px;\n  }\n</style>\n","import App from \"./App.svelte\";\n\nconst app = new App({\n  target: document.body,\n});\n\nexport default app;\n"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","current_component","src_url_equal","element_src","url","document","createElement","href","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","element","name","space","data","createTextNode","attr","attribute","value","removeAttribute","getAttribute","setAttribute","set_custom_element_data","prop","set_current_component","component","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","push","seen_callbacks","Set","flushidx","flush","saved_component","length","update","$$","e","pop","i","callback","has","add","clear","fragment","before_update","dirty","p","ctx","after_update","outroing","destroy_component","detaching","filtered","targets","c","indexOf","flush_render_callbacks","on_destroy","d","make_dirty","then","fill","init","options","instance","create_fragment","not_equal","props","append_styles","parent_component","bound","on_mount","on_disconnect","context","Map","callbacks","skip_bound","root","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","intro","block","delete","local","customElement","m","new_on_destroy","map","filter","mount_component","SvelteComponent","$destroy","this","$on","type","index","splice","$set","$$props","obj","$$set","keys","__defProp","defineProperty","__publicField","key","enumerable","configurable","writable","__defNormalProp","Data","constructor","schema","store","clone","o","_a","cloneObj","_storeIsProxy","callbackMap","static","actionName","console","warn","read","hasOwnProperty","val","rewrite","includes","notify","pub","multiPub","updObj","sub","remove","size","uid","Symbol","globalStore","get","set","DICT","freeze","BIND_ATTR","ATTR_BIND_PRFX","EXT_DATA_CTX_PRFX","NAMED_DATA_CTX_SPLTR","CTX_NAME_ATTR","CTX_OWNER_ATTR","CSS_CTX_PROP","EL_REF_ATTR","AUTO_TAG_PRFX","REPEAT_ATTR","REPEAT_ITEM_TAG_ATTR","SET_LATER_KEY","USE_TPL","ROOT_STYLE_ATTR_NAME","CHARS","UID","pattern","charAt","Math","random","setNestedProp","parent","path","lastStep","success","propPath","split","step","idx","DEFAULT_SLOT_KEY","OPEN_TOKEN","CLOSE_TOKEN","tpl_processors_default","fr","fnCtx","querySelectorAll","el","itemClass","itemTag","window","customElements","BaseComponent","super","style","display","itemTpl","innerHTML","template","reg","firstChild","repeatDataKey","currentList","fillItems","items","item","set$","setTimeout","k","DocumentFragment","repeatItem","assign","init$","oversize","slice","exItm","itemKey","log","shadowRoot","slots","slotMap","slot","slotName","createDocumentFragment","initChildren","child","Element","hasAttribute","values","mapObj","replaceChild","slotFr","refName","ref","keyValArr","attributes","startsWith","replace","toUpperCase","join","keyValStr","isAttr","kv","str","trim","valKeysArr","valKey","castType","Boolean","result","walk","createTreeWalker","NodeFilter","SHOW_TEXT","acceptNode","txt","parentElement","textContent","nextNode","getTextNodesWithTokens","txtNode","offset","tokenNodes","splitText","nextSibling","tNode","SINGLE_QUOTE","DOUBLE_QUOTE","ESCAPED_PATTERN","parseCssPropertyValue","input","output","trimQuotes","match","p1","String","fromCodePoint","parseInt","replaceAll","prev","next","escapeQuotes","JSON","parse","err","Error","autoTagsCount","styleMutationObserver","styleMutationObserverCbList","_BaseComponent","HTMLElement","dropCssDataCache","__boundCssProps","ctxProp","getCssData","__extractCssName","$","cssInit$","tplProcessors","allSubs","pauseRender","renderShadow","readyToDestroy","processInnerHtml","allowCustomTemplate","ctxOwner","initCallback","__initCallback","__initialized","call","render","shadow","attachShadow","mode","customTplSelector","getRootNode","customTpl","querySelector","content","cloneNode","tpl","addFr","styleLink","rel","onload","prepend","addTemplateProcessor","processorFn","autoCtxName","__autoCtxName","generate","setProperty","cssCtxName","ctxName","__cachedCtxName","localCtx","__localCtx","registerCtx","nodeCtx","getCtx","pArr","handler","subCb","isConnected","parsed","__parseProp","add$","__stateProxy","Proxy","kvObj","forcePrimitives","primArr","Number","__ctxOwner","__initDataCtx","attrDesc","propArr","propName","namedCtx","cssProp","bindCssData","__dataCtxInitialized","connectedCallback","__disconnectTimeout","clearTimeout","connectedOnce","ctxNameAttrVal","proc","is","rootLink","nodeType","Node","DOCUMENT_NODE","head","destroyCallback","disconnectedCallback","updateCssData","disconnect","tagName","isAlias","__tag","registeredClass","define","desc","observedAttributes","__attrDesc","attributeChangedCallback","oldVal","newVal","$prop","silentCheck","__cssDataCache","__computedStyle","getComputedStyle","getPropertyValue","ctxPropName","part","__initStyleAttrObserver","MutationObserver","records","cb","observe","childList","subtree","attributeFilter","initValue","defineAccessor","isAsync","localPropName","shadowStyles","cssTxt","styleBlob","Blob","__shadowStylesUrl","URL","createObjectURL","rootStyles","__rootStylesLink","link","tag","attrMap","attrName","applyAttributes","styles","styleMap","applyStyles","properties","processors","desc2","READY_EVENT_NAME","IDB","readyEventName","dbName","storeName","_reg","_notifyWhenReady","event","dispatchEvent","CustomEvent","detail","_updEventName","_getUpdateEvent","newValue","_notifySubscribers","localStorage","removeItem","setItem","version","request","indexedDB","open","onupgradeneeded","db","objStore","createObjectStore","keyPath","transaction","oncomplete","ev","onsuccess","onerror","error","_subscriptionsMap","_updateHandler","async","_localUpdateHandler","addEventListener","objectStore","reject","_value","write","silent","_key","put","getAll","all","subscribe","stop","removeEventListener","deleteDatabase","debounce","wait","timer","debounced","args","cancel","WINDOW_CACHE_KEY","getIsWindowHeightTracked","DEFAULT_TRANSFORMER","PLURAL_PREFIX","applyTemplateData","openToken","closeToken","transform","toString","isObject","prototype","SEPARATOR","camelizeString","text","word","camelizeArrayItems","array","ignoreKeys","isArray","camelizeKeys","source","delay","ms","getUserAgent$1","libraryName","libraryVersion","userAgent","publicKey","integration","languageName","defaultOptions","factor","time","UploadcareNetworkError","originalProgressEvent","progressEvent","message","setPrototypeOf","onCancel","signal","aborted","once","CancelError","isCancel","poll","check","interval","timeout","tickTimeoutId","timeoutId","tick","catch","defaultSettings","baseCDN","baseURL","maxContentLength","retryThrottledRequestMaxTimes","retryNetworkErrorMaxTimes","multipartMinFileSize","multipartChunkSize","multipartMinLastPartSize","maxConcurrentRequests","pollingTimeoutMilliseconds","pusherKey","defaultContentType","defaultFilename","method","headers","onProgress","xhr","XMLHttpRequest","requestMethod","entries","entry","setRequestHeader","responseType","abort","status","statusText","undefined","headersArray","getAllResponseHeaders","responseHeaders","line","parts","header","shift","responseData","response","responseStatus","upload","onprogress","lengthComputable","isComputable","loaded","total","send","getFileOptions","transformFile","_args","getFormData","FormData","isBlob","isFile","File","isReactNativeAsset","uri","isFileData","isSimpleValue","isObjectValue","isFileValue","collectParams","params","inputKey","inputValue","contentType","file","buildFormData","formData","paramsList","getFormDataParams","UploadClientError","code","getUrl","base","query","pathname","search","searchParams","URLSearchParams","buildSearchParams","LIBRARY_NAME","LIBRARY_VERSION","getUserAgent","REQUEST_WAS_THROTTLED_CODE","DEFAULT_RETRY_AFTER_TIMEOUT","DEFAULT_NETWORK_ERROR_TIMEOUT","retryIfFailed","attempts","runAttempt","defaultDelayTime","round","attempt","retry","retrier","seconds","isFinite","getTimeoutFromThrottledRequest","getContentType","getFileName","filename","getStoreValue","TypeEnum","Status","isErrorResponse","info","uuid","jsonerrors","pub_key","file_id","errorCode","isReadyPoll","isReady","UploadcareFile","isStored","isImage","mimeType","cdnUrl","s3Url","originalFilename","imageInfo","videoInfo","contentInfo","metadata","s3Bucket","fileInfo","fileName","uploadDirect","secureSignature","secureExpire","UPLOADCARE_PUB_KEY","UPLOADCARE_STORE","signature","expire","uploadFromUploaded","race","lastError","winnerIndex","controllers","AbortController","controller","stopRace","createStopRaceCallback","results","WebSocket","Events","events","emit","on","off","Pusher","disconnectTime","ws","queue","subscribers","emmitter","disconnectTimeoutId","connect","pusherUrl","channel","Success","Progress","actualDisconect","close","stringify","token","unsubscribe","msg","onError","pusher","getPusher","disconectTimeout","pollStrategy","fromUrlStatus","Waiting","Unknown","done","uploadFromUrl","sourceUrl","checkForUrlDuplicates","saveUrlForRecurrentUploads","source_url","check_URL_duplicates","save_URL_duplicates","fromUrl","urlResponse","FileInfo","unsubErrorHandler","destroy","error_code","pushStrategy","memo","WeakMap","getFileSize","asset","blob","fetch","res","getBlobFromReactNativeAsset","isMultipart","fileSize","isUuid","regExp","RegExp","test","isUrl","prepareChunks","chunkSize","start","end","min","sliceChunk","uploadPart","chunk","multipartUpload","uploadMultipart","progressValues","createProgressHandler","totalChunks","chunkIdx","reduce","sum","content_type","part_size","multipartStart","getChunk","concurrency","tasks","rejected","settled","forRun","multipartComplete","uploadFile","TypeError","UploadcareGroup","filesCount","totalSize","files","createdAt","storedAt","groupInfo","id","acc","datetimeStored","datetimeCreated","uploadFileGroup","jsonpCallback","isFileDataArray","isUrlArray","isUuidArray","isStillComputable","uuids","group","Queue","pending","running","resolvers","rejectors","tasksLeft","task","resolver","rejector","finally","blockCtx","activityBlockCtx","uploaderBlockCtx","l10nProcessor","elProp","arr","ctxKey","__l10nKeys","l10n","sharedConfigKey","toKebabCase","x","toLowerCase","warnings","warnOnce","getPluralForm","locale","count","Intl","PluralRules","select","TAG_PREFIX","Block","variables","pluralObjects","variable","substring","keyValue","pluralKey","countVariable","getPluralObjects","pluralObject","pluralize","pluralForm","activityType","applyL10nKey","localPropKey","l10nKey","hasBlockInCtx","blocksRegistry","setForCtxTarget","consumerScope","StateConsumerScope","setActivity","className","classList","toggle","_destroyInnerHeightTracker","documentElement","innerHeight","debouncedCallback","passive","createWindowHeightTracker","fileSizeFmt","bytes","decimals","units","getUnit","dm","floor","parseFloat","toFixed","proxyUrl","previewProxy","cfg","secureDeliveryProxy","previewUrl","encodeURIComponent","parseCfgProp","__cfgProxy","sharedKey","subConfigValue","updateCtxCssData","blocks","Modal","_handleBackdropClick","_closeDialog","_handleDialogClose","_handleDialogClick","dialog","isOpen","closeClicked","show","showModal","hide","HTMLDialogElement","backdrop","modalActive","modalScrollLock","body","overflow","ACTIVE_ATTR","ACTIVE_PROP","ActivityBlock","historyTracked","_debouncedHistoryFlush","_historyFlush","bind","_deactivate","actDesc","_activityRegistry","activityKey","deactivateCallback","_activate","historyBack","activateCallback","history","_isActivityRegistered","isActivityActive","registerActivity","onActivate","onDeactivate","unregisterActivity","activityParams","initActivity","doneActivity","nextActivity","activities","START_FROM","CAMERA","DRAW","UPLOAD_LIST","CONFIRMATION","CLOUD_IMG_EDIT","EXTERNAL","DETAILS","stringToArray","delimiter","IMAGE_ACCEPT_LIST","mergeFileTypes","fileTypes","flat","matchMimeType","allowedFileTypes","some","endsWith","fileIsImage","uploadEntrySchema","externalUrl","nullable","lastModified","Date","now","uploadProgress","uploadError","validationErrorMsg","validationMultipleLimitMsg","cdnUrlModifiers","isUploading","abortController","thumbUrl","silentUpload","PACKAGE_NAME","PACKAGE_VERSION","customUserAgent","MSG_NAME","TypedData","typedSchema","__typedSchema","__ctxId","__schema","__data","setValue","pDesc","setMultipleValues","getValue","deleteCtx","TypedCollection","__watchList","watchList","__handler","__subsMap","__observers","__items","__removed","__added","changeMap","__notifyObservers","ctxId","__observeTimeout","__notifyTimeout","added","removed","setHandler","getHandler","removeHandler","readProp","publishProp","clearAll","unobserve","findItems","checkFn","EVENT_TYPES","UPLOAD_START","REMOVE","UPLOAD_PROGRESS","UPLOAD_FINISH","UPLOAD_ERROR","VALIDATION_ERROR","CDN_MODIFICATION","DATA_OUTPUT","DONE_FLOW","INIT_FLOW","EventData","src","EventManager","eData","dispatch","eName","timeoutKey","_timeoutStore","UploadSource","LOCAL","DROP_AREA","URL_TAB","API","BASE","ByteUnitEnum","AUTO","BYTE","KB","MB","GB","TB","PB","number","ceil","prettyBytes","unit","isAutoMode","one","other","UploaderBlock","couldBeUploadCollectionOwner","isUploadCollectionOwner","__initialUploadMetadata","_validators","_validateMultipleLimit","_validateIsImage","_validateFileType","_validateMaxSizeLimit","setUploadMetadata","uploadCollection","hasUploadCollectionOwner","__uploadCollectionHandler","_runValidators","revokeObjectURL","_handleCollectionUpdate","_debouncedRunValidators","addFileFromUrl","addFileFromUuid","addFileFromObject","addFiles","uploadAll","openSystemDialog","accept","imgOnly","fileInput","multiple","captureCamera","capture","MouseEvent","onchange","sourceList","list","initFlow","force","srcKey","extSrcList","externalSourceType","doneFlow","imagesOnly","mimeOk","extOk","matchExtension","maxFileSize","maxLocalFileSizeBytes","entryIdx","multipleMax","_runValidatorsForEntry","validator","errorMsg","updatedEntries","ids","commonProgress","progress","loadedItems","errorItems","getOutputData","dataItem","configValue","pubkey","cdnCname","baseUrl","userAgentIntegration","multipartMaxConcurrentRequests","multipartMaxAttempts","getMetadata","itemId","uploadEntryData","outputItem","FACEBOOK","DROPBOX","GDRIVE","GPHOTOS","INSTAGRAM","FLICKR","VK","EVERNOTE","BOX","ONEDRIVE","HUDDLE","sourceTypes","eType","dataCtx","initialConfig","multipleMin","confirmUpload","externalSourcesPreferredTypes","cameraMirror","thumbSize","showEmptyList","useLocalImageEditor","useCloudImageEditor","removeCopyright","modalBackdropStrokes","sourceListWrap","remoteTabSessionKey","socialBaseUrl","groupOutput","asString","asNumber","asBoolean","mapping","allConfigKeys","complexConfigKeys","plainConfigKeys","isComplexKey","attrKeyMapping","fromEntries","attrStateMapping","Config","anyThis","attrs","normalizedVal","normalizeConfigValue","bindAttributes","Icon","viewBox","trimStart","svg","normalizeCdnOperation","operation","joinCdnOperations","operations","op","createCdnUrlModifiers","cdnOperations","joined","extractFilename","noOrigin","hash","urlFilenameIdx","lastIndexOf","plainFilenameIdx","trimFilename","filenamePathPart","isFileUrl","splitFileUrl","fileUrl","origin","createCdnUrl","baseCdnUrl","cdnModifiers","splitted","createOriginalUrl","PROPS_MAP","lazy","default","intersection","breakpoints","format","progressive","quality","CSS_PREF","UNRESOLVED_ATTR","DEV_MODE","location","host","hostname","CSS_PROPS","ImgBase","set$$","sub$$","kbFn","_fmtAbs","baseURI","_getCdnModifiers","_getUrlBase","_proxyUrl","_getElSize","wOnly","rect","getBoundingClientRect","w","width","h","height","_setupEventProxy","img","proxifyEvent","stopPropagation","Event","EVENTS","_img","Image","initAttributes","bgSelector","renderBg","imgSet","bp","iSet","getSrcset","srcset","getSrc","initIntersection","cbkFn","_isnObserver","IntersectionObserver","ent","isIntersecting","rootMargin","_observed","SimpleBtn","onClick","checkIsDirectory","FileReader","reader","onLoad","onloadend","readAsDataURL","readEntryContentAsync","webkitEntry","dataTransferItemType","reading","contents","readEntry","scope","clonedFile","isDirectory","readReaderContent","createReader","readEntries","DropzoneState","ACTIVE","INACTIVE","NEAR","OVER","RESET_EVENTS","nearnessRegistry","addDropzone","eventCounter","switchHandlers","state","setState","newState","shouldIgnore","isDragging","onChange","onResetEvent","onDragEnter","onDragLeave","onDrop","preventDefault","onDragOver","dragPoint","y","targetRect","nearness","r","cx","max","cy","sqrt","distance","isNear","isOver","composedPath","isNearest","onElementDrop","dataTransfer","promises","kind","itemType","webkitGetAsEntry","getAsEntry","entryContent","getAsFile","getAsString","getDropItems","onItems","eventName","DropArea","withIcon","isClickable","isFullscreen","isEnabled","isVisible","isActive","bounds","hasSize","isInViewport","top","left","bottom","clientHeight","right","innerWidth","clientWidth","visible","visibility","_destroyDropzone","_shouldIgnore","contentWrapperEl","_destroyContentWrapperDropzone","stateText","find","toggleAttribute","_onAreaClicked","_couldHandleFiles","isMultiple","currentFilesCount","clickable","fullscreen","disabled","SourceBtn","_registeredTypes","iconName","initTypes","registerType","activity","textKey","supportsCapture","icon","applyType","typeConfig","getType","configType","onclick","createSvgBlobUrl","fileCssBg","color","FileItemState","FINISHED","FAILED","UPLOADING","IDLE","LIMIT_OVERFLOW","FileItem","_entrySubs","_entry","_isIntersecting","_debouncedGenerateThumb","_generateThumbnail","_debouncedCalculateState","_calculateState","_renderedOnce","itemName","errorText","progressValue","progressVisible","progressUnknown","badgeIcon","isFinished","isFailed","isFocused","isEditable","isLimitOverflow","onEdit","onRemove","entryUuid","onUpload","_reset","_observerCallback","intersectionRatio","currentThumbUrl","imgFile","canvas","getContext","promise","ratio","fillStyle","fillRect","drawImage","toBlob","generateThumb","_subEntry","_handleEntryId","_handleState","activeInstances","inst","_observer","threshold","uploadTask","uploadClientOptions","getUploadClientOptions","percentage","mime","UiMessage","caption","isError","MessageBox","captionTxt","msgTxt","onClose","UploadList","doneBtnVisible","doneBtnEnabled","uploadBtnVisible","addMoreBtnVisible","addMoreBtnEnabled","headerText","hasFiles","onAdd","_updateUploadsState","onDone","_debouncedHandleCollectionUpdate","_updateCountLimitMessage","_validateFilesCount","tooFew","tooMany","passed","exact","countValidationResult","itemIds","summary","succeed","uploading","failed","limitOverflow","fitCountRestrictions","validationOk","allDone","_getHeaderText","localizedText","currentActivity","UrlSource","importDisabled","onInput","focus","canUsePermissionsApi","navigator","permissions","CameraSource","_unsubPermissions","video","videoTransformCss","shotBtnDisabled","videoHidden","messageHidden","requestBtnHidden","l10nMessage","originalErrorMessage","cameraSelectOptions","cameraSelectHidden","onCameraSelectChange","_selectedCameraId","_capture","onShot","_shot","onRequestPermissions","_onActivate","_subscribePermissions","_onDeactivate","_stopCapture","_handlePermissionsChange","_setPermissionsState","constr","ideal","frameRate","audio","deviceId","_canvas","_ctx","stream","mediaDevices","getUserMedia","_capturing","getTracks","date","enumerateDevices","label","UploadDetails","checkerboard","errorTxt","cloudEditBtnHidden","onNameInput","onBack","onCloudEdit","showNonImageThumb","filePreview","setImageUrl","_file","setImageFile","tmpSub","file_name_input","canUseCloudEditor","imageUrl","UiConfirmation","captionL10nStr","messageL10Str","confirmL10nStr","denyL10nStr","confirmAction","denyAction","ConfirmationDialog","_defaults","activityCaption","messageTxt","confirmBtnTxt","denyBtnTxt","onConfirm","onDeny","cfn","ProgressBarCommon","unknown","anyUploading","ProgressBar","_unknownMode","opacity","TRANSPARENT_PIXEL_SRC","FilePreview","backgroundImage","color1","color2","checkerboardCssBg","_lastObjectUrl","setImage","CSS_CFG_CTX_NAME","CloudImageEditorBase","cfgCssCtxName","cfgCtxName","__cachedCfgCtxName","normalize","arg","classNames","OPERATIONS_ZEROS","brightness","exposure","gamma","contrast","saturation","vibrance","warmth","enhance","rotate","SUPPORTED_OPERATIONS_ORDERED","transformationsToOperations","transformations","amount","dimensions","coords","transformationToStr","COMMON_OPERATIONS","OPERATION_PROCESSORS","mirror","flip","crop","initState","extension","editorMode","modalCaption","fileType","showLoader","images","originalSrc","originalUrl","eventData","bubbles","composed","TEMPLATE","TabId","TABS","ALL_COLOR_OPERATIONS","ALL_FILTERS","ALL_CROP_OPERATIONS","COLOR_OPERATIONS_CONFIG","zero","range","keypointsNumber","CloudImageEditorBlock","_debouncedShowLoader","_showLoader","_waitForSize","resizeObserver","ResizeObserver","contentRect","initEditor","_imgLoading","tabId","image_hidden_to_cropper","image_hidden_effects","slashIndex","secondSlashIndex","extractUuid","processor","operationsToTransformations","withoutFilename","operationsMarker","extractOperations","networkProblems","json","THUMB_OFFSET","THUMB_STROKE_WIDTH","GUIDE_THIRD","MIN_CROP_SIZE","THUMB_CORNER_SIZE","setSvgNodeAttrs","setAttributeNS","createSvgNode","createElementNS","cornerPath","direction","wMul","hMul","xSide","ySide","p2","p3","center","sidePath","n","s","THUMB_SIDE_SIZE","constraintRect","rect1","rect2","minRectSize","minWidth","minHeight","prevHeight","prevWidth","CropFrame","dragging","_handlePointerUp","_handlePointerUp_","_handlePointerMove","_handlePointerMove_","_handleSvgPointerMove","_handleSvgPointerMove_","_shouldThumbBeDisabled","imageBox","tooHigh","tooWide","_createBackdrop","cropBox","mask","maskRectOuter","maskRectInner","backdropRect","_backdropMask","_backdropMaskInner","_resizeBackdrop","requestAnimationFrame","_updateBackdrop","_updateFrame","thumb","_frameThumbs","pathNode","interactionNode","groupNode","isCenter","isCorner","disableThumb","_frameGuides","GUIDE_STROKE_WIDTH","_createThumbs","frameThumbs","j","stroke","_handlePointerDown","_createGuides","x1","y1","x2","y2","_createFrame","frameGuides","svgX","svgY","_draggingThumb","_dragStartPoint","_dragStartCrop","_updateCursor","dx","dy","moveRect","expandRect","leftX","rightX","topY","intersectionRect","every","payload","hoverThumb","hover","rectContainsPoint","_hoverThumb","cursor","_render","toggleThumbs","_guidesHidden","EditorButtonControl","active","title","_titleEl","_iconEl","tabIndex","not_active","EditorCropButtonControl","_operation","angle","nextAngle","nextValue","ControlType","FAKE_ORIGINAL_FILTER","EditorSlider","defaultValue","setOperation","_controlType","_iconName","_title","_filter","_initializeValues","activate","fromViewer","transformation","apply","operationValue","deactivate","_originalUrl","tooltip","preloadImage","image","naturalWidth","batchPreloadImages","preloaders","preload","allSettled","EditorFilterControl","isOriginal","iconSize","_previewSrc","previewSize","dpr","devicePixelRatio","observer","previewEl","_cancelPreload","currentFilter","EditorOperationControl","editorTransformations","viewerImageSrc","clamp","rotateSize","swap","EditorImageCropper","_commitDebounced","_commit","_handleResizeDebounced","_handleResize","_imageSize","_syncTransformations","pickedTransformations","pick","_initCanvas","offsetWidth","offsetHeight","scale","_alignImage","_isActive","padding","naturalSize","naturalHeight","imageAspectRatio","_alignCrop","previewWidth","previewX","previewY","sourceWidth","_drawImage","rotated","save","translate","PI","restore","_draw","clearRect","_animateIn","_transitionToImage","active_from_viewer","active_from_editor","inactive_to_editor","_calculateDimensions","previewHeight","sourceHeight","cropWidth","cropHeight","ratioW","ratioH","_calculateCrop","cropX","cropY","isInteger","matcher","validateCrop","imageSize","_waitForImage","_transitionToCrop","scaleX","scaleY","cropCenterX","cropCenterY","transformOrigin","_handleImageLoading","loadingOperations","linspace","keypointsRange","sort","EditorScroller","deltaY","deltaX","abs","scrollLeft","EditorToolbar","filters","colorOperations","cropOperations","hidden","_onSliderClose","currentTarget","_activateTab","_createOperationControl","_createFilterControl","_createToggleControl","_renderControlsList","listEl","filterId","isCurrentTab","_syncTabIndicator","_unmountTabControls","tabToggleEl","offsetLeft","_preloadEditedImage","_updateInfoTooltip","appliedFilter","setTransformations","anyLoading","loading","showSlider","LrBtnUi","_iconReversed","_iconSingle","_iconHidden","iconCss","_iconCss","theme","icon_left","icon_right","icon_hidden","icon_single","reverse","flexDirection","LineLoaderUi","_active","_handleTransitionEndRight","lineEl","transition","_start","_stop","DEFAULT_STYLE","PresenceToggle","_visible","_visibleStyle","_hiddenStyle","_externalTransitions","_handleVisible","applyClassNames","DEFAULT_STYLE_transition","SliderUi","_updateValue","_zero","_updateSteps","_thumbSize","inputEl","_updateZeroDot","_zeroDotEl","stepsEl","half","_stepsCount","minorStepEl","borderStepEl","zeroDotEl","escapeRegExp","wildcardRegexp","flags","buildStyles","textColor","backgroundColor","linkColor","linkColorHover","shadeColor","border","background","selector","propertiesObj","propertiesStr","cbMapping","cbList","sender","ExternalSource","activityIcon","counter","_iframe","mountIframe","unmountIframe","sendMessage","contentWindow","postMessage","alternatives","preferredTypes","preferredType","regexp","typeUrl","handleIframeLoad","_inheritedUpdateCssData","getCssValue","colors","remoteUrl","lang","public_key","images_only","pass_window_open","session_key","queryString","iframe","marginheight","marginwidth","frameborder","allowTransparency","iframeWrapper","handleFileSelected","Tabs","setCurrentTab","tabL10nStr","ctxEl","lStr","_tabMap","tabEl","class","row","DataOutput","filesData","dict","validationInput","_validationInputElement","FORM_INPUT_ATTR","_dynamicInputsContainer","INPUT_REQUIRED","required","FIRE_EVENT_ATTR","EVENT_NAME","timestamp","groupData","INPUT_NAME_ATTR","CONSOLE_ATTR","SRC_CTX_KEY","GROUP_ATTR","uuidList","fileDesc","resp","Select","currentText","selectHtml","onSelect","opt","html","ICO_MAP","FSAPI","requestFullscreen","webkitRequestFullscreen","exitFullscreen","Video","togglePlay","_video","paused","ended","play","pause","toggleFullscreen","fullscreenElement","toggleCaptions","capIcon","textTracks","toggleSound","volIcon","volumeDisabled","muted","setVolume","volume","ppIcon","fsIcon","totalTime","currentTime","progressCssWidth","hasSubtitles","volumeValue","onPP","onFs","onCap","onMute","onVolChange","progressClicked","progressRect","duration","offsetX","_getUrl","_desc2attrs","_timeFmt","getMinutes","getSeconds","_initTracks","track","getItem","_castAttributes","toCast","descPath","poster","sources","srcDesc","tracks","trackDesc","perc","vol","shadowed","Base","shadowReadyCallback","ShadowWrapper","SolutionBlock","_template","FileUploaderRegular","FileUploaderMinimal","uBlock","FileUploaderInline","CloudImageEditor","__shadowReady","registerBlocks","blockExports","blockName","char","LR_WINDOW_KEY","mountEditor","unmountEditor","handleApply","handleCancel","_hidden","_addKeypointDebounced","_addKeypoint","_flush","cancelAnimationFrame","_raf","kp","_keypoints","zIndex","_imageSrc","_url","_transformations","_constructKeypoint","_isSame","shouldSkip","keypoint","keypoints","findIndex","insertBeforeNode","_container","contains","_update","keypointValues","opacities","section","numbers","point","relation","calculateOpacities","zIndices","calculateZIndices","_createPreviewImage","_previewImage","container","srcList","_cancelLastImages","kpImage","_cancelBatchPreload","_setOriginalSrc","_fromViewer","active_from_cropper","inactive_to_cropper","_initNodes","srcName","outerHTML","register","script","img_src_value","div1","lr_config","lr_file_uploader_regular","lr_data_output","div0","iterations","LR.registerBlocks","LR","$$invalidate"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104]}